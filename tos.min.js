"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return r};var d,r={},e=Object.prototype,c=e.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(d){a=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var a,r,l,s,o=t&&t.prototype instanceof v?t:v,p=Object.create(o.prototype),c=new N(i||[]);return u(p,"_invoke",{value:(a=e,r=n,l=c,s=g,function(e,t){if(s===h)throw new Error("Generator is already running");if(s===S){if("throw"===e)throw t;return{value:d,done:!0}}for(l.method=e,l.arg=t;;){var n=l.delegate;if(n){var i=E(n,l);if(i){if(i===T)continue;return i}}if("next"===l.method)l.sent=l._sent=l.arg;else if("throw"===l.method){if(s===g)throw s=S,l.arg;l.dispatchException(l.arg)}else"return"===l.method&&l.abrupt("return",l.arg);s=h;var o=m(a,r,l);if("normal"===o.type){if(s=l.done?S:f,o.arg===T)continue;return{value:o.arg,done:l.done}}"throw"===o.type&&(s=S,l.method="throw",l.arg=o.arg)}})}),p}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=l;var g="suspendedStart",f="suspendedYield",h="executing",S="completed",T={};function v(){}function s(){}function p(){}var y={};a(y,o,function(){return this});var b=Object.getPrototypeOf,A=b&&b(b(M([])));A&&A!==e&&c.call(A,o)&&(y=A);var I=p.prototype=v.prototype=Object.create(y);function C(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function O(s,p){var t;u(this,"_invoke",{value:function(n,i){function e(){return new p(function(e,t){!function t(e,n,i,o){var a=m(s[e],s,n);if("throw"!==a.type){var r=a.arg,l=r.value;return l&&"object"==_typeof(l)&&c.call(l,"__await")?p.resolve(l.__await).then(function(e){t("next",e,i,o)},function(e){t("throw",e,i,o)}):p.resolve(l).then(function(e){r.value=e,i(r)},function(e){return t("throw",e,i,o)})}o(a.arg)}(n,i,e,t)})}return t=t?t.then(e,e):e()}})}function E(e,t){var n=t.method,i=e.iterator[n];if(i===d)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=d,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),T;var o=m(i,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,T;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=d),t.delegate=null,T):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,T)}function $(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach($,this),this.reset(!0)}function M(t){if(t||""===t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(c.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=d,e.done=!0,e};return i.next=i}}throw new TypeError(_typeof(t)+" is not iterable")}return u(I,"constructor",{value:s.prototype=p,configurable:!0}),u(p,"constructor",{value:s,configurable:!0}),s.displayName=a(p,i,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===s||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,a(e,i,"GeneratorFunction")),e.prototype=Object.create(I),e},r.awrap=function(e){return{__await:e}},C(O.prototype),a(O.prototype,n,function(){return this}),r.AsyncIterator=O,r.async=function(e,t,n,i,o){void 0===o&&(o=Promise);var a=new O(l(e,t,n,i),o);return r.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},C(I),a(I,i,"Generator"),a(I,o,function(){return this}),a(I,"toString",function(){return"[object Generator]"}),r.keys=function(e){var n=Object(e),i=[];for(var t in n)i.push(t);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},r.values=M,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=d,this.done=!1,this.delegate=null,this.method="next",this.arg=d,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=d)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function e(e,t){return a.type="throw",a.arg=n,i.next=e,t&&(i.method="next",i.arg=d),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var r=c.call(o,"catchLoc"),l=c.call(o,"finallyLoc");if(r&&l){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(r){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&c.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,T):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),T},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),T}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:M(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=d),T}},r}function asyncGeneratorStep(e,t,n,i,o,a,r){try{var l=e[a](r),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(i,o)}function _asyncToGenerator(l){return function(){var e=this,r=arguments;return new Promise(function(t,n){var i=l.apply(e,r);function o(e){asyncGeneratorStep(i,t,n,o,a,"next",e)}function a(e){asyncGeneratorStep(i,t,n,o,a,"throw",e)}o(void 0)})}}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){l=!0,a=e},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var i=n.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}angular.module("tos-ui",["tisf-angular","tsp-shared","ngSanitize","ui.bootstrap"]).config(["$httpProvider","$stateProvider","$urlRouterProvider",function(e,t,n){n.otherwise("/landing/"),t.state("landing",{url:"/landing/:templeOrgId?",templateUrl:"/app/modules/schedule/landing.html",controller:"landingController",controllerAs:"$ctrl",page:{omnitureName:"TOS - Landing Page"},params:{refresh:{inherit:!1},successfullyScheduledAppointment:void 0,savedAppointment:void 0,selectedTempleInfo:void 0,templeOrgId:null},resolve:{initData:["$location",function(e){return{templeOrgId:e.search().templeOrgId}}]}}).state("removeGuest",{url:"/appointments/remove/guest/{appointmentToRemoveGuestFromId:int}:templeOrgId?:lang?",templateUrl:"/app/modules/schedule/landing.html",controller:"landingController",controllerAs:"$ctrl",page:{omnitureName:"TOS - Remove Guest From Appointment"},params:{appointment:void 0,templeOrgId:null,lang:null,appointmentToRemoveGuestFromId:null},resolve:{initData:["$location",function(e){return{templeOrgId:e.search().templeOrgId,lang:e.search().lang}}]}}).state("highlight",{url:"/appointments/{appointmentToHighlightId:int}",templateUrl:"/app/modules/schedule/landing.html",controller:"landingController",controllerAs:"$ctrl",page:{omnitureName:"TOS - Highlight Appointment"},params:{appointment:void 0,appointmentToHighlightId:null}}).state("schedule",{url:"/appointments/schedule",templateUrl:"/app/modules/schedule/schedule-appointment.html",controller:"scheduleAppointmentController",controllerAs:"$ctrl",page:{omnitureName:"TOS - Schedule Appointment"},params:{appointment:void 0}}).state("schedule.ordinance",{url:"/{templeOrgId:int}",page:{omnitureName:"TOS - Schedule Appointment - Select Ordinance"},params:{appointment:void 0,templeOrgId:null}}).state("schedule.session",{url:"/{templeOrgId:int}/{appointmentTypeId:int}",page:{omnitureName:"TOS - Schedule Appointment - Select Session"},params:{appointment:void 0,selectedDate:void 0,templeOrgId:null,appointmentTypeId:null}}).state("schedule.finalize",{url:"/{templeOrgId:int}/{appointmentTypeId:int}/{appointmentTimeId:int}",page:{omnitureName:"TOS - Schedule Appointment - Finalize"},params:{appointment:void 0,isCombineSealing:void 0,templeOrgId:null,appointmentTypeId:null,appointmentTimeId:null}}).state("schedule.guest",{url:"/guest/{appointmentId:int}",page:{omnitureName:"TOS - Schedule Guest Appointment - Finalize"},params:{appointment:void 0,appointmentId:null}}).state("schedule.edit",{url:"/edit/{appointmentId:int}",page:{omnitureName:"TOS - Edit Appointment"},params:{appointment:void 0,selectedDate:void 0,appointmentId:null}}).state("removeSession",{url:"/removeSession",templateUrl:"/app/modules/user/remove-session.html",controller:"removeSessionController",controllerAs:"$ctrl"}).state("invitation",{url:"/invitation/{templeOrgId:int}",templateUrl:"/app/modules/schedule/temple-ordinance-invitation.html",controller:"templeOrdinanceInvitation",controllerAs:"$ctrl",page:{omnitureName:"TOS - Temple Ordinance Invitation"},params:{templeOrgId:null}})}]).run(["$window","$document","$log","$rootScope","screenSizeService","$transitions","$timeout","tisfTranslateService","tisfHeaderService","tosTempleInfoService","tosNavigationLinksService",function(i,e,n,t,o,a,r,l,s,p,c){var d=[TypeError,ReferenceError,i.DOMException],u=["test","stage"];s.disableHelp(),s.disableLanguages(),s.disableNotifications(),s.disableTempleSelector(),p.isTosGvsgEnabled().then(function(e){e&&e.isGvsgEnabled&&c.getReactUrl().then(function(e){var t=e.url;t&&i.open(t,"_self")})}),i.platformConfig={headerConfig:{signOutServiceUrl:"/logout"},dataConfig:{langs:["*"]},subNavConfig:{subNavTitle:l.get("subNav.tos"),subNavTitleURL:"/",subNavItems:[{title:l.get("subNav.temples"),href:function(){try{var e=i.location.hostname.split(".")[0],t=e.split("-")[e.split("-").length-1];return"https://"+("local"===t?"test":u.includes(t)?t:"www")+".churchofjesuschrist.org/temples"}catch(e){return n.error("Error when getting the /temples URL",e),"https://www.churchofjesuschrist.org/temples"}}()}]}};for(var m=0;m<d.length;m++)d[m].prototype.$$passToExceptionHandler=!0;t.$watch(function(){return i.document.querySelector("[ui-view]").offsetHeight},function(e){var t=i.document.getElementById("appointment-scheduled-modal");if(t){var n=t.offsetHeight+50;e<n&&(e=n)}o.communicateHeightChange(e)}),a.onStart({},function(e){r(function(){"landing"===e.to().name&&(t.$broadcast("resetTimer"),t.$broadcast("resetOpening"),t.$broadcast("resetOpen"))})})}]),angular.module("tos-ui").factory("appointmentService",["$http","$q","Gender","httpService","appointmentTypeService","AppointmentType","AppointmentSource","$cacheFactory","$state","conflictingAppointmentModal","generalErrorModal","scheduleLimitReachedModal","$rootScope","tosUserInfoService","tosDateService","$log","tosHoldService","tosScrollService","removeGuestModal","exceptionService","sessionIsFullModal","tosLivingSealingService","tisfTranslateService","tosTempleInfoService",function(d,o,T,u,c,v,a,e,m,r,g,f,h,y,l,b,A,I,C,O,E,$,t,L){var N="/api/appointments",M=e("appointments"),D="existingAppointments";return new function(){var s=this,S=this;S.getAppointmentById=function(e,t){var n=N+"/"+t+"/"+e;return u.getResponseData(d.get(n)).then(function(t){return t.id&&(S.currentAppointment=t,S.origInclSelf=!1,S.origInclSpouse=!1,S.isEdit="schedule.edit"===m.current.name,S.currentAppointment.guestList.forEach(function(e){e&&e.guestMrn&&e.guestMrn===S.currentAppointment.details.contactMrn&&(S.origInclSelf=!0,t.inclSelf=!0),e&&e.guestMrn===S.currentAppointment.details.guestMrn&&(S.origInclSpouse=!0)})),t})},S.originalInclSelf=function(){return S.origInclSelf},S.originalInclSpouse=function(){return S.origInclSpouse},S.currentAppointment=function(){return S.currentAppointment},S.deleteAppointment=function(e,t,n){var i={data:n},o=N+"/temples/"+e+"/appointments/"+t;S.clearExistingAppointmentsCache();var a=d.delete(o,i);return u.getResponseData(a)},S.getExistingAppointments=function(e,t){var n=N;if((e||t)&&(n+="/findExistingAppointments/".concat(e,"/").concat(t)),!M.get(D)){var i=d.get(n);M.put(D,u.getResponseData(i))}return M.get(D)},S.clearExistingAppointmentsCache=function(){M.remove(D)};var n=function(e,t){return b.error(e,t),o.reject(e)},i=function(e,t){return n(e+" is required",t)};S.isSloqAppt=function(e){return e&&e.sloqSealingSpouseId||e.sloqSealingChildrenId||e.sloqEndowmentId},S.getPatronCounts=function(e,t){var n={};return n[T.MALE]=0,n[T.FEMALE]=0,e.userIsScheduler||!e.id?(t&&e.guestList&&0<e.guestList.length&&e.appointmentType!==v.PROXY_BAPTISM&&e.guestList.forEach(function(e){(e.guestMrn===t.mrn||t.spouseInfo&&e.guestMrn===t.spouseInfo.mrn&&"REMOVE"!==e.appointmentGuestAction)&&n[e.gender]++}),e.appointmentType===v.PROXY_BAPTISM&&(e.details&&e.details.malePatronCount&&(n[T.MALE]+=e.details.malePatronCount),e.details&&e.details.femalePatronCount&&(n[T.FEMALE]+=e.details.femalePatronCount)),e.additionalMaleGuestCount&&(n[T.MALE]+=e.additionalMaleGuestCount),e.additionalFemaleGuestCount&&(n[T.FEMALE]+=e.additionalFemaleGuestCount)):(n[T.FEMALE]=e.details.femalePatronCount||0,n[T.MALE]=e.details.malePatronCount||0,e.details.guestCount||(e.additionalMaleGuestCount&&(n[T.MALE]+=e.additionalMaleGuestCount),e.additionalFemaleGuestCount&&(n[T.FEMALE]+=e.additionalFemaleGuestCount))),n},S.getLivingPatronCounts=function(e,t){var n=0;return e.userIsScheduler||!e.id?(t&&e.guestList&&0<e.guestList.length&&e.appointmentType!==v.LIVING_SEALING&&(e.guestList.forEach(function(e){(e.guestMrn===t.mrn||t.spouseInfo&&e.guestMrn===t.spouseInfo.mrn&&"REMOVE"!==e.appointmentGuestAction)&&n++}),e.additionalGuestCount&&(n+=e.additionalGuestCount)),e.appointmentType===v.LIVING_SEALING&&(n=e.details.guestCount?e.details.guestCount:e.additionalGuestCount||0)):n=e.details.guestCount||e.additionalGuestCount,n},S.getLivingPatronCountMap=function(e,t){var n={};if(n[T.MALE]=0,n[T.FEMALE]=0,!e)return n;var i=function(e,t){if(t&&t.gender)return t.gender;if(e&&e.patronList&&0<e.patronList.length){var n=e.patronList.find(function(e){return"PATRON"===e.patronType});if(n&&n.gender)return n.gender}return T.MALE}(e,t);if(e.patronList&&0<e.patronList.length&&e.patronList.forEach(function(e){e.gender?n[e.gender]++:n[i]++}),e.details.guestCount){var o=e.details.guestCount;e.guestList&&0<e.guestList.length&&e.guestList.forEach(function(e){"REMOVE"!==e.appointmentGuestAction&&(e.gender?n[e.gender]++:n[i]++,o--)}),i?n[i]+=o:n[T.MALE]+=o}return n};var p=function(e,t){var n={guestMrn:t.mrn,name:t.name,gender:t.gender,email:t.email||e.details.contactEmail,contactInfo:e.details.contactInfo,language:e.language||null,guestEmailConfirmationFlg:e.contactEmailConfirmation,guestSmsConfirmationFlg:e.contactSmsConfirmation,userIsScheduler:!0},i=!1;e.guestList.map(function(e){return e.guestMrn===t.mrn&&(i=!0,e.guestEmailConfirmationFlg=n.guestEmailConfirmationFlg,e.guestSmsConfirmationFlg=n.guestSmsConfirmationFlg),e}),i||e.guestList.unshift(n)};S.missingContactInfo=function(e){return S.isAGroupAppointmentGuest(e)?!e.details.contactName||!e.details.contactEmail:!(e.contactInfo&&e.contactInfo.name&&e.contactInfo.email&&e.contactInfo.gender)},S.saveAppointment=function(e,r){var l=angular.copy(e);if(!l)return i("appointment",l);if(S.missingContactInfo(l)&&!l.modifiedByTemple)return i("contactInfo",l);if(!l.templeOrgId)return i("templeOrgId",l);if(!l.appointmentType)return i("appointmentType",l);if(!c.isValidAppointmentType(l.appointmentType))return n("Invalid appointment type: "+l.appointmentType,l);if(l.appointmentDateTime&&angular.isString(l.appointmentDateTime)&&(l.appointmentDateTime=new Date(l.appointmentDateTime)),!l.appointmentDateTime||!angular.isDate(l.appointmentDateTime))return i("appointmentDateTime",l);if(!l.appointmentTimeId)return i("appointmentTimeId",l);angular.isNumber(l.id)||(l.appointmentSource=a.WEB),l.details||(l.details={}),l.userIsScheduler&&(l.details.contactMrn=l.contactInfo&&l.contactInfo.mrn||l.details.contactMrn,l.details.contactName=l.contactInfo&&l.contactInfo.name||l.details.contactName,l.details.contactInfo=l.contactInfo&&l.contactInfo.phone||l.details.contactInfo,l.details.contactEmail=l.contactInfo&&l.contactInfo.email||l.details.contactEmail),l.userIsScheduler&&l.contactInfo&&l.contactInfo.spouseInfo&&(l.details.spouseMrn=l.contactInfo.spouseInfo.mrn),v.LIVING_ENDOWMENT===l.appointmentType?(l.details.type="endowment",l.details.veilCeremonyType="NONE",l.details.toBeSealedType="NONE"):v.LIVING_SEALING===l.appointmentType?$.prepareLivingSealingForSave(l):l.details.type="proxy";var t=S.isLivingOrdinance(l.appointmentType);return y.getUserInfo(t).then(function(e){if(l.userIsScheduler&&l.appointmentType!==v.PROXY_BAPTISM&&(c.appointmentTypeAllowsSpouseToBeAdded(l.appointmentType)?l.inclSelf&&p(l,e):p(l,e)),l.userIsScheduler&&(!l.inclGuests||0===l.additionalFemaleGuestCount&&0===l.additionalMaleGuestCount&&!S.isLivingOrdinance(l.appointmentType)||0===l.additionalGuestCount&&S.isLivingOrdinance(l.appointmentType)?l.details.groupName=null:l.details.groupName||(l.details.groupName=l.contactInfo.name)),S.isLivingOrdinance(l.appointmentType)){var t=S.getLivingPatronCounts(l,e);l.details.guestCount=t}else{var n=S.getPatronCounts(l,e);l.details.malePatronCount=n[T.MALE],l.details.femalePatronCount=n[T.FEMALE],l.details.guestCount=n[T.MALE]+n[T.FEMALE]}if(l.userIsScheduler&&!l.language&&l.guestList.forEach(function(e){e.guestMrn===l.contactInfo.mrn&&(l.language=e.language)}),l.userIsScheduler&&(l.appointmentType===v.LIVING_ENDOWMENT||l.appointmentType===v.LIVING_SEALING)){var i=l.guestList.findIndex(function(e){return e.guestMrn&&l.contactInfo.mrn&&e.guestMrn===l.contactInfo.mrn});0<=i&&(l.guestList.splice(i,1),l.appointmentType!==v.LIVING_SEALING&&l.details.guestCount--)}if(S.clearExistingAppointmentsCache(),l.id&&!r)return S.userCanScheduleAnotherAppointment({appointmentType:l.appointmentType,appointmentId:l.id,templeOrgId:l.templeOrgId,appointmentDateTime:new Date(l.appointmentDateTime),userIsScheduler:!0,inclSelf:l.inclSelf,inclSpouse:l.inclSpouse,isGuestConfirmation:!0===r}).then(function(){var e=!!S.isAGroupAppointmentGuest(l),t=d.post(N+"/save/"+e,l);return u.getResponseData(t)}).catch(function(e){r&&h.$broadcast("showSpinner"),O.checkForValidationException(e.validationErrors,["APPOINTMENT_TIME_NOT_ENOUGH_SEATS"])?E.open(!0,l).result.then(function(){return m.go("landing")}):O.checkForValidationException(e.validationErrors,"MAX_APPOINTMENTS_SCHEDULED")?f.open(!s.isEdit).result.then(function(){return m.go("landing")}):g.open().result.finally(function(){return m.go("landing")})});var o=!!S.isAGroupAppointmentGuest(l),a=d.post(N+"/save/"+o,l);return u.getResponseData(a)})},S.findSpouseInAppointment=function(t){var e=S.isLivingOrdinance(t.appointmentType);return y.getUserInfo(e).then(function(e){return t&&S.findSpouseInGuestList(e,t.guestList)})},S.findMrnInGuestList=function(t,e){return angular.isArray(e)?t&&e.find(function(e){return e.guestMrn===t}):null},S.findSpouseInGuestList=function(t,e){return angular.isArray(e)?t&&t.spouseInfo&&t.spouseInfo.mrn&&e.find(function(e){return e.guestMrn===t.spouseInfo.mrn}):null},S.countPatronsToParticipateInGroupOrdinance=function(e,t){return(e||0)+(t||0)},S.calculateAppointmentLengthInMinutes=function(e,t,n){if(e){var i=60*S.countPatronsToParticipateInGroupOrdinance(t,n)/e;return Math.ceil(i)}return null},S.appointmentsAreBothEndowments=function(e,t){return!(e!==v.LIVING_ENDOWMENT&&e!==v.PROXY_ENDOWMENT||t!==v.LIVING_ENDOWMENT&&t!==v.PROXY_ENDOWMENT)},S.appointmentsAreConflicting=function(e,t,n,i){return(e===n||S.appointmentsAreBothEndowments(e,n))&&(o=t,a=i,r=angular.isString(o)?new Date(o):o,l=angular.isString(a)?new Date(a):a,angular.equals(l,r));var o,a,r,l},S.findConflictingAppointment=function(t,e){var n=null;return e&&0<e.length&&e.forEach(function(e){!n&&S.appointmentsAreConflicting(t.appointmentType,t.appointmentDateTime,e.appointmentType,e.displayedAppointmentDate||l.getSlcDateTime(e.appointmentDateTime))&&(n=e)}),n},S.handleConflictingAppointment=function(e,t){r.open(e).result.then(function(){},function(){m.go("landing")}).catch(function(e){b.error("Unknown modal error while trying to notify user of conflicting appointments.",e),g.open(t)})},S.getSessionSeatInfoForTheGroupPatronCount=function(e,t){var n=0,i=!1;if(e.details){n=e.details.seatsAvailable||0;var o=A.getHoldData(e.appointmentType,e.appointmentTimeId);null!==o&&(n+=o.femaleHoldCnt+o.maleHoldCnt),i=!e.details.markAsFullFlag&&t<=n}return{available:n,needed:t,valid:i}},S.getSessionSeatInfoForTheEndowmentPatronCount=function(e,t){var n=0,i=!1;if(e.details){n=e.details.remainingOnlineSeatsAvailable||0;var o=A.getHoldData(e.appointmentType,e.appointmentTimeId);null!==o&&(n+=o.maleHoldCnt+o.femaleHoldCnt+o.neutralHoldCnt),i=t<=n}return{available:n,needed:t,valid:i}},S.getSessionSeatInfo=function(e,t,n,i,o,a,r,l,s,p,c,d){if(v.PROXY_ENDOWMENT===t||v.LIVING_ENDOWMENT===t){var u=S.getSessionSeatInfoForTheEndowmentPatronCount(e,a);return e.appointmentTimeId===d.appointmentTimeId&&(u.valid=!0),u}if(v.PROXY_INITIATORY===t){var m=S.currentAppointment?S.currentAppointment.appointmentTimeId:null;return function(e,t,n,i){var o=!0,a=!0,r=t.gender===T.MALE;n.isEdit&&n.editApptTimeId===e.appointmentTimeId&&(r?(n.origInclSelf===n.inclSelf&&(o=!1),n.origInclSpouse===n.inclSpouse&&(a=!1)):(n.origInclSelf===n.inclSelf&&(a=!1),n.origInclSpouse===n.inclSpouse&&(o=!1)));var l=0,s=0;r?n.inclSelf&&(l=1):n.inclSpouse&&(l=1),i.additionalMaleGuestCount&&(l+=i.additionalMaleGuestCount),0===l&&(l=-1e4),r?n.inclSpouse&&(s=1):n.inclSelf&&(s=1),i.additionalFemaleGuestCount&&(s+=i.additionalFemaleGuestCount),0===s&&(s=-1e4);var p=A.getHoldData(e.appointmentType,e.appointmentTimeId),c=e.details.maleSeatsAvailable,d=e.details.femaleSeatsAvailable;return null!==p&&(c+=p.maleHoldCnt,d+=p.femaleHoldCnt),{femaleAvailable:a?d:1/0,femaleNeeded:s,maleAvailable:o?c:1/0,maleNeeded:l,valid:e.details&&(!a||s<=d)&&(!o||l<=c)}}(e,o,{origInclSelf:S.origInclSelf,origInclSpouse:S.origInclSpouse,inclSelf:n,inclSpouse:i,isEdit:S.isEdit,editApptTimeId:m},d)}if(v.PROXY_SEALING===t||v.PROXY_BAPTISM===t){if(!r)return{available:1/0,needed:-1/0,valid:!0};var g=S.getSessionSeatInfoForTheGroupPatronCount(e,a);if(g.valid)return g}else if(v.LIVING_SEALING===t){var f=e.sealingRoomSeats,h=d.details.guestCount;return{available:f,needed:h,valid:h<=f}}return{available:-1/0,needed:1/0,valid:!1}},S.sessionIsAvailableForHold=function(e,t,n,i,o,a,r){var l,s=angular.copy(e);if(s&&s.appointmentTimeId&&s.appointmentTimeId===t.appointmentTimeId)return new Promise(function(e){e({status:"SUCCESS"})}).then(function(e){return e});if(s.details||(s.details={}),S.isLivingEndowment(s.appointmentType))s.details.type="endowment",s.details.guestCount=S.calculateLivingHoldGuestCounts(e);else if(S.isLivingSealing(s.appointmentType))s.details.type="sealing",s.details.locationId=t.sealingRoomId,s.details.guestCount=S.calculateLivingHoldGuestCounts(e);else{s.details.type="proxy";var p=S.getPatronCounts(s,s.contactInfo);s.details.malePatronCount=p[T.MALE],s.details.femalePatronCount=p[T.FEMALE],s.details.guestCount=p[T.MALE]+p[T.FEMALE]}s&&s.contactInfo&&s.contactInfo.uuid&&(l=s.contactInfo.uuid);var c={appointmentDto:s,uuid:l,sessionDto:t,inclSelf:n,inclSpouse:o,isEdit:r||null!==s.appointmentTimeId};return u.getResponseData(d.post("/api/appointmentTimeHold/setHold",c)).then(function(e){return e&&e.status&&"SUCCESS"===e.status&&A.setHoldData(c),e})},S.deleteSessionTimeHold=function(e,t,n){d.delete("/api/appointmentTimeHold/delete/".concat(e,"/").concat(t,"/").concat(n))},S.determineMalePatronCountForAppointment=function(e){return e&&e.details&&e.details.malePatronCount||0},S.determineFemalePatronCountForAppointment=function(e){return e&&e.details&&e.details.femalePatronCount||0},S.isProxyOrdinance=function(e){return!!e&&(v.PROXY_ENDOWMENT===e||v.PROXY_SEALING===e||v.PROXY_BAPTISM===e||v.PROXY_INITIATORY===e)},S.needsRegularRecommend=function(e){return!!e&&v.PROXY_BAPTISM!==e},S.isLivingOrdinance=function(e){return!!e&&(v.LIVING_ENDOWMENT===e||v.LIVING_SEALING===e)},S.isLivingEndowment=function(e){return!!e&&v.LIVING_ENDOWMENT===e},S.isLivingSealing=function(e){return!!e&&v.LIVING_SEALING===e},S.userCanScheduleAnotherAppointment=function(i){if(!i.templeOrgId||!i.appointmentDateTime||!i.appointmentType)return Promise.resolve(!0);var e=S.isLivingOrdinance(i.appointmentType);return y.getUserInfo(e).then(function(e){var t=i.id?i.id:i.appointmentId,n=d.post(N+"/validate",{templeOrgId:i.templeOrgId,mrn:e.mrn,spouseMrn:i.inclSpouse&&e.spouseInfo?e.spouseInfo.mrn:null,inclSelf:i.inclSelf,inclSpouse:i.inclSpouse,sessionDate:new Date(i.appointmentDateTime),appointmentTimeId:i.appointmentTimeId,appointmentType:i.appointmentType,guestCount:"schedule.guest"===m.current.name?1:null,isOnlineRequest:!0,appointmentId:t,isGuestConfirmation:"schedule.guest"===m.current.name,gender:e.gender});return u.getResponseData(n)})},S.getAppointmentsForDate=function(e){if(e){var t=e.getFullYear(),n=e.getMonth(),i=e.getDate();return u.getResponseData(d.get("".concat(N,"/getAppointmentsForDate/").concat(t,"/").concat(n,"/").concat(i)))}},S.determineGuestCount=function(e,t,n,i,o,a){if(S.isLivingOrdinance(e.appointmentType))return S.calculateLivingPatronCounts(e,t,n,i,o,a);var r=S.calculateMaleAndFemalePatronCounts(e,t,n,i,o);return r.malePatronCount+r.femalePatronCount},S.calculateMaleAndFemalePatronCounts=function(e,t,n,i,o){if(v.PROXY_BAPTISM===e.appointmentType)return{malePatronCount:S.determineMalePatronCountForAppointment(e),femalePatronCount:S.determineFemalePatronCountForAppointment(e)};if("schedule.guest"===m.current.name)return{malePatronCount:e.details.malePatronCount,femalePatronCount:e.details.femalePatronCount};var a=0,r=0;return e.additionalMaleGuestCount&&(a+=e.additionalMaleGuestCount),e.additionalFemaleGuestCount&&(r+=e.additionalFemaleGuestCount),t&&n&&(n.gender===T.MALE?a++:n.gender===T.FEMALE&&r++),i&&o&&(o.gender===T.MALE?a++:o.gender===T.FEMALE&&r++),{malePatronCount:a,femalePatronCount:r}},S.calculateLivingHoldGuestCounts=function(e){return"schedule.guest"===m.current.name?e.details.guestCount:e.additionalGuestCount?e.additionalGuestCount:0},S.calculateLivingPatronCounts=function(e,t,n,i,o,a){if("schedule.guest"===m.current.name)return e.details.guestCount;var r=0;return e.additionalGuestCount&&(r+=e.additionalGuestCount),e.appointmentType!==v.LIVING_SEALING&&(t&&(n||a)&&r++,i&&(o||a)&&r++),r},S.getMaleAndFemalePatronCountWithAppointmentInfo=function(e){var t=S.getPatronCounts(e,e.contactInfo);return{malePatronCount:t[T.MALE],femalePatronCount:t[T.FEMALE]}},S.isAGroupAppointment=function(e,t,n){if(!e||!c.appointmentTypeAllowsGroups(e.appointmentType))return!1;if(e.appointmentType===v.LIVING_SEALING)return!0;if(void 0===t)if(e.details&&e.details.guestCount)t=e.details.guestCount;else{var i=!1,o=!1,a=e.contactInfo||e.details;a&&(i=S.findMrnInGuestList(a.mrn,e.guestList),o=S.findSpouseInGuestList(a,e.guestList)),t=S.determineGuestCount(e,e.inclSelf,i,e.inclSpouse,o,!1)}return"LIVING_ENDOWMENT"===e.appointmentType?!(t<1||1===t&&S.isSelfGuestAndSpouseGuest(e,n)):!(t<2||2===t&&S.isSelfGuestAndSpouseGuest(e,n))},S.isSelfGuestAndSpouseGuest=function(e,t){var n=e.userInGuestList||!t&&e.inclSelf||e.contactInfo&&S.findMrnInGuestList(e.contactInfo.mrn,e.guestList);if((e.userSpouseInGuestList||!t&&e.inclSpouse||e.contactInfo&&S.findSpouseInGuestList(e.contactInfo,e.guestList))&&n)return!0},S.getArrivalTimeForSpecificAppointmentTime=function(e,t,n){var i=n.sloqArrivalTime&&S.isSloqAppt(e)?n.sloqArrivalTime:n.arrivalTime;return new Date(new Date(t).getTime()-6e4*i)},S.getArrivalTimeForAppointment=function(e,t){var n=t.sloqArrivalTime&&S.isSloqAppt(e)?t.sloqArrivalTime:t.arrivalTime;return new Date(new Date(e.appointmentDateTime).getTime()-6e4*n)},S.getArrivalTimeForAppointmentFromSlcDateTime=function(e,t){var n=t.sloqArrivalTime&&S.isSloqAppt(e)?t.sloqArrivalTime:t.arrivalTime;return new Date(new Date(l.getSlcDateTime(e.appointmentDateTime)).getTime()-6e4*n)},S.determineSeatsAvailableInSession=function(e){return e.appointmentType===v.PROXY_INITIATORY?null:e.appointmentType===v.PROXY_ENDOWMENT||e.appointmentType===v.LIVING_ENDOWMENT?e.details.remainingOnlineSeatsAvailable:e.details.seatsAvailable},S.removeGuestFromGroupAppointment=function(t,n,i){I.scrollToElement("top-of-landing-page"),C.open(n).result.then(function(){n.userIsScheduler=!1;var e=n.guestList.find(function(e){return e.guestMrn===t.mrn});e&&(e.appointmentGuestAction="REMOVE",h.$broadcast("showSpinner"),n.historyAction="DELETED",S.saveAppointment(n,!0).then(function(t){i.splice(i.indexOf(i.find(function(e){return e.id===t.id})),1),h.$broadcast("showSpinner")}))}).catch(function(e){"canceled"!==e&&"closed"!==e&&"backdrop click"!==e&&(h.$broadcast("showSpinner"),b.error("Unknown modal error while trying to delete appointment.",e),g.open(n.templeOrgId))})},S.removePatronFromAppointment=function(o,a,r){I.scrollToElement("top-of-landing-page"),C.open(a).result.then(function(){h.$broadcast("showSpinner"),a.userIsScheduler=!1;var e,t,n,i=a.patronList.find(function(e){return o&&o.mrn&&e.memberInfo&&e.memberInfo.mrn===o.mrn});i&&i.id&&(a.historyAction="DELETED",(e=i.id,t="".concat(N,"/removePatron/").concat(e),n=d.delete(t),u.getResponseData(n)).then(function(){r.splice(r.indexOf(r.find(function(e){return e.id===a.id})),1),h.$broadcast("showSpinner")}).catch(function(e){h.$broadcast("showSpinner"),O.displayGeneralErrorModal("Error when trying to remove patron from appointment.",e,a.templeOrgId)}))}).catch(function(e){"canceled"!==e&&"closed"!==e&&"backdrop click"!==e&&(h.$broadcast("showSpinner"),O.displayGeneralErrorModal("Unknown modal error while trying to remove patron from appointment.",e,a.templeOrgId))})},S.isGroupAppointmentScheduler=function(e){return e&&e.userIsScheduler&&S.isAGroupAppointment(e)},S.isAGroupAppointmentGuest=function(e){return e&&!e.userIsScheduler&&S.isAGroupAppointment(e)},S.userCanEditAppointment=function(e){return e&&e.onlineSchedulingIsEnabledForOrdinance&&e.userIsScheduler},S.getMonthKey=function(e,t,n,i,o,a,r){return e+"-"+t+"-"+o+"-"+(n?n.appointmentType:a)+(n?n.addSpouse?"-BOTH":n.gender?"-"+n.gender:"":i?"-BOTH":r?"-"+r:"")},S.getAppointmentTypeLabel=function(e){return(e?t.get("ordinanceType_"+e):"")||""},S.getCorrectAppointmentType=function(e){if(!e)return null;if(S.isAGroupAppointmentGuest(e)){if(e.appointmentType===v.LIVING_ENDOWMENT)return v.PROXY_ENDOWMENT;if(e.appointmentType===v.LIVING_SEALING)return v.PROXY_SEALING}return e.appointmentType},S.shouldDisableEditsAndCancellations=function(e){return e&&S.isLivingOrdinance(e.appointmentType)&&!S.isSloqAppt(e)},S.isNonEditableOpOrdinance=function(e){return e&&S.isLivingOrdinance(e.appointmentType)&&S.isSloqAppt(e)&&!e.userIsScheduler},S.shouldPreventAppointmentEditsOrCancellationsPromise=function(i,o){return i&&o&&o.preventEditsMinBefore?L.getCurrentTimeOfTempleByTempleOrgId(i.templeOrgId).then(function(e){var t=new Date(e.year,e.month-1,e.day,e.hour,e.minute),n=i.appointmentDateTime-t;return Math.round(n/6e4)<o.preventEditsMinBefore}):new Promise(function(e){return e(!1)})},S.isOpPatron=function(e,t){return e&&S.isSloqAppt(e)&&t&&t.mrn&&e.patronList.some(function(e){return e.memberInfo&&e.memberInfo.mrn===t.mrn})},S.isRequiredPatron=function(e,t){if(!e||!t||!e.patronList||e.patronList.length<1)return!1;var n=e.patronList.find(function(e){return t.mrn&&e.memberInfo&&t.mrn===e.memberInfo.mrn});if(!n)return!1;if("CHILD"!==n.patronType)return["HUSBAND","WIFE"].includes(n.patronType);var i=e.patronList.filter(function(e){return"CHILD"===e.patronType});return i&&1===i.length}}}]),angular.module("tos-ui").factory("exceptionService",["$state","sessionIsFullModal","scheduleLimitReachedModal","generalErrorModal","sessionNotAvailableModal","$log",function(e,n,i,o,a,r){var l=function(e,t){return!!e&&!!e.find(function(e){return t.includes(e.validationException)})},s=function(){e.go("landing")};return{checkForValidationException:l,checkBasicValidationExceptions:function(e,t){l(e.validationErrors,["PAST_APPOINTMENT","MIN_CUTOFF_SCHEDULE"])?a.open(t).then(function(){return s()}):l(e.validationErrors,["APPOINTMENT_TIME_NOT_ENOUGH_SEATS"])?n.open(!0,t).result.then((s(),function(){})):l(e.validationErrors,"MAX_APPOINTMENTS_SCHEDULED")?i.open(!0).result.then(function(){return s()},function(){return s()}):o.open().result.finally(function(){return s()})},displayGeneralErrorModal:function(e,t,n){(e||t)&&r.error(e,t),o.open(n)}}}]),angular.module("tos-ui").factory("feedbackMetadataService",["tosUserInfoService","$state","tisfTranslateService","screenSizeService","appointmentService",function(o,a,r,l,s){var p=function(){var e,t,n,i,o,a=!!document.documentMode,r=/Edg/.test(navigator.userAgent),l=!!window.opr&&!!window.opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),s="undefined"!=typeof InstallTrigger,p=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&window.safari.pushNotification).toString();return e=r,t=l,n=window.chrome,i=window.navigator,o=i.vendor,i.userAgent.match("CriOS")||null!=n&&"Google Inc."===o&&!1===t&&!1===e?"Chrome":r?"Edge":l?"Opera":s?"Firefox":p?"Safari":a?"Internet Explorer":"Other"};return{getMetaData:function(t,n,i){var e=!!t&&s.isLivingOrdinance(t.appointmentType);return o.getUserInfo(e).then(function(e){return{region:new Intl.Locale(navigator.language).region,platform:navigator.platform.includes("Mac")?"Mac":navigator.platform.includes("Win")?"Windows":navigator.platform.includes("Linux")?l.isMobileView?"Android":"Linux":navigator.platform,browser:p(),page:function(e,t){if(t)return"Appointment Scheduled Modal";if(!e)return null;var n="Step "+e+": ";switch(e+""){case"1":return n+r.get("scheduleAppointment.selectAnOrdinanceTitle");case"2":return n+r.get("scheduleAppointment.selectAppointmentTimeTitle");case"3":return n+r.get("scheduleAppointment.finalizeAppointmentTitle")}return null}(n,i)||a.current.page.omnitureName,dateSubmitted:new Date,personAge:e.age,personMarried:!(!e.spouseInfo||!e.spouseInfo.mrn),templeOrgId:t?t.templeOrgId:null,appointmentType:t?t.appointmentType:null,appointmentTimeId:t?t.appointmentTimeId:null}})}}}]),angular.module("tos-ui").factory("guestCountValidatorService",["$rootScope","AppointmentType",function(d,o){return new function(){this.livingGuestCountIsValid=function(e,t){var n=e.originalAdditionalGuestCount?e.originalAdditionalGuestCount:0,i=Math.max(e.appointment.additionalGuestCount,e.appointment.guestList.length);return e.appointment.appointmentType!==o.LIVING_SEALING&&i>t.maxNumberOfGuests&&(n<i||0===n)?!(d.patronCountExceedsMaxGroupSize=!0):!(d.patronCountExceedsMaxGroupSize=!1)},this.proxyGuestCountIsValid=function(e,t){if("PROXY_BAPTISM"!==e.appointment.appointmentType){var n=0,i=0;e.appointment.inclSelf&&("MALE"===e.appointment.contactInfo.gender?n++:i++),e.appointment.inclSpouse&&("MALE"===e.appointment.contactInfo.spouseInfo.gender?n++:i++);var o=e.originalAdditionalMaleGuestCount?e.originalAdditionalMaleGuestCount:0,a=e.originalAdditionalFemaleGuestCount?e.originalAdditionalFemaleGuestCount:0,r=Math.max(e.appointment.additionalMaleGuestCount,e.appointment.guestList.filter(function(e){return"MALE"===e.gender}).length-n),l=Math.max(e.appointment.additionalFemaleGuestCount,e.appointment.guestList.filter(function(e){return"FEMALE"===e.gender}).length-i);if(r+l>t.maxNumberOfGuests&&(p=l,c=a,(s=o)<r||c<p||0===s&&0===c))return!(d.patronCountExceedsMaxGroupSize=!0)}var s,p,c;return!(d.patronCountExceedsMaxGroupSize=!1)}}}]),angular.module("tos-ui").factory("httpService",["$q",function(t){return new function(){this.getResponseData=function(e){return e.then(function(e){return e.data},function(e){return t.reject(e.data)})}}}]),angular.module("tos-ui").factory("tosNavigationLinksService",["httpService","$http","$cacheFactory","$log",function(n,i,e,t){var o=e("navigationLinksCache"),a=function(e){var t="navigationLinks-"+e;return o.get(t)||o.put(t,n.getResponseData(i.get("/api/navigationLinks/"+e))),o.get(t)};return{isTempleGvsgEnabled:function(e){return a(e).then(function(e){if(e){var t=e.find(function(e){return"ORDINANCE_CONFIG"===e.pageName});return t&&"REACT"===t.applicationFramework}return!1}).catch(function(e){return t.error("Error getting navigation links for temple",e),!1})},getNavigationLinksForTemple:a,getReactUrl:function(){return n.getResponseData(i.get("/api/url/reactSiteUrl"))}}}]),angular.module("tos-ui").factory("sloqService",["AppointmentType","tosLivingSealingService","tosDateService","appointmentService","tosUserInfoService","SealingType","mrnUtil",function(u,m,g,e,n,i,f){return new function(){var r=this,l=!1,s=!1,a=!1,p=new Date,c={hasStarted:!1,isReady:!1,earliestScheduleDate:p,latestScheduleDate:null},d={hasStarted:!1,isReady:!1,earliestScheduleDate:p},t=[i.WIFE_TO_HUSBAND_SEALING,i.CHILD_TO_PARENTS_SEALING];r.initializeSloqData=function(n){if(l=n.unit&&n.unit.isSloqUnit,s=!!n.endowmentDate,n.activeOrdinances&&0<n.activeOrdinances.length){var i=null,o=[];n.activeOrdinances.forEach(function(e){if(e.ordinance.ordinanceType.includes("SEALING")){var t=e.ordinance.participants.find(function(e){return e&&e.confidential&&e.confidential.person&&f.mrnsAreEqual(e.confidential.person.mrn,n.mrn)});e.userCanSchedule=!t.role.includes("CHILD")||t.canScheduleAppointment,o.push(e)}else"ENDOWMENT"===e.ordinance.ordinanceType&&(i=e)});var e=o[0];if(i&&(c.hasStarted=!0,c.isReady=i.ordinance&&i.ordinance.canScheduleOrdinance,i.confidential&&i.confidential.earliestScheduleDate)){var t=g.parseDateAsLocalTime(i.confidential.earliestScheduleDate);c.earliestScheduleDate=t<p?p:t}if(e&&(d.hasStarted=!0,d.isReady=e.ordinance&&e.ordinance.canScheduleOrdinance&&e.userCanSchedule),1===o.length&&e.confidential&&e.confidential.earliestScheduleDate){var a=g.parseDateAsLocalTime(e.confidential.earliestScheduleDate);d.earliestScheduleDate=a<p?p:a}0<o.length&&m.initializeLivingSealingData(o),r.syncAppointmentData()}},r.syncAppointmentData=function(){e.getExistingAppointments().then(function(e){if(0<e.length&&e.forEach(function(e){e.appointmentDateTime&&!angular.isDate(e.appointmentDateTime)&&(e.appointmentDateTime=new Date(e.appointmentDateTime))}),m.updateSealingsWithAppointmentData(e),!s){var t=e.find(function(e){return e.appointmentType===u.LIVING_ENDOWMENT});if(t&&t.appointmentDateTime&&angular.isDate(t.appointmentDateTime)){var n=angular.copy(t.appointmentDateTime);n.setHours(t.appointmentDateTime.getHours()+2),d.earliestScheduleDate=n<=p?p:n>=d.earliestScheduleDate?n:d.earliestScheduleDate}else d.earliestScheduleDate=p>=d.earliestScheduleDate?p:d.earliestScheduleDate}var i=e.filter(function(e){return e.appointmentType===u.LIVING_SEALING});if(0<i.length&&i[0].appointmentDateTime&&angular.isDate(i[0].appointmentDateTime)){a=!0,1<i.length&&i.sort(function(e,t){return e.appointmentDateTime-t.appointmentDateTime});var o=i[0];o&&o.appointmentDateTime&&angular.isDate(o.appointmentDateTime)&&(c.latestScheduleDate=o.appointmentDateTime)}else a=!1,c.latestScheduleDate=null})},r.livingSealingSelected=function(){var e=m.getEarliestScheduleDate();e&&(d.earliestScheduleDate=e>d.earliestScheduleDate?e:d.earliestScheduleDate)},r.isUnitSloqEnabled=function(){return l},r.userHasStartedSloqProcess=function(e){switch(e){case u.LIVING_ENDOWMENT:return c.hasStarted;case u.LIVING_SEALING:return d.hasStarted;default:return!1}},r.getEarliestScheduleDate=function(e){switch(e){case u.LIVING_ENDOWMENT:return c.earliestScheduleDate;case u.LIVING_SEALING:return d.earliestScheduleDate;default:return new Date}},r.isValidScheduleDate=function(e,t){switch(e){case u.LIVING_ENDOWMENT:return c.latestScheduleDate?t<=c.latestScheduleDate||t.toDateString()===c.latestScheduleDate.toDateString():t>=c.earliestScheduleDate||t.toDateString()===c.earliestScheduleDate.toDateString();case u.LIVING_SEALING:return t>=d.earliestScheduleDate||t.toDateString()===d.earliestScheduleDate.toDateString();default:return!1}},r.isValidScheduleTime=function(e,t){var n=angular.copy(t);switch(e){case u.LIVING_ENDOWMENT:return c.latestScheduleDate&&a?(n.setHours(n.getHours()+2),n<=c.latestScheduleDate):c.earliestScheduleDate===p||c.earliestScheduleDate<=t;case u.LIVING_SEALING:return d.earliestScheduleDate===p||d.earliestScheduleDate<=n;default:return!1}},r.userIsSloqReady=function(e){switch(e){case u.LIVING_ENDOWMENT:return c.isReady;case u.LIVING_SEALING:return d.isReady;default:return!1}},r.tosSloqAppointmentTypesEqual=function(e,t){return t.includes("ENDOWMENT")&&"LIVING_ENDOWMENT"===e||t.includes("SEALING")&&"LIVING_SEALING"===e},r.userHasScheduledLivingSealing=function(){return a},r.getLatestEndowmentDate=function(){return c.latestScheduleDate},r.assignSloqOrdIds=function(i,o){i&&o&&n.getUserInfo(!0).then(function(e){if(e){var t=e.activeOrdinances;if(u.LIVING_ENDOWMENT===o){var n=t.find(function(e){return e.ordinance&&"ENDOWMENT"===e.ordinance.ordinanceType});i.sloqSealingSpouseId=null,i.sloqSealingChildrenId=null,i.sloqEndowmentId=n.ordinance.id}}})},r.isOpSealingOrdinance=function(e){return t.includes(e)},r.someSealingsReady=function(e){return!(!e||e.length<1)&&e.some(function(e){return e.ordinance&&r.isOpSealingOrdinance(e.ordinance.ordinanceType)&&e.ordinance.canScheduleOrdinance})}}}]),angular.module("tos-ui").factory("snackbarService",["$rootScope","$timeout",function(n,i){return new function(){var t=0;this.openSnackbar=function(e){n.$broadcast("showSnackbar"),i(function(){0===t?n.$broadcast("hideSnackbar"):t--},e||5e3)},this.addTransitionInProgress=function(){return t++},this.resetTransitionsInProgress=function(){return t=0}}}]),angular.module("tos-ui").factory("tosAdobeAnalyticsService",["tisfTranslateService","$window","$location",function(n,c,d){return new function(){var l=this;c.digitalDataEvents={pageView:"Page View",productView:"Product View",authenticate:"Authenticate",addToCart:"Add to Cart",removeFromCart:"Remove from Cart",checkout:"Checkout",purchase:"Purchase",search:"Search",component:{click:"Component Click",share:"Share",formStart:"Form Start",formError:"Form Error",formSubmit:"Form Submit",formStepComplete:"Form Step Complete",formAbandon:"Form Abandon",download:"Download",checklistUpdated:"Checklist Updated",chat:"Chat",load:"Component Load",siteNavigation:"Site Navigation",media:{play:"Play",stop:"Stop",updatePlayerSettings:"Update Player Settings"},virtual:{experienceStart:"Virtual Experience Start",checkpointReached:"Virtual Checkpoint Reached",experienceComplete:"Virtual Experience Complete"}}};var o=function(e,t){var n,i=e.indexOf(t);if(-1<i){var o=e.substring(i),a=o.indexOf("=");if(-1===a)return null;var r=o.substring(a+1);return-1===(n=r.search("[^a-zA-Z0-9]"))&&(n=r.length),r.substring(0,n)}return null},a=function(e){return e&&0<e.length&&"en"===e?"eng":e},p=function(e){var t=e.search();if(t&&t.lang&&angular.isString(t.lang))return t.lang;if(t&&t.locale&&angular.isString(t.locale))return t.locale;var n=e.absUrl(),i=o(n,"locale");return i&&0<i.length?a(i):(i=o(n,"lang"))&&0<i.length?a(i):null};l.getPageName=function(e){var t="";return e&&e.page&&(angular.isString(e.page.omnitureName)?t=e.page.omnitureName:angular.isString(e.page.name)?t=n.get(e.page.name,void 0,e.page.name):angular.isFunction(e.page.name)&&(t=e.page.name(e))),t},l.trackPageViewFromState=function(e){var t,n,i,o,a,r=(t=e,i={},o=l.getPageName(t),a=p(d),!n||o&&0!==o.length||(o=n),i={info:{name:o,language:a,siteName:"Temple Online Scheduling"},category:{primary:"TOS Appointment"}},a&&(i.info.language=a),i);c.digitalData=c.digitalData||[],c.digitalData.push({event:c.digitalDataEvents.pageView,page:r})},l.trackPageView=function(e,t,n){var i,o,a,r,l,s=(i=e,o=t,a=n,r=p(d),l={info:{name:i,siteName:"Temple Online Scheduling"},category:{primary:"TOS Appointment"}},(o||r)&&(l.info.language=o||r),a&&(l.category.type=a),l);c.digitalData=c.digitalData||[],c.digitalData.push({event:c.digitalDataEvents.pageView,page:s})},l.stateChangeHandler=function(e){var t=e.to();l.trackPageViewFromState(t)}}}]),angular.module("tos-ui").factory("tosCalendarService",["$filter","$uibModal","$window","tisfTranslateService","localizeDateTimeFilter","tosTempleNameFilter","tosAppointmentTypeFilter","$http","httpService","$q","tosTempleInfoService","tosUrlService","addToCalendarModal","tosPlatformService","tosTempleConfigService","AppointmentType","tosUserInfoService","tosDateService","appointmentService","$log",function(g,e,s,y,b,A,I,t,n,i,r,p,c,d,u,C,o,O,E,m){var f="addToCalendar.iOS",h="addToCalendar.Outlook",S="addToCalendar.GoogleOnline",$="addToCalendar.OutlookOnline",T=y.get("calendarEvent.editAppointmentLinkText"),L="[edit-appointment]",v=function(d,e,u,m,g,f,h){return r.getLanguageAssistanceName(d.appointmentType,d.language||null).then(function(c){var e=E.isLivingOrdinance(d.appointmentType);return o.getIndexOfSpouseGuest(d.guestList,e).then(function(e){return r.getLanguageAssistanceName(d.appointmentType,d.guestList&&d.guestList[e]&&d.guestList[e].language||null).then(function(e){var t;d.guestList.forEach(function(e){e.guestMrn===h.mrn&&(t=e.language)});var n,i,o,a,r,l,s=(n=u)===S?"<br>":n===$?"%0a":"\\\\n",p=function(e,t,n,i,o,a,r,l,s,p){var c=[];c.push(y.get("calendarEvent.yourAppointmentSectionTitle")),c.push(t),e.spouseIsIncluded&&c.push(y.get("finalizeAppointment.includingSpouse")),(!r&&p||r&&p)&&(r=p,c.push(y.get("calendarEvent.languageAssistanceRequested",r))),l&&c.push(y.get("calendarEvent.spouseLanguageAssistanceRequested",l)),(e.spouseIsIncluded||r)&&c.push(t);var d=A(e.templeOrgId);c.push(d);var u=I(e.appointmentType);c.push(u),E.isAGroupAppointment(e)&&e.details.groupName&&c.push(y.get("appointmentDetails.groupName",e.details.groupName)),c.push(t);var m,g=O.getSlcDateTime(e.appointmentDateTime);if(c.push(b(g,b.formatNames.weekday)),c.push(b(g,b.formatNames.dateShort)),c.push(b(g,b.formatNames.time)),c.push(y.get("myAppointments.allAppointmentTimesLocalToTemple")),c.push(t),E.userCanEditAppointment(e)&&c.push(L),c.push(t),o){var f=o.addressComposed||o.primaryAddress;f&&(c.push(y.get("calendarEvent.addressSectionTitle")),f.split(/\r\n|\r|\n/).forEach(function(e){e=e.replace(/(\r\n|\n|\r)/gm,""),c.push(e)}),c.push(t))}o&&o.phones&&angular.isArray(o.phones)&&(c.push(y.get("calendarEvent.phoneSectionTitle")),o.phones.forEach(function(e){if(e&&1===e.phoneTypeId){var t=a===$?encodeURIComponent(e.phoneNumber):e.phoneNumber;c.push(t),m=!0}}),m||o&&o.phones&&0<o.phones.length&&c.push(o.phones[0].phoneNumber)),c.push(t);var h=i.clothingOperations?"calendarEvent.clothingRentalIsAvailable":"calendarEvent.noClothingRentalAvailable",S=i.cafeteriaOperations?"calendarEvent.cafeteriaIsAvailable":"calendarEvent.noCafeteriaAvailable",T=i.patronHousing?"calendarEvent.patronHousingIsAvailable":"calendarEvent.noPatronHousingAvailable",v=i.distributionCenterOnsite?"calendarEvent.distributionCenterOnsite":i.distributionCenterNearby?"calendarEvent.distributionCenterNearby":"calendarEvent.noDistributionCenterAvailable";return c.push(y.get("calendarEvent.servicesSectionTitle")),c.push(y.get(h)),c.push(y.get(S)),c.push(y.get(T)),c.push(y.get(v)),c.push(t),c.push(t),c.push(y.get("calendarEvent.arriveBeforeSession",e.arrivalTime)),c.push(y.get("calendarEvent.bringTempleRecommend")),e.appointmentType!==C.PROXY_BAPTISM&&c.push(y.get("calendarEvent.bringTempleClothes")),c.push(t),c.push(y.get("calendarEvent.reminderEmailNotice")),c}(d,s,0,g,f,u,c,e,0,t);return"<br>"===s?(i=s,o=m,a=T,p.join(i).replace(/<br><br>/g,i).replace(L,'<a href="'+o+'">'+a+"</a>")):"%0a"===s?function(e,t,n){e.forEach(function(e){e!==L&&(e=(e=(e=encodeURIComponent(e)).replace(/\(/g,"")).replace(/\)/g,""))});var i=e.join(t).replace(/%0a%0a%0a%0a/g,t),o=encodeURIComponent(T+": "+n);return i=i.replace(L,o)}(p,s,m):(r=s,l=m,p.join("   "+r).replace(/\\\\n\\\\n/g,r).replace(L,T+": "+l))})})})},N=function(l,s,e,t,p,n){var i,o=(i=s)===S?"yyyyMMddTHHmmss":i===h?"yyyy-MM-ddTHH:mm:ss":"yyyy-MM-ddTHH:mm:ssZ",a=O.getSlcDateTime(new Date(l.appointmentDateTime)),r=O.getUserTimeOffsetToSlc();a.setHours(a.getHours()-p.slcTimeDifference-r.hourOffset),a.setMinutes(a.getMinutes()-r.minuteOffset);var c=new Date(a);angular.isString(c)&&(c=new Date(c));var d=new Date(c.getTime()+36e5),u=g("date")(c,o),m=g("date")(d,o);return v(l,0,s,e,t,p,n).then(function(e){var t,n,i,o,a,r=(t=I(l.appointmentType),n=O.getSlcDateTime(l.appointmentDateTime),y.get("calendarEvent.eventTitle",[t,g("date")(n,"dd MMM yyyy")]));return p&&(o=p.addressComposed||p.primaryAddress,a=[],o&&o.split(/\r\n|\r|\n/).forEach(function(e){e=e.replace(/(\r\n|\n|\r)/gm,""),a.push(e)}),i=a.join(" ")),{subject:r,body:e,startDate:s===f?c:u,endDate:s===f?d:m,location:i}})},a=function(e){return("0000"+e.getUTCFullYear().toString()).slice(-4)+("00"+(e.getUTCMonth()+1).toString()).slice(-2)+("00"+e.getUTCDate().toString()).slice(-2)+"T"+("00"+e.getUTCHours().toString()).slice(-2)+("00"+e.getUTCMinutes().toString()).slice(-2)+("00"+e.getUTCSeconds().toString()).slice(-2)+"Z"},M=function(e){var t,n,i=document.createElement("a"),o=(t=e.startDate,n=e.endDate,{dtstart:a(new Date(t)),dtend:a(new Date(n)),dtsubmit:(new Date).getTime(),dtstamp:a(new Date)});i.href="/api/calendar/TempleAppointment.ics?dtstart="+encodeURIComponent(o.dtstart)+"&dtend="+encodeURIComponent(o.dtend)+"&location="+encodeURIComponent(e.location)+"&summary="+encodeURIComponent(e.subject)+"&description="+encodeURIComponent(e.body)+"&dtsubmit="+encodeURIComponent(o.dtsubmit)+"&dtstamp="+encodeURIComponent(o.dtstamp),i.download="",i.target="_self",document.body.appendChild(i),i.click(),i.remove()};return{addAppointmentToCalendar:function(e,o){var a,l=angular.copy(e),t=[p.getEditAppointmentUrl(l.id),r.getTempleServices(l.templeOrgId),r.getTempleContactInfo(l.templeOrgId),u.getOrdinanceConfig(l.templeOrgId,l.appointmentType)],n=[];d.isiOS()?d.isSafari()?n.push({name:f}):n.push({name:"addToCalendar.iOSSafariOnly",isDisabled:!0}):n.push({name:f,isDisabled:!0}),n.push({name:"addToCalendar.Android",isDisabled:!d.isAndroid()}),d.isiOS()||d.isAndroid()?n.push({name:"addToCalendar.OutlookDesktopOnly",isDisabled:!0}):n.push({name:h}),n.push({name:S}),n.push({name:$}),c.open(n).result.then(function(r){i.all(t).then(function(e){var t=e[0],n=e[1],i=e[2];l.arrivalTime=e[3].arrivalTime||15,a=t?t.url:"",N(l,r,a,n,i,o).then(function(e){var t,n,i,o,a;"addToCalendar.Android"===(a=r)||"addToCalendar.iOS"===a||"addToCalendar.iOSSafariOnly"===a||"addToCalendar.Outlook"===a?M(e):r===S?(o="http://www.google.com/calendar/event?action=TEMPLATE&dates="+(i=e).startDate+"%2F"+i.endDate+"&text="+encodeURIComponent(i.subject)+"&location="+encodeURIComponent(i.location)+"&details="+encodeURIComponent(i.body),s.open(o)):r===$?(n="https://outlook.live.com/owa/?path=/calendar/action/compose&rru=addevent&startdt="+(t=e).startDate+"&enddt="+t.endDate+"&subject="+encodeURIComponent(t.subject)+"&location="+encodeURIComponent(t.location)+"&body="+t.body,s.open(n)):m.error("Unknown calendar option",r)})})})}}}]),angular.module("tos-ui").factory("correspondenceService",["$http","$q","$log","httpService",function(o,a,r,l){var s="/api/correspondence";return new function(){this.resendConfirmationEmail=function(e){if(!e){var t="Error with resending the invitation.";return r.warn(t),a.reject(t)}var n=o.post(s+"/resendConfirmationEmail",e);return l.getResponseData(n).then(function(e){if(!e){var t="Error with resending the guest invitation.";return r.warn(t),a.reject(t)}})},this.resendConfirmationEmailGuest=function(e,t){if(!e){var n="Error with resending the invitation.";return r.warn(n),a.reject(n)}var i=o.post(s+"/resendConfirmationEmailGuest/"+t,e);return l.getResponseData(i).then(function(e){if(!e){var t="Error with resending the guest invitation.";return r.warn(t),a.reject(t)}})}}}]),angular.module("tos-ui").factory("tosDateService",function(){var n=function(e){return angular.isDate(e)&&e.valueOf()},o=function(e){if(!e||-1===e.indexOf(":"))return null;var t=e.split(":");return{hour:Math.floor(t[0]),minutes:Math.floor(t[1])}},r=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Date;return new Date(new Date(new Date(e).toLocaleString("en-US",{timeZone:"America/Denver"})).toUTCString())};return{isValidDate:n,tryGetValidDate:function(e){if(n(e))return e;var t=new Date(e);return n(t)?t:null},getTimePartsFromTimeString:o,getDateWithCorrectTime:function(e,t){if(!t)return null;var n=o(e);if(!n)return null;var i=new Date(t);return angular.isDate(i)?(i.setHours(n.hour),i.setMinutes(n.minutes),i):null},getUserTimeOffsetToSlc:function(){var e=new Date,t=r(e),n=new Date(e.toUTCString()),i=0,o=0<t.getUTCDate()-n.getUTCDate()?-1:t.getUTCDate()-n.getUTCDate()<0?1:0,a=t.getUTCHours()-n.getUTCHours()+24*o;return t.getUTCMinutes()!==n.getUTCMinutes()&&(i=t.getUTCMinutes()-n.getUTCMinutes()),{hourOffset:a,minuteOffset:i}},getSlcDateTime:r,addTimeToTimeString:function(e,t){t=parseInt(t);var n=parseInt(t/60),i=t%60;return parseInt(e.split(":")[0])+n+":"+(parseInt(e.split(":")[1])+i)},parseDateAsLocalTime:function(e){return new Date(e.replace(/-/g,"/"))}}}),angular.module("tos-ui").factory("feedbackService",["$http","$q","$log","httpService","$cacheFactory","tisfTranslateService",function(n,i,o,r,e,l){var s="/api/feedback",t=e("feedback"),p="feedbackQuestions";return new function(){var e=this;e.getFeedbackQuestions=function(){if(!t.get(p)){var e=r.getResponseData(n.get("/api/feedback/findAllQuestions")).then(function(e){return e});t.put(p,e)}return t.get(p)},e.checkIfUserSubmittedFeedback=function(){return r.getResponseData(n.get("/api/feedback/userSubmittedFeedback")).then(function(e){return e})},e.saveFeedback=function(e){if(e)return r.getResponseData(n.post(s+"/save",e));var t="No feedback to save";return o.warn(t),i.reject(t)},e.prepareFeedbackDataToSave=function(e,t){var n=angular.copy(e);return n.answeredQuestions||(n.answeredQuestions=[]),n.questionTextList=[],t.forEach(function(e){n.questionTextList.push({questionId:e.questionId,englishText:l.get(e.appLookupKey)}),function t(e,n){var i=e.radioButtonQuestions&&1<e.radioButtonQuestions.length?e.radioButtonQuestions:e.childQuestions;i&&0<i.length&&i.forEach(function(e){n.push({questionId:e.questionId,englishText:l.get(e.appLookupKey)}),t(e,n)})}(e,n.questionTextList)}),n.scheduledStatus="1"===n.scheduledStatus,n};var a=function(t,n,e){return e.filter(function(e){return e.parentId===t.questionId&&e.questionType===n})};e.prepareQuestionsForRendering=function(e){var t=[],o=[];return e.forEach(function(e){e.parentId?o.push(e):t.push(e)}),t.forEach(function(e){var t=a(e,"RADIO_PARENT",o),n=a(e,"RADIO",o);n=n.concat(t),e.radioButtonQuestions=n;var i=function n(e,i){var t,o=(t=e,i.filter(function(e){return e.parentId===t.questionId}));return o&&0<o.length&&o.forEach(function(e){var t=n(e,i);t&&0<t.length&&(e.childQuestions=t)}),o}(e,o);e.childQuestions=i.filter(function(t){return!n.some(function(e){return e.questionId===t.questionId})})}),t}}}]),angular.module("tos-ui").factory("tosHoldService",["$http","httpService",function(o,n){var i=0,a=0,r=0,l=null,s=null,p=function(){r=a=i=0,l=null},t=function(e,t,n){if(p(),e&&t){var i=!0===n;o.delete("/api/appointmentTimeHold/delete/".concat(e,"/").concat(t,"/").concat(i))}};return{setHoldData:function(e){var t=e.appointmentDto,n=e.sessionDto;switch(t.appointmentType,l=n.appointmentTimeId,s=t.contactInfo.uuid,t.appointmentType){case"PROXY_BAPTISM":case"PROXY_SEALING":a=t.details.malePatronCount||0,r=t.details.femalePatronCount||0;break;case"PROXY_ENDOWMENT":case"PROXY_INITIATORY":"MALE"===t.contactInfo.gender?(a=!0===e.inclSelf?1:0,r=!0===e.inclSpouse?1:0):"FEMALE"===t.contactInfo.gender&&(r=!0===e.inclSelf?1:0,a=!0===e.inclSpouse?1:0),r+=t.additionalFemaleGuestCount,a+=t.additionalMaleGuestCount;break;case"LIVING_ENDOWMENT":case"LIVING_SEALING":i=t.details.guestCount}},getHoldData:function(e,t){return l===t?{apptType:e,apptTimeId:l,maleHoldCnt:a,femaleHoldCnt:r,neutralHoldCnt:i}:null},clearHoldData:function(e){!0===e&&null!==s&&null!==l&&t(l,s,!0),p()},deleteSessionTimeHold:t,extendSessionTimeHold:function(e,t){return n.getResponseData(o.get("/api/appointmentTimeHold/extendHold/".concat(e,"/").concat(t)))}}}]),angular.module("tos-ui").factory("tosLivingSealingService",["AppointmentType","tosDateService","tspPatron","tisfTranslateService","mrnUtil","$state","tspPatronService","SealingType","tosTempleScheduleService","appointmentTypeService",function(p,c,d,u,m,g,f,h,S,T){return new function(){var a=this,t=[];a.parsedLivingSealings=[];var o=null,r=[],e=new Date,l=function(){return{id:"",type:"",earliestScheduleDate:e,isLicensedMarriage:!1,sealingType:"",wifeOrMother:null,husbandOrFather:null,children:[],observers:[],patronList:[],alreadyScheduled:!1,scheduledAppointment:null,addChildren:!1,childrenSealingId:null,htwSealingId:null,optionalChildren:[],optionalObservers:[],hasNonSloq:!1}},i=function(e,t){return!!(e&&e.confidential&&e.confidential.person&&e.confidential.person.mrn&&t&&t.confidential&&t.confidential.person&&t.confidential.person.mrn)&&e.confidential.person.mrn===t.confidential.person.mrn};a.addConnectedCTPtoHTW=function(){var n=a.parsedLivingSealings.filter(function(e){return e.type===h.CHILD_TO_PARENTS_SEALING});a.parsedLivingSealings.forEach(function(t){if(t.type===h.WIFE_TO_HUSBAND_SEALING){var e=n.find(function(e){return i(e.husbandOrFather,t.husbandOrFather)&&i(e.wifeOrMother,t.wifeOrMother)});e&&(t.childrenSealingId=e.id,t.optionalChildren=e.children,t.optionalObservers=e.observers)}})},a.addConnectedHTWtoCTP=function(){var n=a.parsedLivingSealings.filter(function(e){return e.type===h.WIFE_TO_HUSBAND_SEALING});a.parsedLivingSealings.forEach(function(t){if(t.type===h.CHILD_TO_PARENTS_SEALING){var e=n.find(function(e){return i(e.husbandOrFather,t.husbandOrFather)&&i(e.wifeOrMother,t.wifeOrMother)});e&&(t.htwSealingId=e.id)}})},a.initializeLivingSealingData=function(e){t=e,a.parsedLivingSealings=[],0<t.length&&t.forEach(function(e){var t,n,i=l();if(i.type=e.ordinance.ordinanceType,i.earliestScheduleDate=c.parseDateAsLocalTime(e.ordinance.earliestScheduleDate),i.hasNonSloq=e.ordinance.hasNonSloq,i.canScheduleOrdinance=e.ordinance.canScheduleOrdinance,0<e.ordinance.participants.length&&(i.isLicensedMarriage=e.willBeCivillyMarriedInTemple,i.id=e.ordinance.id,i.type===h.WIFE_TO_HUSBAND_SEALING?(i.wifeOrMother=e.ordinance.participants.find(function(e){return"WIFE"===e.role}),i.husbandOrFather=e.ordinance.participants.find(function(e){return"HUSBAND"===e.role}),i.isLicensedMarriage?i.sealingType=h.LICENSED:i.wifeOrMother&&i.wifeOrMother.confidential&&i.wifeOrMother.confidential.person&&i.wifeOrMother.confidential.person.isLiving&&i.husbandOrFather&&i.husbandOrFather.confidential&&i.husbandOrFather.confidential.person&&i.husbandOrFather.confidential.person.isLiving?i.sealingType=h.SEAL_AFTER_CIVIL:i.sealingType=h.SEAL_TO_DECEASED):(i.wifeOrMother=e.ordinance.participants.find(function(e){return"MOTHER"===e.role}),i.husbandOrFather=e.ordinance.participants.find(function(e){return"FATHER"===e.role}),i.children=e.ordinance.participants.filter(function(e){return"CHILD"===e.role&&e.canScheduleAppointment}),i.observers=e.ordinance.participants.filter(function(e){return"CHILD_OBSERVER"===e.role&&e.canScheduleAppointment}),i.sealingType=h.PARENTS_SEALED,(t=i.patronList).push.apply(t,_toConsumableArray(i.children)),(n=i.patronList).push.apply(n,_toConsumableArray(i.observers))),i.wifeOrMother&&i.patronList.push(i.wifeOrMother),i.husbandOrFather&&i.patronList.push(i.husbandOrFather)),r&&0<r.length){var o=r.find(function(e){return e.sloqSealingSpouseId&&e.sloqSealingSpouseId===i.id||e.sloqSealingChildrenId&&e.sloqSealingChildrenId===i.id});o&&(i.alreadyScheduled=!0,i.scheduledAppointment=o)}!a.parsedLivingSealings.some(function(e){return e.id===i.id})&&i.canScheduleOrdinance&&a.parsedLivingSealings.push(i)}),1<a.parsedLivingSealings.length&&a.parsedLivingSealings.some(function(e){return e.sealingType===h.PARENTS_SEALED})&&a.addConnectedCTPtoHTW(),1<a.parsedLivingSealings.length&&a.parsedLivingSealings.some(function(e){return e.type===h.WIFE_TO_HUSBAND_SEALING})&&a.addConnectedHTWtoCTP()},a.clearSelectedSealing=function(){o=null},a.changeSealingForAppointmentEdit=function(t){if(0<a.parsedLivingSealings.length&&t){var e=null;if(t.sloqSealingChildrenId&&t.sloqSealingSpouseId){e=a.parsedLivingSealings.find(function(e){return t.sloqSealingSpouseId&&t.sloqSealingSpouseId===e.id});var n=a.parsedLivingSealings.find(function(e){return t.sloqSealingChildrenId&&t.sloqSealingChildrenId===e.id});n&&(e.addChildren=!0,e.childrenSealingId=n.id,e.optionalChildren=n.children,e.optionalObservers=n.observers)}else e=a.parsedLivingSealings.find(function(e){return t.sloqSealingSpouseId&&t.sloqSealingSpouseId===e.id||t.sloqSealingChildrenId&&t.sloqSealingChildrenId===e.id});e&&(o=e)}else t&&a.setupGuestOrEditDetails(t)},a.editSealingAppointment=function(n){S.getSession(p.LIVING_SEALING,o.scheduledAppointment.appointmentTimeId,o.scheduledAppointment.templeOrgId).then(function(e){if(a.changeSealingForAppointmentEdit(o.scheduledAppointment),n){var t=T.getId(o.scheduledAppointment.appointmentType);g.go("schedule.finalize",{appointment:o.scheduledAppointment,isCombineSealing:n,templeOrgId:o.scheduledAppointment.templeOrgId,appointmentTypeId:T.isValidAppointmentType(t)?t:null,appointmentTimeId:o.scheduledAppointment.appointmentTimeId})}else g.go("schedule.edit",{appointment:o.scheduledAppointment,selectedDate:o.scheduledAppointment.appointmentDateTime?new Date(o.scheduledAppointment.appointmentDateTime):new Date,appointmentId:o.scheduledAppointment.id,session:e,isEdit:!0})})},a.hasNonSloqParticipants=function(){return 1===a.parsedLivingSealings.length&&a.parsedLivingSealings.some(function(e){return e.hasNonSloq})},a.changeSealingType=function(t){a.parsedLivingSealings.forEach(function(e){e.id===o.id&&(e.sealingType===h.LICENSED&&(e.isLicensedMarriage=!1),e.sealingType=t,o=e)})},a.getSealingType=function(e){return e?e.sealingType||"DEFAULT":o?o.sealingType:"DEFAULT"},a.getSealingTypeMessage=function(){return u.get("scheduleAppointment.sealing."+a.getSealingType()+(a.getAddChildren()?".children.added":""))},a.getMaleAdultName=function(e){var t="";return!e&&o?t=a.getHusbandOrFathersName(o):e&&(t=a.getHusbandOrFathersName(e)),a.isChildToParentSealing()&&!o.addChildren?u.get("scheduleAppointment.sealing.father",t):u.get("scheduleAppointment.sealing.husband",t)},a.getFemaleAdultName=function(e){var t="";return!e&&o?t=a.getWifeOrMothersName(o):e&&(t=a.getWifeOrMothersName(e)),a.isChildToParentSealing()&&!o.addChildren?u.get("scheduleAppointment.sealing.mother",t):u.get("scheduleAppointment.sealing.wife",t)},a.getAddChildren=function(){return o&&o.addChildren},a.shouldShowChildrenAndObservers=function(){return o&&(a.isChildToParentSealing()||o.addChildren)},a.getChildrenForSealing=function(){return a.getChildren()},a.getObserversForSealing=function(){return a.getObservers()},a.setupGuestOrEditDetails=function(e){var t,n,i=l();i.sealingType=e.details.sealingType,i.type=e.details.childParentSealing?h.CHILD_TO_PARENTS_SEALING:h.WIFE_TO_HUSBAND_SEALING,i.isLicensedMarriage=e.details.sealingType===h.LICENSED,i.id=i.type===h.WIFE_TO_HUSBAND_SEALING?e.sloqSealingSpouseId:e.sloqSealingChildrenId,i.wifeOrMother=e.patronList.find(function(e){return"WIFE"===e.patronType}),i.husbandOrFather=e.patronList.find(function(e){return"HUSBAND"===e.patronType}),i.type!==h.WIFE_TO_HUSBAND_SEALING&&(i.children=e.patronList.filter(function(e){return"CHILD"===e.patronType}),i.observers=e.patronList.filter(function(e){return"CHILD_OBSERVER"===e.patronType}),i.sealingType=h.PARENTS_SEALED,(t=i.patronList).push.apply(t,_toConsumableArray(i.children)),(n=i.patronList).push.apply(n,_toConsumableArray(i.observers))),i.wifeOrMother&&i.patronList.push(i.wifeOrMother),i.husbandOrFather&&i.patronList.push(i.husbandOrFather),o=i,a.parsedLivingSealings.some(function(e){return e.id===i.id})||a.parsedLivingSealings.push(i)},a.updateSealingsWithAppointmentData=function(e){r=e,0<a.parsedLivingSealings.length&&0<e.length?a.parsedLivingSealings.forEach(function(t){var e=r.find(function(e){return e.sloqSealingSpouseId&&e.sloqSealingSpouseId===t.id||e.sloqSealingChildrenId&&e.sloqSealingChildrenId===t.id});e?(t.alreadyScheduled=!0,t.scheduledAppointment=e):(t.alreadyScheduled=!1,t.scheduledAppointment=null)}):0<a.parsedLivingSealings.length&&a.parsedLivingSealings.forEach(function(e){e.alreadyScheduled=!1,e.scheduledAppointment=null})},a.hasLicensedMarriageSealing=function(){return 1===a.parsedLivingSealings.length&&a.parsedLivingSealings.some(function(e){return e.isLicensedMarriage})},a.isSelectedSealingLicensedMarriage=function(){return o.isLicensedMarriage||!1},a.changeSelectedSealing=function(t,e){if("FIRST"===t)o=a.parsedLivingSealings[0];else if(t&&1===a.parsedLivingSealings.length)a.parsedLivingSealings=[t],o=a.parsedLivingSealings[0];else if(t&&1<a.parsedLivingSealings.length){var n=a.parsedLivingSealings.findIndex(function(e){return t.id===e.id});n&&(a.parsedLivingSealings[n]=t),o=t,a.parsedLivingSealings.forEach(function(e){e.id!==t.id&&(e.addChildren=!1)})}else o=null;o&&o.alreadyScheduled&&o.scheduledAppointment&&a.editSealingAppointment(e)},a.getHusbandOrFathersName=function(e){return e&&e.husbandOrFather&&e.husbandOrFather.confidential&&e.husbandOrFather.confidential.person?e.husbandOrFather.confidential.person.name:e&&e.husbandOrFather&&angular.isArray(e.husbandOrFather.patronNames)&&f.getName(e.husbandOrFather,"PREFERRED")||""},a.getWifeOrMothersName=function(e){return e&&e.wifeOrMother&&e.wifeOrMother.confidential&&e.wifeOrMother.confidential.person?e.wifeOrMother.confidential.person.name:e&&e.wifeOrMother&&angular.isArray(e.wifeOrMother.patronNames)&&f.getName(e.wifeOrMother,"PREFERRED")||""},a.getSelectedSealingId=function(){return!!o&&o.id},a.getSelectedSealing=function(){return o},a.getChildren=function(e){var t=[];return!e&&o?o.children&&0<o.children.length?t=o.children.map(function(e){return e.confidential&&e.confidential.person?e.confidential.person:e}):o.addChildren&&o.optionalChildren&&0<o.optionalChildren.length&&(t=o.optionalChildren.map(function(e){return e.confidential&&e.confidential.person?e.confidential.person:e})):e&&(e.children&&0<e.children.length?t=e.children.map(function(e){return e.confidential&&e.confidential.person?e.confidential.person:e}):e.addChildren&&e.optionalChildren&&0<e.optionalChildren.length&&(t=e.optionalChildren.map(function(e){return e.confidential&&e.confidential.person?e.confidential.person:e}))),t},a.getObservers=function(e){var t=[];return!e&&o?o.observers&&0<o.observers.length?t=o.observers.map(function(e){return e.confidential&&e.confidential.person?e.confidential.person:e}):o.addChildren&&o.optionalObservers&&0<o.optionalObservers.length&&(t=o.optionalObservers.map(function(e){return e.confidential&&e.confidential.person?e.confidential.person:e})):e&&(e.observers&&0<e.observers.length?t=e.observers.map(function(e){return e.confidential&&e.confidential.person?e.confidential.person:e}):e.addChildren&&e.optionalObservers&&0<e.optionalObservers.length&&(t=e.optionalObservers.map(function(e){return e.confidential&&e.confidential.person?e.confidential.person:e}))),t},a.getChildName=function(e){if(e&&e.name&&""!==e.name)return e.name;if(e&&angular.isArray(e.patronNames)){var t=f.getName(e,"PREFERRED"),n=f.getName(e,"NAME1"),i=f.getName(e,"NAME2"),o=f.getName(e,"LATIN");return t||n||i||o||""}},a.getOrdinanceId=function(){return o?o.id:null},a.isChildToParentSealing=function(e){return e?e.type===h.CHILD_TO_PARENTS_SEALING||e.addChildren||!1:!!o&&(o.type===h.CHILD_TO_PARENTS_SEALING||o.addChildren)},a.getEarliestScheduleDate=function(){return o?o.earliestScheduleDate:null},a.getPatronRole=function(t,e){var n="";if(e){var i=e.patronList.find(function(e){return e.confidential&&e.confidential.person&&(t===e.confidential.person.mrn||m.mrnsAreEqual(e.confidential.person.mrn,t))});n=i?i.role:""}return n};var s=function(e){var t="";switch(e){case"FATHER":t="HUSBAND";break;case"MOTHER":t="WIFE";break;case"CHILD_OBSERVER":t="CHILD";break;default:t=e}return t};a.getAllSealings=function(){return a.parsedLivingSealings},a.syncPatronInfo=function(e,t){var n=e.confidential.person.mrn.replace("-","00");n=n.replaceAll("-",""),t.gender=e.confidential.person.gender,t.email=e.confidential.person.email,t.personalPhone=e.confidential.person.phone,t.housePhone=e.confidential.person.householdPhone,t.address=e.confidential.person.address.formatted1,t.address2=e.confidential.person.address.formatted2,t.address3=e.confidential.person.address.formatted3,t.memberInfo.mrn=n,t.primaryContact=t.primaryContact||!1,t.sloqOrdPersonId=e.id,t.childType="CHILD_OBSERVER"===e.role?"OBSERVER":"CHILD"===e.role?"THIS_TEMPLE":null,t.role=e.role,t.patronType=s(e.role),e.confidential.person.unit&&(t.memberInfo.unitNumber=e.confidential.person.unit.unitNumber,t.memberInfo.wardName=e.confidential.person.unit.name,t.memberInfo.wardNameLocal=e.confidential.person.localizedName,e.confidential.person.unit.parentUnit&&(t.memberInfo.stakeName=e.confidential.person.unit.parentUnit.name,t.memberInfo.stakeNameLocal=e.confidential.person.unit.parentUnit.localizedName))},a.getSloqPatronInfo=function(e){var n=e.patronList[0];if(0<o.patronList.length){var t,i=o.patronList.map(function(e){var t=m.mrnsAreEqual(e.confidential.person.mrn,n.memberInfo.mrn)?n:d.create(e.role,e.confidential.person.gender,"STANDARD");return a.syncPatronInfo(e,t),t});return"schedule.edit"===g.current.name?(t=e.patronList).push.apply(t,_toConsumableArray(i.filter(function(t){return!e.patronList.some(function(e){return t.memberInfo.mrn===e.memberInfo.mrn})}))):e.patronList=i,e}return e},a.prepareLivingSealingForSave=function(e){if("schedule.edit"===g.current.name||g.params.isCombineSealing)e.details.type=e.details.type||"sealing",e.details.veilCeremonyType=e.details.veilCeremonyType||"NONE",e.details.sealerName=e.details.sealerName||"",e.details.sealerMrn=e.details.sealerMrn||"";else{if("schedule.guest"===g.current.name||!e.userIsScheduler)return e.details.type="sealing",e;e.details.type="sealing",e.details.veilCeremonyType="NONE",e.details.sealerName="",e.details.sealerMrn=""}return e.sealingRoomId&&(e.details.locationId&&e.details.locationId!==e.sealingRoomId||!e.details.locationId)&&(e.details.locationId=e.sealingRoomId),e.livingSealingSeatCount&&(e.details.locationSeats&&e.details.locationSeats!==e.livingSealingSeatCount||!e.details.locationSeats)&&(e.details.locationSeats=e.livingSealingSeatCount),e.guestList&&0<e.guestList.length&&(!e.details.guestCount||e.details.guestCount<e.guestList.length)&&(e.details.guestCount=e.guestList.length),"schedule.edit"===g.current.name||o&&(o.sealingType&&(e.details.sealingType=""===o.sealingType?"NONE":o.sealingType,e.inclSpouse=o.type===h.WIFE_TO_HUSBAND_SEALING,e.details.childParentSealing=a.isChildToParentSealing(),e.details.childParentSealing&&!o.addChildren?e.sloqSealingChildrenId=o.id:e.sloqSealingSpouseId=o.id,o.addChildren&&(e.sloqSealingChildrenId=o.childrenSealingId,t=[].concat(_toConsumableArray(o.optionalChildren),_toConsumableArray(o.optionalObservers)),o&&o.patronList&&t&&t.forEach(function(t){t.confidential&&t.confidential.person&&t.confidential.person.mrn&&o.patronList.findIndex(function(e){return e.confidential&&e.confidential.person&&m.mrnsAreEqual(e.confidential.person.mrn,t.confidential.person.mrn)})<0&&o.patronList.push(t)}))),e.patronList&&0<e.patronList.length&&e.patronList.forEach(function(t){if(t.memberInfo&&t.memberInfo.mrn){var e=o.patronList.find(function(e){return e.confidential&&e.confidential.person&&e.confidential.person.mrn&&m.mrnsAreEqual(e.confidential.person.mrn,t.memberInfo.mrn)});e&&(t.patronType=s(e.role),t.role=e.role)}}),a.getSloqPatronInfo(e)),e;var t};var n=function(e){return!(e&&e.confidential&&e.confidential.person&&e.confidential.person.mrn)};a.hasInvalidSloqPatrons=function(e){return!(!e&&1!==a.parsedLivingSealings.length)&&(e=e||a.parsedLivingSealings[0])&&(n(e.husbandOrFather)||n(e.wifeOrMother)||0<e.children.length&&e.children.some(function(e){return n(e)}))},a.addChildrenToSelectedSealing=function(e,t){e&&e.type===h.WIFE_TO_HUSBAND_SEALING?(e.addChildren=!0,g.params.skipToFinalStep=!0,a.changeSelectedSealing(e,t)):o&&o.type===h.WIFE_TO_HUSBAND_SEALING&&(o.addChildren=!0,a.changeSelectedSealing(o))},a.setSelectedSealingAsHTWAndAddChildren=function(t,e){if(t&&t.type===h.CHILD_TO_PARENTS_SEALING){var n=a.parsedLivingSealings.find(function(e){return e.id===t.htwSealingId});n&&(n.alreadyScheduled=!0,n.scheduledAppointment=t.scheduledAppointment,n.scheduledAppointment.details.sealingType=n.sealingType,n.scheduledAppointment.sloqSealingSpouseId=n.id,n.addChildren=!0,g.params.skipToFinalStep=!0,a.changeSelectedSealing(n,e))}if(o&&o.type===h.CHILD_TO_PARENTS_SEALING){var i=a.parsedLivingSealings.find(function(e){return e.id===o.htwSealingId});i&&(i.addChildren=!0,a.changeSelectedSealing(i))}}}}]),angular.module("tos-ui").factory("tosMessagingService",["$http","httpService","$log","$q",function(i,o,a,r){return new function(){this.lookupPhoneNumber=function(e){if(!e){var t="No phone number to validate";return a.warn(t),r.resolve({valid:!1,error:t})}var n=e.replaceAll(/\s/g,"");return o.getResponseData(i.get("/api/messaging/lookup/"+n))}}}]),angular.module("tos-ui").factory("tosModalService",["screenSizeService","$window","$state","tosPlatformService","tosScrollService",function(o,a,r,l,s){return{handleModalRender:function(e,i){e.rendered.then(function(){var e,t=a.document.querySelector("[uib-modal-transclude]"),n=a.document.querySelector("[uib-modal-window]");e=t&&n?t.offsetHeight>n.offsetHeight?t.offsetHeight:n.offsetHeight:t?t.offsetHeight:n.offsetHeight,t&&(e+=50,i&&(e+=i),o.communicateHeightChange(e)),function(){if(l.isChromeInIos())s.scrollToTop();else{var e=a.document.querySelector(".modal-dialog"),t="landing"===r.current.name?0:s.getParentWindowScrollY();e.style.top=t+"px"}}()})}}}]),angular.module("tos-ui").factory("tosPlatformService",function(){return{isAndroid:function(){return-1<navigator.userAgent.toLowerCase().indexOf("android")},isiOS:function(){var e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),t=!!navigator.platform&&/MacIntel/.test(navigator.platform)&&1<navigator.maxTouchPoints;return e||t},isChromeInIos:function(){return navigator.userAgent.match("CriOS")},isSafari:function(){return navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&-1===navigator.userAgent.indexOf("CriOS")&&-1===navigator.userAgent.indexOf("FxiOS")}}}),angular.module("tos-ui").constant("Gender",{MALE:"MALE",FEMALE:"FEMALE"}).constant("AppointmentType",{UNKNOWN:"UNKNOWN",LIVING_ENDOWMENT:"LIVING_ENDOWMENT",LIVING_SEALING:"LIVING_SEALING",PROXY_BAPTISM:"PROXY_BAPTISM",PROXY_INITIATORY:"PROXY_INITIATORY",PROXY_ENDOWMENT:"PROXY_ENDOWMENT",PROXY_SEALING:"PROXY_SEALING"}).constant("SealingType",{WIFE_TO_HUSBAND_SEALING:"WIFE_TO_HUSBAND_SEALING",CHILD_TO_PARENTS_SEALING:"CHILD_TO_PARENTS_SEALING",LICENSED:"LICENSED",SEAL_AFTER_CIVIL:"SEAL_AFTER_CIVIL",SEAL_TO_DECEASED:"SEAL_TO_DECEASED",PARENTS_SEALED:"PARENTS_SEALED"}).constant("SloqQualificationStatus",{UNKNOWN:"UNKNOWN",PATRON_READY:"PATRON_READY",PATRON_NOT_READY:"PATRON_NOT_READY",UNIT_NOT_ENABLED:"UNIT_NOT_ENABLED",PATRON_NOT_STARTED:"PATRON_NOT_STARTED"}).constant("AppointmentSource",{UNKNOWN:void 0,TSP:"TSP",WEB:"WEB",LDSTOOLS:"LDSTOOLS"}).constant("TspValidationException",{APPOINTMENT_NO_LONGER_EXISTS:"APPOINTMENT_NO_LONGER_EXISTS",PAST_APPOINTMENT:"PAST_APPOINTMENT",APPOINTMENT_TIME_NOT_ENOUGH_SEATS:"APPOINTMENT_TIME_NOT_ENOUGH_SEATS",IS_NULL:"IS_NULL",MAX_APPOINTMENTS_SCHEDULED:"MAX_APPOINTMENTS_SCHEDULED",ONLINE_ORDINANCE_NOT_ENABLED:"ONLINE_ORDINANCE_NOT_ENABLED",SPOUSE_CONFLICTING_APPOINTMENT:"SPOUSE_CONFLICTING_APPOINTMENT",SPOUSE_AND_PATRON_CONFLICTING_APPOINTMENT:"SPOUSE_AND_PATRON_CONFLICTING_APPOINTMENT"}).filter("localizeDateTime",["$locale","screenSizeService","$cacheFactory","$log",function(l,s,e,p){var c=e("localizeDate"),d={},u={};d.default="default",u[d.default]={},u[d.default][s.desktopId]={hour:"numeric",minute:"2-digit",weekday:"long",day:"2-digit",month:"long",year:"numeric"},u[d.default][s.mobileId]={hour:"numeric",minute:"2-digit",weekday:"short",day:"2-digit",month:"short",year:"numeric"},d.date="date",u[d.date]={weekday:"long",day:"numeric",month:"long",year:"numeric"},d.dateShort="dateShort",u[d.dateShort]={day:"numeric",month:"short",year:"numeric"},d.weekday="weekday",u[d.weekday]={weekday:"long"},d.time="time",u[d.time]={hour:"numeric",minute:"2-digit"},d.monthLongYear="monthLongYear",u[d.monthLongYear]={month:"long",year:"numeric"};var t=function(e,t){var n,i,o=new Date(e);if(isNaN(o.getDate()))return e;t||(t=d.default);var a=l.id+":"+t+":"+o.getHours()+":"+o.getMinutes()+":"+o.getMonth()+"/"+o.getDate()+"/"+o.getFullYear();if(!c.get(a)){(i=(n=t?u[t]?u[t]:(p.error("invalid date time formatName: "+t),u[d.default]):u[d.default])[s.desktopId]||n[s.mobileId]?n[s.currentViewId]||n[s.desktopId]||n[s.mobileId]:n).calendar="gregory";var r=o.toLocaleString(l.id,i);c.put(a,r)}return c.get(a)};return t.formatNames=d,t.$stateful=!0,t}]).filter("tosTempleSearch",["tosTempleNameFilter",function(o){return function(e,n){if(!e||e.length<1)return[];var i=[];return e.forEach(function(e){if(e&&e.templeOrgId&&angular.isNumber(e.templeOrgId)){var t=o(e.templeOrgId);t&&angular.isString(t)&&0!==t.trim().length&&(!(n&&angular.isString(n)&&0<n.trim().length)||-1!==t.toLowerCase().indexOf(n.toLowerCase()))&&i.push(e)}}),i}}]).filter("tosAppointmentTypeGuest",["tisfTranslateService","appointmentTypeService","AppointmentType",function(n,i,o){return function(e){if(!e||!angular.isString(e))return"";if(!i.isValidAppointmentType(e))return"";var t=e;if(o.LIVING_ENDOWMENT===e)t=o.PROXY_ENDOWMENT;else if(o.LIVING_SEALING===e)return n.get("appointmentType.LIVING_SEALING_GUEST");return n.get("appointmentType."+t)}}]).filter("tosAppointmentType",["tisfTranslateService","appointmentTypeService",function(t,n){return function(e){return e&&angular.isString(e)&&n.isValidAppointmentType(e)?t.get("appointmentType."+e):""}}]).filter("tosTempleName",["tisfTranslateService",function(n){return function(e){if(!e||!angular.isNumber(e))return"";var t=n.get("temple.name."+e);return t&&-1===t.indexOf("{")?t:""}}]).filter("livingOrdinancesMessage",["tisfTranslateService","tosTempleNameFilter",function(n,i){return function(e){if(!e)return"";var t=i(e);return t?n.get("ordinanceSelector.livingOrdinanceMessage",t):""}}]).filter("tosSessionTimeAndSchedulingType",["tisfTranslateService","AppointmentType","$log","localizeDateTimeFilter","appointmentService","tosDateService","tosTempleInfoService",function(H,U,V,W,B,q,z){var Y="schedule-type",j=function(e,t){return'<span class="'+(t||"")+'">'+e+"</span>"},X=function(e,t){var n=e.language||null,i=e.details&&e.details.languageAssistanceId||null,o="";e.details&&e.details.needsLanguageAssistance&&10===i&&(o+=j(H.get("sessionType.includesASL"),"text5 seats-available-message"));var a=U.LIVING_SEALING===e.appointmentType&&e.ordinanceRoom&&e.ordinanceRoom.name,r=n?t[n]:null;if(!r&&0!==r)return a?H.get("sessionType.livingSealing",e.ordinanceRoom.name):H.get("sessionType.regular")+o;var l=([U.LIVING_ENDOWMENT,U.PROXY_ENDOWMENT].includes(e.appointmentType)?z.getCachedEndowmentAvLanguages():z.getCachedOrdinanceCardsLanguages()).find(function(e){return e.value===n});return(a?H.get("sessionType.livingSealing.differentLanguage",[e.ordinanceRoom.name,l.label]):H.get("sessionType.differentLanguage",l.label))+o};return function(e,t,n,i,o,a,r,l,s,p,c,d,u){if(!e)return V.error("The session must be present"),null;var m,g,f=q.getDateWithCorrectTime(e.sessionTime,new Date(e.time)),h=W(f,W.formatNames.time),S=j(h,"schedule-item-text"),T=(m=h,(g=q.getTimePartsFromTimeString(m))&&g.hour&&g.hour<10?"      ":"    "),v=W(new Date(new Date(q.getSlcDateTime(e.arrivalDateTime)).getTime()),W.formatNames.time);if("NO_APPOINTMENTS_NEEDED"===e.scheduleSubType)return function(e,t,n,i){var o=W(i,W.formatNames.time),a=H.get("selectAppointmentTime.walkInsOnly");if(e.sessionEndTime){var r=q.getDateWithCorrectTime(e.sessionEndTime,new Date(e.endTime)),l=W(r,W.formatNames.time);if(l&&o!==l)return o+" - "+l+n+a}return j(o)+n+j(a,Y)}(e,0,T,f);var y,b,A,I,C,O,E,$,L,N,M,D,w,P,G,k,_=(y=e,b=t,A=n,I=i,C=o,O=a,E=!0,$=r,L=l,N=s,M=p,D=d,w=u,P=B.getSessionSeatInfo(y,y.appointmentType,A,I,C,O,E,$,L,N,M,w),G=U.PROXY_INITIATORY===y.appointmentType?!(P.maleAvailable||P.femaleAvailable):!P.available,k=!P.valid,D||G?H.get("selectAppointmentTime.timeFull"):k?X(y,b).concat(" ",H.get("selectAppointmentTime.notEnoughSeats")):y.appointmentType!==U.PROXY_BAPTISM||"FAMILY_PRIORITY_TIME"!==y.scheduleGroupType&&"CHURCH_GROUPS"!==y.scheduleGroupType?X(y,b):H.get("scheduleGroupType_"+y.scheduleGroupType));if(function(e){if(e&&e.details&&e.appointmentType&&B.isProxyOrdinance(e.appointmentType)&&z.isGvsgEnabled())if(U.PROXY_INITIATORY===e.appointmentType){(e.details.maleCapacity||e.details.femaleCapacity)&&(e.details.adjustedMaleCapacity||e.details.adjustedFemaleCapacity)||H.get("scheduleAppointment.walkIns.accommodated");var t=e.details.maleCapacity-e.details.adjustedMaleCapacity,n=e.details.femaleCapacity-e.details.adjustedFemaleCapacity;t+n<1?H.get("scheduleAppointment.walkIns.accommodated"):H.get("scheduleAppointment.walkIns.gender.seats",[t,n])}else{var i,o;if(e.details.capacity?(i=e.details.capacity,o=e.details.adjustedCapacity):e.details.maleCapacity?(i=e.details.maleCapacity,o=e.details.adjustedMaleCapacity):e.details.femaleCapacity&&(i=e.details.femaleCapacity,o=e.details.adjustedFemaleCapacity),i&&o){var a=i-o;a<1?H.get("scheduleAppointment.walkIns.accommodated"):1===a?H.get("scheduleAppointment.walkIns.one.seat",a):H.get("scheduleAppointment.walkIns.multiple.seats",a)}else H.get("scheduleAppointment.walkIns.accommodated")}}(e),_){var x=H.get("finalizeAppointment.arrive.by",v),F=j('<span style="display: block;" ng-if="session.arrivalDateTime">'+x+"</span>","text5 session-arrival"),R=c?j(c,"text5 seats-available-message"):"";return j(S+F,"session-time")+T+j(_+j(R),Y)}return S}}]).filter("tosNoSessionsAvailable",["tisfTranslateService","AppointmentType",function(n,i){return function(e){return e?(e===i.PROXY_ENDOWMENT?t=n.get("appointmentType.endowment"):e===i.PROXY_BAPTISM?t=n.get("appointmentType.baptism"):e===i.PROXY_SEALING||e===i.LIVING_SEALING?t=n.get("appointmentType.sealing"):e===i.PROXY_INITIATORY&&(t=n.get("appointmentType.initiatory")),t?n.get("selectAppointmentTime.noTimesAvailable",t):n.get("selectAppointmentTime.genericNoTimesAvailable")):"";var t}}]).filter("tosCurrentScheduledTime",["tisfTranslateService","localizeDateTimeFilter","tosDateService",function(a,r,l){return function(e){var t=e&&e[0],n=e&&e[1];if(!t||!n)return"";var i=l.getDateWithCorrectTime(t.originalAppointmentTime,new Date(t.originalAppointmentDateTime)),o=r(i,r.formatNames.time);return a.get("selectAppointmentTime.scheduledTime",o)}}]).filter("orderTemplesByName",["tisfTranslateService",function(o){return function(e){return e.sort(function(e,t){if(!e||!e.templeOrgId)return t&&t.templeOrgId?1:0;if(!t||!t.templeOrgId)return-1;if(e.templeOrgId===t.templeOrgId)return 0;var n=o.get("temple.name."+e.templeOrgId),i=o.get("temple.name."+t.templeOrgId);return n===i?0:i<n?1:-1}),e}}]).filter("tosSeatsAvailable",["tisfTranslateService",function(n){return function(e){var t=0<e?e:0;return 1===t?n.get("selectAppointmentTime.oneSeatAvailable"):n.get("selectAppointmentTime.numberOfSeatsAvailable",t)}}]).filter("tosOnlineSchedulingStatus",["tisfTranslateService",function(n){return function(e){var t=e?"selectATemple.onlineSchedulingAvailable":"selectATemple.noOnlineSchedulingStatus";return n.get(t)}}]).filter("tosCountMessage",["tisfTranslateService",function(n){return function(e,t){return n.get(e,t||0)}}]).filter("tosAppointmentTime",["localizeDateTimeFilter","tosDateService",function(n,i){return function(e){if(!e.appointmentTime||!e.appointmentDateTime)return"";var t=i.getDateWithCorrectTime(e.appointmentTime,new Date(e.appointmentDateTime));return t?n(t,n.formatNames.time):""}}]).filter("tosAppointmentTimeSpan",["localizeDateTimeFilter",function(t){return function(e){return e?t(e,t.formatNames.time):""}}]),angular.module("tos-ui").factory("tosScrollService",["$window",function(n){return new function(){var t,e=this;n.addEventListener("message",function(e){t=e.data.scrollY}),e.getParentWindowScrollY=function(){return t||0},e.postMessageToParentWindow=function(e){n.parent.postMessage(e,"*")},e.scrollToTop=function(){e.postMessageToParentWindow({scrollToTop:!0})},e.scrollToElement=function(e){var t=n.document.getElementById(e);t&&t.scrollIntoView(!0)}}}]),angular.module("tos-ui").factory("tosSmsSubscriptionService",["httpService","$http",function(i,o){return new function(){this.getSmsSubscriptionPreferences=function(e,t){var n={patronPhoneNumber:e,templePhoneNumber:t};return i.getResponseData(o.post("/api/sms/subscription",n))},this.saveNewSmsSubscription=function(e,t){var n={patronPhoneNumber:e,templePhoneNumber:t,isSubscribed:!0};return i.getResponseData(o.post("/api/sms/subscription/save",n))}}}]),angular.module("tos-ui").factory("tosTempleConfigService",["$http","httpService","$q","$log","$cacheFactory",function(o,a,r,l,e){var s=e("templeConfig");return{getOrdinanceConfig:function(e,t){if(!e||!t)return l.warn("getOrdinanceConfig:Invalid params, temple org id: "+e+" appointment type: "+t),void r.resolve();var n="ordinanceConfig-"+e+"-"+t;if(s.get(n))return s.get(n);var i=o.get("/api/templeConfig/ordinanceConfig/"+e+"/"+t);return s.put(n,a.getResponseData(i)),s.get(n)},getProxyBaptismConfig:function(e){if(!e)return l.error("getProxyBaptismConfig: You must specify a temple"),r.resolve(null);var t="proxyBaptismConfig-"+e;if(s.get(t))return s.get(t);var n=o.get("/api/templeConfig/getProxyBaptismConfig/"+e);return s.put(t,a.getResponseData(n)),s.get(t)},getAllOnlineSchedulingStatuses:function(){var e="onlineSchedulingStatuses";if(s.get(e))return s.get(e);var t=o.get("/api/templeConfig/findAllOnlineSchedulingStatuses");return s.put(e,a.getResponseData(t)),s.get(e)},getAppointmentTypeOnlineSchedulingStatus:function(e){if(!e)return l.error("getAppointmentTypeOnlineSchedulingStatus: You must specify a temple"),r.resolve(null);var t="appointmentTypeOnlineSchedulingStatus-"+e;if(s.get(t))return s.get(t);var n=o.get("/api/templeConfig/findAppointmentTypeOnlineSchedulingStatus/"+e);return s.put(t,a.getResponseData(n)),s.get(t)},templeHasOnlineScheduling:function(e){return a.getResponseData(o.get("/api/templeConfig/templeHasOnlineScheduling/"+e))}}}]),angular.module("tos-ui").factory("tosTempleInfoService",["$http","$log","$cacheFactory","screenSizeService","$q","httpService",function(i,o,e,a,r,l){var t,n,s=e("templeInfoCache"),p=!1,c=function(){var e="endowmentAvLanguages";return s.get(e)||s.put(e,l.getResponseData(i.get("/api/templeInfo/endowmentAvLanguages").then(function(e){return t=e.data,e}))),s.get(e)},d=function(){var e="ordinanceCardsLanguages";return s.get(e)||s.put(e,l.getResponseData(i.get("/api/templeInfo/ordinanceCardsLanguages").then(function(e){return n=e.data,e}))),s.get(e)},u=function(e,t){var n=e;for(var i in n)if(n[i].value===t){t=n[i].label;break}return t};return{getTempleInfo:function(){var e="templeContactInfo";if(!(0<arguments.length&&void 0!==arguments[0]&&arguments[0])&&s.get(e))return s.get(e);var t=l.getResponseData(i.get("/api/templeInfo")).then(function(e){return p=e.gvsgEnabled,e});return s.put(e,t),s.get(e)},selectATemple:function(e){return l.getResponseData(i.post("/api/templeInfo/setTemple",JSON.stringify({orgId:e})))},getTempleTitanImageUrl:function(e){var t="templeTitanImage:"+e;if(s.get(t))return s.get(t);var n=l.getResponseData(i.get("/api/templeInfo/getTempleTitanImage/"+e)).then(function(e){return e.url});return s.put(t,n),a.isMobileView?"":s.get(t)},getTempleContacts:function(t){if(!t)return r.resolve();var n="templeContacts:"+t;if(s.get(n))return s.get(n);var e=l.getResponseData(i.get("/api/templeInfo/contacts/"+t)).then(function(e){return{phoneNumber:e.phoneNumber,officeEmail:e.officeEmail}}).catch(function(e){return s.get(n)&&s.remove(n),o.error("Unable to get contacts for templeOrgId "+t,e),null});return s.put(n,e),s.get(n)},getEndowmentAvLanguages:c,getCachedEndowmentAvLanguages:function(){return t||[]},getOrdinanceCardsLanguages:d,getCachedOrdinanceCardsLanguages:function(){return n||[]},getTempleServices:function(e){if(!e)return r.resolve({});var t="templeServices:"+e;return s.get(t)||s.put(t,l.getResponseData(i.get("/api/templeInfo/templeServices/"+e))),s.get(t)},getTempleContactInfo:function(e){if(!e){var t="templeOrgId is required";return o.warn(t),r.reject(t)}var n="templeContactInfo-"+e;return s.get(n)||s.put(n,l.getResponseData(i.get("/api/templeInfo/templeContact/"+e))),s.get(n)},getCurrentTimeOfTempleByTempleOrgId:function(e){return l.getResponseData(i.get("api/templeInfo/currentTempleTime/"+e))},getCurrentTempleTime:function(){return l.getResponseData(i.get("/api/templeInfo/currentTempleTime"))},getLanguageAssistanceName:function(e,t){return"PROXY_ENDOWMENT"===e||"LIVING_ENDOWMENT"===e?c().then(function(e){return u(e,t)}):d().then(function(e){return u(e,t)})},getOnlineOrdinances:function(e){return l.getResponseData(i.get("api/templeConfig/activeOnline/appointmentTypes/"+e))},getPatronHousing:function(){return l.getResponseData(i.get("api/templeInfo/patronHousingInfo"))},isGvsgEnabled:function(){return p},isTosGvsgEnabled:function(){var e="gvsgEnabled",t=l.getResponseData(i.get("/api/templeInfo/isGvsgEnabled")).then(function(e){return e});return s.put(e,t),s.get(e)},getTempleMessagingInfoByOrgId:function(e){return l.getResponseData(i.get("/api/templeInfo/messagingInfo/"+e))}}}]),angular.module("tos-ui").factory("tosTempleScheduleService",["$http","$q","httpService","$filter","appointmentTypeService","$httpParamSerializer","$log","tosUserInfoService","$state","AppointmentType",function(m,g,f,e,h,o,S,t,a,r){return{getTempleScheduleForMonth:function(o,a,r,l,s,p,c,d,u){return t.getUserInfo().then(function(e){var t=new Date(o);if(isNaN(t.getDate())||!a||!h.isValidAppointmentType(r)){var n="Invalid params, sessionDate: "+o+" templeOrgId: "+a+" appointmentType: "+r;return S.error(n),g.reject(n)}var i=m.post("/api/templeSchedule/getTempleMonthlySchedule",{sessionDate:t,month:t.getMonth(),year:t.getFullYear(),templeOrgId:a,appointmentType:r,gender:e?e.gender:null,inclSelf:l,addSpouse:s,apptMales:p,apptFemales:c,apptNeutralGuests:d,isGroupAppt:u});return f.getResponseData(i)})},getSessionList:function(e,t,n){var i=new Date(e);if(!isNaN(i.getDate())&&t&&n)return t!==r.LIVING_SEALING?f.getResponseData(m.post("/api/templeSchedule/getSessionInfo",{sessionYear:i.getFullYear(),sessionMonth:i.getMonth(),sessionDay:i.getDate(),appointmentType:t,templeOrgId:n,isGuestConfirmation:"schedule.guest"===a.current.name})).then(function(e){return e&&e.sessionList&&e.sessionList.forEach(function(e){e&&e.time&&angular.isString(e.time)&&(e.time=new Date(e.time))}),e}):f.getResponseData(m.post("/api/templeSchedule/getLivingSealingSessionInfo",{sessionYear:i.getFullYear(),sessionMonth:i.getMonth(),sessionDay:i.getDate(),appointmentType:t,templeOrgId:n,isGuestConfirmation:"schedule.guest"===a.current.name})).then(function(e){return e&&e.sessionList&&e.sessionList.forEach(function(e){e.livingSealingIsFull=e.details.sealingAppointments&&0<e.details.sealingAppointments.length,e.ordinanceRoom&&(e.sealingRoomId=e.ordinanceRoom.id,e.sealingRoomSeats=e.ordinanceRoom.seats),e&&e.time&&angular.isString(e.time)&&(e.time=new Date(e.time))}),0<e.sessionList.length&&e.sessionList.sort(function(e,t){return Number(e.time)-Number(t.time)}),e});var o="Invalid params, sessionDate: "+e+" appointmentType: "+t+" temple org id: "+n;return S.error(o),g.reject(o)},getSession:function(e,t,n){var i=o({appointmentType:e,appointmentTimeId:t,templeOrgId:n,isGuestConfirmation:"schedule.guest"===a.current.name});return f.getResponseData(m.get("/api/templeSchedule/sessions/searchSingleSession?"+i)).then(function(e){return e&&e.time&&angular.isString(e.time)&&(e.time=new Date(e.time)),e||null})}}}]),angular.module("tos-ui").factory("tosUrlService",["httpService","$http",function(i,o){return{getEditAppointmentUrl:function(e){return i.getResponseData(o.get("/api/url/editAppointmentUrl/"+e))},getAppointmentInvitationDetails:function(e){return i.getResponseData(o.post("/api/url/appointmentInvitationDetails",e))},getMailToLink:function(e){return i.getResponseData(o.post("/api/url/mailToLink",e))},getGuestAppointmentUrl:function(e){return i.getResponseData(o.get("/api/url/guestAppointmentUrl/"+e))},getShareAppointmentUrl:function(e,t,n){return i.getResponseData(o.get("/api/url/shareAppointmentUrl/"+e+"/"+t+"/"+n))},getFamilySearchUrl:function(e){return i.getResponseData(o.post("/api/url/familysearch/"+e))}}}]),angular.module("tos-ui").factory("tosUserInfoService",["$http","httpService","$cacheFactory",function(a,r,e){return new function(){var n=this,i=e("userInfo"),o=function(e,t,n){return i.get(e)||(n?i.put(e,r.getResponseData(a.post(t,n))):i.put(e,r.getResponseData(a.get(t)))),i.get(e)};n.getUserInfo=function(t){return o("userInfo","/api/userInfo").then(function(e){return t?n.getSloqData(e):e})},n.spouseHasEmail=function(){return o("spouseHasEmail","/api/userInfo/spouseHasEmail")},n.getUsersPreferredName=function(){return o("preferredName","/api/userInfo/preferredName")},n.getMyTempleOrgId=function(){return o("myTempleOrgId","/api/userInfo/myTempleOrgId")},n.getSloqData=function(e){return o("getSloqData","/api/userInfo/getSloqData",e)},n.getSpouseMrn=function(e){return n.getUserInfo(e).then(function(e){return e.spouseInfo?e.spouseInfo.mrn:""})},n.getIndexOfSpouseGuest=function(e,t){return e?n.getSpouseMrn(t).then(function(t){return e.findIndex(function(e){return e.guestMrn===t})}):Promise.resolve(-1)},n.getSelfMrn=function(){return n.getUserInfo().then(function(e){return e.mrn||""})},n.getIndexOfSelfGuest=function(e){return e?n.getSelfMrn().then(function(t){return e.findIndex(function(e){return e.guestMrn===t})}):Promise.resolve(-1)}}}]),angular.module("tos-ui").directive("tosRow",function(){return{restrict:"E",transclude:!0,templateUrl:"/app/modules/responsive/tos-row.html"}}),angular.module("tos-ui").controller("landingController",["appointmentScheduledModal","deleteAppointmentModal","appointmentNotAvailableModal","generalErrorModal","templeSelectorModal","$log","$stateParams","$location","AppointmentSource","tosCalendarService","appointmentService","$state","tosTempleInfoService","tosTempleConfigService","tosUrlService","tosUserInfoService","screenSizeService","$window","tosScrollService","tosDateService","AppointmentType","tisfTranslateService","patronHousingReservationModal","patronHousingExternalLinkModal","$scope","tosTempleScheduleService","removeGuestModal","appointmentTypeService","localizeDateTimeFilter","correspondenceService","emailSentModal","tosHoldService","livingAppointmentDeletedModal","sloqService","tosLivingSealingService","SealingType","snackbarService","initialTempleOrgId","$rootScope","tosAdobeAnalyticsService",function(e,t,n,i,o,a,r,l,s,p,d,c,u,m,g,f,h,S,T,v,y,b,A,I,C,O,E,$,L,N,M,D,w,P,G,k,_,x,F,R){var H=this;H.showSelectThisTemple=!0,H.showHighDemandMessage=!1,H.whatCanIScheduleSectionIsOpen=!1,H.existingAppointments=[],H.shareAppointmentUrlMap={},H.appointmentToHighlightId=r.appointmentToHighlightId,H.shouldShowAppointmentHighlight=!!H.appointmentToHighlightId,H.appointmentToRemoveGuestFromId=r.appointmentToRemoveGuestFromId,H.AppointmentType=y,H.showSpinner=!1,H.appointmentTypesAvailForPatron=[],H.ordinanceReadyCampaignIdUrlSuffix="cid=RE-00035143",D.clearHoldData(!0);var U,V=function(){if(H.existingAppointments&&angular.isArray(H.existingAppointments)){H.isDoneCheckingAppointments=!1;var e=[];H.existingAppointments.forEach(function(c){e.push(new Promise(function(p){u.getTempleContactInfo(c.templeOrgId).then(function(e){c.displayedAppointmentDate=v.getSlcDateTime(c.appointmentDateTime);var t=e.slcTimeDifference,n=v.getSlcDateTime(),i=new Date(c.displayedAppointmentDate);i.setHours(i.getHours()-t),c.shouldHide=i.getTime()<n.getTime();var o,a=b.get("temple.name."+c.templeOrgId),r=e.phones&&e.phones.find(function(e){return"Office"===e.phoneType}),l=r?r.phoneNumber:"";c.actionRequiredText=(o=c,H.isAGroupAppointmentGuest(o)?o.details.contactName?b.get("myAppointments.actionRequiredText.guest",o.details.contactName):b.get("myAppointments.actionRequiredText.guest.noContactName"):b.get("myAppointments.actionRequiredText"));var s=l.replace(/\D/g,"");c.notEditableText=b.get("myAppointments.notEditableText")+"<br><br>"+a+'<br><div class="text-info"><a href="tel:'+s+'">'+l+"</a></div>",c.opNotEditableText=b.get("myAppointments.opNotEditableText")+"<br><br><strong>"+b.get("myAppointments.opNotEditableText.scheduledBy")+"</strong><br>"+(c.details.contactName||""),H.appointmentToHighlightExists=H.appointmentToHighlightExists||c.id===H.appointmentToHighlightId,c&&c.appointmentDateTime&&angular.isString(c.appointmentDateTime)&&(c.appointmentDateTime=new Date(c.appointmentDateTime)),H.appointmentToRemoveGuestFromExists=H.appointmentToRemoveGuestFromExists||c.id===H.appointmentToRemoveGuestFromId,m.getAppointmentTypeOnlineSchedulingStatus(c.templeOrgId).then(function(e){c.appointmentType&&e.forEach(function(e){e.appointmentType===c.appointmentType&&(c.onlineSchedulingIsEnabledForOrdinance=e.onlineSchedulingAvailable)})}),c.patrons||(c.patrons=[]),c.details&&c.details.contactName?c.patrons.push(H.userPreferredName||c.details.contactName):H.contactInfo&&c.patrons.push(H.userPreferredName||H.contactInfo.name),d.isAGroupAppointment(c)&&c.details&&!c.details.groupName&&(c.details.contactName&&d.isProxyOrdinance(c.appointmentType)?c.details.groupName=c.details.contactName:d.isLivingEndowment(c.appointmentType)&&(c.details.groupName=c.patronNames[0])),p()})})),g.getFamilySearchUrl(c.appointmentType).then(function(e){c.familySearchHref=e.url,H.ordinanceReadyCampaignIdUrlSuffix&&(c.familySearchHref+=(c.familySearchHref.includes("?")?"&":"?")+H.ordinanceReadyCampaignIdUrlSuffix)})}),Promise.all(e).then(function(){C.$apply(function(){H.existingAppointments=H.existingAppointments.filter(function(e){return!e.shouldHide}),H.isDoneCheckingAppointments=!0,H.showAppointments=!0,H.appointmentToHighlightId&&!H.appointmentToHighlightExists&&n.open()})}).finally(function(){if(H.appointmentToRemoveGuestFromId&&!H.appointmentToRemoveGuestFromExists)n.open();else if(H.appointmentToRemoveGuestFromId&&H.appointmentToRemoveGuestFromExists){var e=H.existingAppointments.find(function(e){return e.id===H.appointmentToRemoveGuestFromId});d.removeGuestFromGroupAppointment(H.contactInfo,e,H.existingAppointments)}})}},W=function(){d.clearExistingAppointmentsCache(),d.getExistingAppointments().then(function(e){var t,n;G.updateSealingsWithAppointmentData(e),H.existingAppointments=e,V(),H.existingAppointments&&0!==H.existingAppointments.length&&H.existingAppointments.forEach(function(n){var e=d.getCorrectAppointmentType(n);m.getOrdinanceConfig(n.templeOrgId,e).then(function(e){var t=d.getArrivalTimeForAppointmentFromSlcDateTime(n,e);n.arrivalTime=L(t,"time")})}),H.showAppointments=!0,P.syncAppointmentData(),new ClipboardJS("[data-clipboard-text],[data-clipboard-target]"),r.delete&&(n=r.delete,angular.isString(n)&&(n=parseInt(n)),H.existingAppointments.forEach(function(e){e.appointmentId===n&&(t=e)}),t&&H.deleteAppointment(t))})},B=function(){if(H.contactInfo&&H.contactInfo.isSloqEnabled&&H.contactInfo.activeOrdinances){var e,t=_createForOfIteratorHelper(H.contactInfo.activeOrdinances);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("ENDOWMENT"===n.ordinance.ordinanceType&&n.ordinance.canScheduleOrdinance)return!0}}catch(e){t.e(e)}finally{t.f()}}return!1},q=(U=_asyncToGenerator(_regeneratorRuntime().mark(function e(n){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(t){var e=new Image;e.src=n||"",e.onload=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t(!0);case 1:case"end":return e.stop()}},e)})),e.onerror=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t(!1);case 1:case"end":return e.stop()}},e)}))}));case 1:case"end":return e.stop()}},e)})),function(e){return U.apply(this,arguments)}),z=function(){u.getTempleTitanImageUrl(H.templeInfo.templeOrgId).then(function(n){q(n).then(function(e){H.templeImageSrc=e?n:"tos-ui/resources/images/icons/temple-blue.svg";var t=S.document.getElementById("temple-img");H.templeImageSrc&&t&&(t.src=H.templeImageSrc)})})},Y=function(e){e&&(H.showSelectThisTemple=!0,H.templeInfo=e,H.selectedTemple=e,u.getTempleInfo(!0).then(function(e){H.showSelectThisTemple=e.canScheduleOrCanRequestScheduling,H.showHighDemandMessage=!!e.displayTosHeaderMsg}),h.isMobileView||z(),f.getMyTempleOrgId().then(function(e){H.yourTempleId=e.templeOrgId}),u.getOnlineOrdinances(e.templeOrgId).then(function(e){H.appointmentTypesAndAvailability=e,function(){if(H.appointmentTypesAndAvailability){var e,t=_createForOfIteratorHelper(H.appointmentTypesAndAvailability);try{for(t.s();!(e=t.n()).done;){var n=e.value;"LIVING_ENDOWMENT"===n&&!B()||H.appointmentTypesAvailForPatron.includes(n)||H.appointmentTypesAvailForPatron.push(n)}}catch(e){t.e(e)}finally{t.f()}}}()}),u.getPatronHousing().then(function(e){var t;(t=e)&&(H.templeHousingInfo=_objectSpread({},t),H.templeHousingInfo&&H.templeHousingInfo.patronHousingUrl&&!H.templeHousingInfo.patronHousingUrl.toLowerCase().includes("http")&&(H.templeHousingInfo.patronHousingUrl="https://".concat(H.templeHousingInfo.patronHousingUrl)),H.templeHousingInfo.patronHousingEmail&&(H.patronHousingEmail=b.get("yourTemple.housingReservationEmail",'<a class="no-text-decoration" href="mailto:'+H.templeHousingInfo.patronHousingEmail+'">'+H.templeHousingInfo.patronHousingEmail+"</a>")),H.templeHousingInfo.patronHousingPhone&&(H.patronHousingPhone=b.get("yourTemple.housingReservationPhone",'<a class="no-text-decoration" href="tel:'+H.templeHousingInfo.patronHousingPhone+'">'+H.templeHousingInfo.patronHousingPhone+"</a>")))}))};H.$onInit=function(){_.resetTransitionsInProgress(),C.$on("showSpinner",function(){return H.showSpinner=!H.showSpinner}),H.actionRequiredLabel=b.get("myAppointments.actionRequiredLabel"),H.notEditableLabel=b.get("myAppointments.notEditableLabel"),f.getUserInfo().then(function(e){e&&!H.contactInfo&&(H.contactInfo=_objectSpread({},e))}),g.getFamilySearchUrl("PROXY_SEALING").then(function(e){return H.familySearchHref=e.url}),r.templeOrgId?u.selectATemple(r.templeOrgId).then(function(e){H.setupTemple(e)}):C&&C.$resolve&&C.$resolve.initData&&C.$resolve.initData.templeOrgId?u.selectATemple(C.$resolve.initData.templeOrgId).then(function(e){H.setupTemple(e)}):x?u.selectATemple(x).then(function(e){H.setupTemple(e)}):u.getTempleInfo(!0).then(function(e){H.setupTemple(e)}),H.successfullyScheduledAppointment=r.successfullyScheduledAppointment,H.successfullyScheduledAppointment&&r.savedAppointment&&(e.open(r.savedAppointment),T.scrollToElement("top-of-landing-page")),f.getUsersPreferredName().then(function(e){H.userPreferredName=e.name}).finally(function(){W()}),angular.element(S).bind("resize",function(){h.isMobileView||H.templeImageSrc||z()}),R.trackPageView("TOS|Landing Page",null,"TOS Landing Page")},H.setupTemple=function(e){Y(e),H.showSelectThisTemple=e.canScheduleOrCanRequestScheduling},H.isLivingOrdinances=function(e){return d.isLivingOrdinance(e)},H.getAppointmentType=function(e){return e.appointmentType===y.LIVING_ENDOWMENT&&d.isAGroupAppointmentGuest(e)&&!d.isGroupAppointmentScheduler(e)?b.get("appointmentType."+y.PROXY_ENDOWMENT):e.appointmentType===y.LIVING_SEALING?b.get("appointmentType."+(e.details&&e.details.sealingType===k.PARENTS_SEALED?k.CHILD_TO_PARENTS_SEALING:k.WIFE_TO_HUSBAND_SEALING)+((t=e).details.sealingType!==k.PARENTS_SEALED&&t.patronList.some(function(e){return"CHILD"===e.patronType})&&!d.isAGroupAppointmentGuest(t)?"_CHILDREN_ADDED":"")):b.get("appointmentType."+e.appointmentType);var t},H.continueToSelectAppointmentType=function(){c.go("schedule",{appointment:{templeOrgId:H.selectedTemple.templeOrgId}})},H.continueToSelectATemple=function(){o.open(H.yourTempleId).result.then(function(e){e&&Y(e),T.scrollToElement("top-of-landing-page")})},H.deleteAppointment=function(t){F.$broadcast("showSpinner"),d.deleteAppointment(t.templeOrgId,t.id).then(function(){H.existingAppointments.splice(H.existingAppointments.indexOf(t),1),P.syncAppointmentData(),d.isLivingOrdinance(t.appointmentType)&&w.open(t)}).catch(function(e){a.error("Failed to delete appointment "+t.id,e),i.open(t.templeOrgId)}).finally(function(){F.$broadcast("showSpinner")})},H.userHasExistingAppointments=function(){return H.showAppointments&&H.existingAppointments&&H.isDoneCheckingAppointments&&0<H.existingAppointments.length},H.userHasNoAppointments=function(){return H.showAppointments&&H.existingAppointments&&H.isDoneCheckingAppointments&&0===H.existingAppointments.length},H.scheduleAnotherAppointment=function(){H.successfullyScheduledAppointment=!1,H.savedAppointment=void 0,D.clearHoldData(!0),G.clearSelectedSealing()},H.userHasExistingAppointments=function(){return H.showAppointments&&H.existingAppointments&&H.isDoneCheckingAppointments&&0<H.existingAppointments.length},H.userHasNoAppointments=function(){return H.showAppointments&&H.existingAppointments&&H.isDoneCheckingAppointments&&0===H.existingAppointments.length},H.handleActionsButtonClick=function(t,e){var n;H.shareAppointmentUrlMap[t.id]||d.isAGroupAppointment(t)&&g.getGuestAppointmentUrl(t.id).then(function(e){H.shareAppointmentUrlMap[t.id]=e.url}),e&&(n=S.document.getElementById("action-menu-for-appointment-"+t.id).offsetHeight+h.calculateWindowHeight()),h.communicateHeightChange(n)},H.shouldAppointmentBeHighlighted=function(e){return H.shouldShowAppointmentHighlight&&e.id===H.appointmentToHighlightId},H.onAppointmentClick=function(e){H.shouldShowAppointmentHighlight=H.shouldShowAppointmentHighlight&&e.id!==H.appointmentToHighlightId},H.openPatronHousingModal=function(){H.templeHousingInfo&&H.templeHousingInfo.patronHousingUrl&&H.templeHousingInfo.activeDiscountCodes&&0<H.templeHousingInfo.activeDiscountCodes.length?A.open(H.templeHousingInfo):H.templeHousingInfo&&H.templeHousingInfo.patronHousingUrl&&I.open(H.templeHousingInfo)},H.isAGroupAppointmentGuest=function(e){return d.isAGroupAppointmentGuest(e,H.contactInfo)},H.determinePaddingLeftForTempleHeader=function(){return h.isMobileView&&(e=S.document.getElementById("feedback-button"))?e.offsetHeight+"px":"";var e},H.shouldShowPatronHousingInfo=function(){return H.templeHousingInfo&&H.templeHousingInfo.showPatronHousingInformationOnlineScheduling&&(H.templeHousingInfo.patronHousingPhone||H.templeHousingInfo.patronHousingEmail||H.templeHousingInfo.patronHousingUrl)},H.isProxyOrdinance=function(e){return d.isProxyOrdinance(e.appointmentType)},H.shouldDisableEditsAndCancellations=function(e){return d.shouldDisableEditsAndCancellations(e)},H.isNonEditableOpOrdinance=function(e){return d.isNonEditableOpOrdinance(e)}}]),angular.module("tos-ui").controller("scheduleAppointmentController",["$stateParams","$q","appointmentService","appointmentTypeService","$state","tosScrollService","$window","tosTempleConfigService","generalErrorModal","$log","tosLivingSealingService",function(t,n,i,o,a,r,l,s,e,p,c){var d=this;d.appointment=null;var u=function(){var e="appointment-type-selector",t=l.document.getElementById(e);angular.element(t).ready(function(){r.scrollToElement(e)})};d.$onInit=function(){d.initAppointment()},d.initAppointment=function(){var e=n.resolve();t.appointment||(t.appointmentId?e=i.getAppointmentById(t.appointmentId,a.current.name).then(function(e){e.appointmentDateTime=new Date(e.appointmentDateTime),d.appointment=e,u()}).catch(function(e){p.error("Unable to get appointment by id: "+t.appointmentId,e),a.go("landing")}):d.appointment={templeOrgId:null,appointmentType:null,appointmentDateTime:null,appointmentTimeId:null,details:{},patronList:[]}),e.finally(function(){d.appointment=t.appointment||d.appointment||{},d.appointment.details||(d.appointment.details={}),t.templeOrgId&&!d.appointment.templeOrgId?(d.appointment.templeOrgId=t.templeOrgId,s.templeHasOnlineScheduling(t.templeOrgId).then(function(e){e.onlineSchedulingAvailable||(a.go("landing"),d.appointment.templeOrgId=null)})):d.appointment.templeOrgId=d.appointment.templeOrgId||null,d.appointment.appointmentType=d.appointment.appointmentType||t.appointmentTypeId&&o.getValue(t.appointmentTypeId)||null,d.appointment.appointmentTimeId=d.appointment.appointmentTimeId||t.appointmentTimeId||null,d.appointment.appointmentDateTime=d.appointment.appointmentDateTime||null,u()})},d.handleMyAppointmentsLinkClick=function(){c.clearSelectedSealing(),a.go("landing")}}]),angular.module("tos-ui").controller("templeOrdinanceInvitation",["$state","$stateParams",function(e,t){this.handleMyAppointmentsLinkClick=function(){e.go("landing")},this.goToScheduler=function(){e.go("schedule",{appointment:{templeOrgId:t.templeOrgId}})}}]),angular.module("tos-ui").controller("removeSessionController",["$log","$http",function(e,t){this.$onInit=function(){t.get("/signout")}}]),angular.module("tos-ui").factory("appointmentTypeService",["AppointmentType",function(a){return new function(){var t=this;t.getId=function(e){for(var t,n=Object.getOwnPropertyNames(a),i=0;i<n.length;i++){var o=n[i];if(a[o]===e){t=i;break}}return void 0!==t?t:-1},t.getValue=function(e){var t=Object.getOwnPropertyNames(a)[e];return a[t]},t.isValidAppointmentType=function(e){return 0<t.getId(e)},t.appointmentTypeAllowsGroups=function(e){return e===a.PROXY_SEALING||e===a.PROXY_INITIATORY||e===a.PROXY_ENDOWMENT||e===a.LIVING_ENDOWMENT||e===a.LIVING_SEALING},t.appointmentTypeAllowsSpouseToBeAdded=function(e){return e===a.PROXY_SEALING||e===a.PROXY_INITIATORY||e===a.PROXY_ENDOWMENT},t.appointmentTypeAllowsSelfToBeAdded=function(e){return e===a.PROXY_SEALING||e===a.PROXY_INITIATORY||e===a.PROXY_ENDOWMENT||e===a.LIVING_ENDOWMENT}}}]),angular.module("tos-ui").factory("addToCalendarModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"sm",templateUrl:"/app/modules/common/modals/add-to-calendar-modal.html",controller:"addToCalendarModalController",controllerAs:"$ctrl",resolve:{options:function(){return e}},windowClass:"add-to-calendar-window-top"})}}}]).controller("addToCalendarModalController",["tosCalendarService","options","$uibModalInstance","tosModalService",function(e,t,n,i){this.options=t,this.$onInit=function(){i.handleModalRender(n)}}]),angular.module("tos-ui").factory("appointmentNotAvailableModal",["simpleModal","tisfTranslateService",function(t,n){return new function(){this.AddInfoButtonId="ADD-INFO";var e={type:t.Type.DANGER,icon:t.Icon.INFO,title:n.get("appointmentNotAvailableModal.title"),description:n.get("appointmentNotAvailableModal.description"),buttons:[t.defaultButtons.close]};this.open=function(){return t.open(e)}}}]),angular.module("tos-ui").factory("sealingRoomFullModal",["simpleModal","tisfTranslateService",function(t,n){return new function(){var e={type:t.Type.WARNING,icon:"WARNING-FILLED",title:n.get("sealingRoomFullModal.title"),description:n.get("sealingRoomFullModal.description"),buttons:[{id:t.defaultButtonIds.CLOSE,content:n.get("buttons.close"),type:t.Button.Type.SECONDARY,action:t.Button.Action.CLOSE}]};this.open=function(){return t.open(e)}}}]),angular.module("tos-ui").factory("screenSizeService",["$window","$document","$rootScope","tosScrollService",function(t,i,o,a){return new function(){var n=this;function e(){n.isMobileView=i[0].body.offsetWidth<=767,n.currentViewId=n.isMobileView?n.mobileId:n.desktopId,n.templeSelectIsInMobileView=i[0].body.offsetWidth<=1279}n.desktopId="desktop",n.mobileId="mobile",e(),angular.element(t).bind("resize",function(){e(),o.$digest()}),n.communicateHeightChange=function(e){var t=n.calculateWindowHeight();(!e||e<t)&&(e=t),e<450&&(e=450),a.postMessageToParentWindow({height:e})},n.calculateWindowHeight=function(){return t.document.querySelector("[ui-view]").offsetHeight}}}]),angular.module("tos-ui").component("actionMenu",{templateUrl:"/app/modules/components/action-menu/action-menu.html",transclude:!0,bindings:{appointment:"<",contactInfo:"<",shareAppointmentUrlMap:"<",shareLinkMap:"<",deleteAppointmentFn:"<",existingAppointments:"<"},controller:["tosTempleScheduleService","$state","appointmentService","tosScrollService","removeGuestModal","generalErrorModal","tosCalendarService","correspondenceService","tisfTranslateService","emailSentModal","screenSizeService","AppointmentType","deleteAppointmentModal","deleteLivingAppointmentModal","tosUserInfoService","tosUrlService","$log","tosLivingSealingService","unableToEditModal","tosTempleConfigService","tosDateService","tosTempleInfoService","sloqService","snackbarService","$document","tosAdobeAnalyticsService",function(n,i,o,t,e,a,r,l,s,p,c,d,u,m,g,f,h,S,T,v,y,b,A,I,C,O){var E=this;E.$onInit=function(){o.isLivingOrdinance(E.appointment.appointmentType)&&(E.isOpPatron=o.isOpPatron(E.appointment,E.contactInfo),v.getOrdinanceConfig(E.appointment.templeOrgId,E.appointment.appointmentType).then(function(e){E.ordinanceConfig=e})),E.isGroupAppointmentScheduler()?(f.getGuestAppointmentUrl(E.appointment.id).then(function(e){E.shareableLink=e.url}),f.getAppointmentInvitationDetails(E.appointment).then(function(e){E.appointmentInvitationDetails=e.data}),f.getMailToLink(E.appointment).then(function(e){E.mailToEmailInvitation=e.url})):f.getShareAppointmentUrl(E.appointment.templeOrgId,E.appointment.appointmentType,E.appointment.appointmentTimeId).then(function(e){E.shareAppointmentLink=e.url})},E.editAppointment=function(){E.shouldDisableEditsAndCancellations()||E.shouldPreventAppointmentEditsOrCancellations(E.appointment).then(function(e){if(e)T.open(E.appointment);else{var t=E.appointment&&o.isLivingOrdinance(E.appointment.appointmentType);g.getUserInfo(t).then(function(e){if(t)return A.initializeSloqData(e)}).then(function(){return n.getSession(E.appointment.appointmentType,E.appointment.appointmentTimeId,E.appointment.templeOrgId)}).then(function(e){S.changeSealingForAppointmentEdit(E.appointment),i.go("schedule.edit",{appointment:E.appointment,selectedDate:E.appointment.appointmentDateTime?new Date(E.appointment.appointmentDateTime):new Date,appointmentId:E.appointment.id,session:e,isEdit:!0})})}})},E.deleteAppointmentWithModal=function(e){E.shouldDisableEditsAndCancellations()&&!e||E.shouldPreventAppointmentEditsOrCancellations(E.appointment).then(function(e){e?T.open(E.appointment):(t.scrollToElement("top-of-landing-page"),o.isLivingOrdinance(E.appointment.appointmentType)?E.deleteLivingAppointmentModal():E.deleteAppointmentModal())})},E.deleteLivingAppointmentModal=function(){m.open(E.appointment,E.shouldShowEditMenuOption()).result.then(function(e){e?(E.deleteAppointmentFn(E.appointment),O.trackPageView("TOS|Appointment|Delete",null,"TOS Appointment")):E.editAppointment()},function(){}).catch(function(e){h.error("Unknown modal error while trying to delete appointment.",e),a.open(E.appointment.templeOrgId)})},E.deleteAppointmentModal=function(){u.open(E.appointment).result.then(function(){E.deleteAppointmentFn(E.appointment),O.trackPageView("TOS|Appointment|Delete",null,"TOS Appointment")},function(){}).catch(function(e){h.error("Unknown modal error while trying to delete appointment.",e),a.open(E.appointment.templeOrgId)})},E.removeGuestFromGroupAppointment=function(){o.removeGuestFromGroupAppointment(E.contactInfo,E.appointment,E.existingAppointments),O.trackPageView("TOS|Appointment|Remove Guest",null,"TOS Appointment")},E.addToCalendar=function(){t.scrollToElement("top-of-landing-page");var e=o.isLivingOrdinance(E.appointment.appointmentType);g.getUserInfo(e).then(function(e){r.addAppointmentToCalendar(E.appointment,e)})},E.resendConfirmationEmail=function(){if(E.appointment.details||(E.appointment.details={}),E.appointment.details.type||(E.appointment.details.type="proxy"),E.appointment.userIsScheduler)l.resendConfirmationEmail(E.appointment).then(function(){return E.openSuccessfulEmailModal()});else if(E.appointment.contactInfo&&E.appointment.userInGuestList){var t=null;angular.forEach(E.appointment.guestList,function(e){e.guestMrn===E.appointment.contactInfo.mrn&&(t=e.id)}),l.resendConfirmationEmailGuest(E.appointment,t).then(function(){return E.openSuccessfulEmailModal()})}},E.openSuccessfulEmailModal=function(){var e={modalTitle:s.get("myAppointments.actionsResendConfirmationEmail"),modalDesc:s.get("myAppointments.actionsResendConfirmationEmailWillArrive")};p.open(e)},E.sendEmailInvitation=function(){C.location.href=E.mailToEmailInvitation},E.isMobile=function(){return c.isMobileView},E.isGroupAppointmentScheduler=function(){return E.appointment&&o.isGroupAppointmentScheduler(E.appointment,E.contactInfo)},E.shouldShowEditMenuOption=function(){return o.userCanEditAppointment(E.appointment)||E.isNonEditableOpOrdinance()},E.shouldShowDeleteAppointmentOption=function(){return E.appointment&&E.appointment.userIsScheduler||E.isNonEditableOpOrdinance()},E.shouldShowRemoveMeAsGuestOption=function(){return E.appointment&&!E.appointment.userIsScheduler&&!E.isOpPatron},E.shouldShowCopyLinkOption=function(){return E.appointment&&E.appointment.onlineSchedulingIsEnabledForOrdinance&&o.isProxyOrdinance(E.appointment.appointmentType)&&E.appointment.appointmentType!==d.PROXY_BAPTISM&&!o.isGroupAppointmentScheduler(E.appointment)},E.shouldShowCopyGroupAppointmentLinkOption=function(){return E.appointment&&E.appointment.onlineSchedulingIsEnabledForOrdinance&&E.appointmentTypeCanViewOptionInActionMenu()&&E.isGroupAppointmentScheduler(E.appointment)},E.shouldShowResendGuestEmailOption=function(){return E.appointment&&E.isOnlineAppointment()&&E.isGroupAppointmentScheduler(E.appointment)},E.shouldShowSendConfirmationEmailOption=function(){return E.appointment},E.shouldShowCopyShareableGroupLinkOption=function(){return E.appointment&&E.appointmentTypeCanViewOptionInActionMenu()&&E.isGroupAppointmentScheduler(E.appointment)},E.shouldShowCopyInvitationDetailsOption=function(){return E.appointment&&E.appointmentTypeCanViewOptionInActionMenu()&&E.isGroupAppointmentScheduler(E.appointment)},E.shouldShowSendEmailInvitationOption=function(){return E.appointment&&E.appointmentTypeCanViewOptionInActionMenu()&&E.isGroupAppointmentScheduler(E.appointment)},E.isOnlineAppointment=function(){return E.appointment.onlineEligibleFlg},E.appointmentTypeCanViewOptionInActionMenu=function(){return E.appointment.appointmentType&&(o.isProxyOrdinance(E.appointment.appointmentType)||o.isLivingOrdinance(E.appointment.appointmentType))},E.shouldPreventAppointmentEditsOrCancellations=function(e){return o.shouldPreventAppointmentEditsOrCancellationsPromise(e,E.ordinanceConfig)},E.shouldDisableEditsAndCancellations=function(){return o.shouldDisableEditsAndCancellations(E.appointment)||E.isNonEditableOpOrdinance()},E.showClipboardSuccessAlert=function(){return I.openSnackbar(3e3)},E.isNonEditableOpOrdinance=function(){return o.isNonEditableOpOrdinance(E.appointment)},E.removePatronFromOpOrdinance=function(){E.appointment.userIsScheduler||o.isRequiredPatron(E.appointment,E.contactInfo)?E.deleteAppointmentWithModal(!0):o.removePatronFromAppointment(E.contactInfo,E.appointment,E.existingAppointments)}}]}),angular.module("tos-ui").component("appointmentAttendees",{templateUrl:"/app/modules/components/appointment-attendees/appointment-attendees.html",transclude:!0,bindings:{appointment:"<"},controller:["appointmentTypeService","appointmentService","tisfTranslateService","tosUserInfoService",function(e,o,a,t){var r=this;r.$onInit=function(){var e=o.isLivingOrdinance(r.appointment.appointmentType);t.getUserInfo(e).then(function(e){r.appointment.contactInfo=e}),r.appointment.unconfirmedCount=r.appointment.details.guestCount-r.appointment.guestList.length,r.unconfirmedTooltipLabel=a.get("myAppointments.numberOfUnconfirmedSeats",r.appointment.unconfirmedCount),r.unconfirmedTooltipText=a.get("myAppointments.unconfirmedTooltipText")},r.isAGroupAppointment=function(){return!!(r.appointment&&r.appointment.details&&r.appointment.contactInfo&&r.appointment.guestList)&&o.isAGroupAppointment(r.appointment)},r.isLivingOrdinances=function(){return o.isLivingOrdinance(r.appointment.appointmentType)},r.isLivingSealing=function(){return o.isLivingSealing(r.appointment.appointmentType)},r.getGroupLinkText=function(e){var t=r.isLivingOrdinances()?"myAppointments.totalNumberOfAttendeesLiving":"myAppointments.totalNumberOfAttendees";return a.translate(t,e)},r.getLivingSealingAttendees=function(e){if(!e||!e.patrons||0===e.patrons.length)return"";var t=[];return e.patrons.forEach(function(e){e&&angular.isString(e)&&t.push(e)}),r.appointment&&r.appointment.contactInfo&&r.appointment.contactInfo.mrn&&o.findMrnInGuestList(r.appointment.contactInfo.mrn,e.guestList)&&(e.inclSelf=!0,e.inclSpouse=!1),t.join("")},r.getPatronNamesOnNewLines=function(e){if(!e||!e.patrons||0===e.patrons.length)return"";var t=[];if(e.patrons.forEach(function(e){e&&angular.isString(e)&&t.push(e)}),r.appointment&&r.appointment.contactInfo&&r.appointment.contactInfo.mrn){var n=o.findSpouseInGuestList(r.appointment.contactInfo,e.guestList),i=o.findMrnInGuestList(r.appointment.contactInfo.mrn,e.guestList);i&&n?(t.push(a.get("myAppointments.and.spouse")),e.inclSelf=!0,e.inclSpouse=!0):n?(t.unshift(a.get("myAppointments.onlySpouse")),e.inclSelf=!1,e.inclSpouse=!0):i?(e.inclSelf=!0,e.inclSpouse=!1):(e.inclSelf=!1,e.spouseIsIncluded=!1)}return t.join("<br>")},r.buildConfirmedGuestsHtml=function(){var e="<strong>"+a.get("myAppointments.confirmedAttendees")+"</strong>",t="";return r.appointment.guestList.forEach(function(e){return t+="<p>"+e.name+"</p>"}),"<div>"+e+t+"</div>"}}]}),angular.module("tos-ui").component("feedbackQuestion",{templateUrl:"/app/modules/components/feedback-question/feedback-question.html",bindings:{question:"<",parentQuestion:"<?",feedbackResponse:"="},controller:function(){var n=this;n.checked=!1,n.text="",n.handleCheckboxChange=function(){if(n.feedbackResponse.answeredQuestions||(n.feedbackResponse.answeredQuestions=[]),n.checked)n.feedbackResponse.answeredQuestions.push({questionId:n.question.questionId});else{n.text="";var e=n.feedbackResponse.answeredQuestions.findIndex(function(e){return e.questionId===n.question.questionId});0<=e&&n.feedbackResponse.answeredQuestions.splice(e,1)}},n.handleTextValueChange=function(){for(var e=0;e<n.feedbackResponse.answeredQuestions.length;e++){var t=n.feedbackResponse.answeredQuestions[e];if(t.questionId===n.question.questionId){t.text=n.text;break}}},n.shouldShowQuestion=function(){return!n.parentQuestion||"PARENT_GOOD_BAD"!==n.parentQuestion.questionType||"PARENT_GOOD_BAD"===n.parentQuestion.questionType&&("BAD"===n.feedbackResponse.schedulingExperienceRating||"OKAY"===n.feedbackResponse.schedulingExperienceRating)}}}),angular.module("tos-ui").component("finalizeAppointment",{templateUrl:"/app/modules/components/finalize-appointment/finalize-appointment.html",bindings:{appointment:"=",session:"<",isEdit:"<",inclSelf:"<",inclSpouse:"<",onAppointmentNotAvailableWhenScheduling:"<",templePhoneNumber:"<",isOpen:"=",primaryLanguages:"<"},controller:["$scope","$state","$log","$uibModal","tisfTranslateService","contactInfoModal","informationMissingModal","sessionNotAvailableModal","screenSizeService","tosUserInfoService","tosTempleInfoService","appointmentService","generalErrorModal","AppointmentType","TspValidationException","localizeDateTimeFilter","scheduleLimitReachedModal","conflictingAppointmentModal","conflictingAppointmentGuestModal","tosTempleScheduleService","needMoreTimeModal","outOfTimeModal","$rootScope","$stateParams","tosTempleConfigService","sessionIsFullModal","recommendWarningModal","tosDateService","tosLivingSealingService","tspPatronService","guestLimitExceededModal","endowmentRequiredModal","guestCountValidatorService","sealingRoomFullModal","tosAdobeAnalyticsService","tosMessagingService","tosSmsSubscriptionService","usNumberRequiredModal",function(i,l,s,e,o,t,n,p,a,r,c,d,u,m,g,f,h,S,T,v,y,b,A,I,C,O,E,$,L,N,M,D,w,P,G,k,_,x){var F=this;F.AppointmentType=m,F.tosLivingSealingService=L,F.appointmentContact={},F.onAppointmentNotAvailableWhenScheduling=null,F.canComplete=!0,F.timer=120,F.selfGuest=!1,F.spouseGuest=!1,F.START_KEYWORD="START";var R=function(){setInterval(function(){F.isOpen&&(0!==F.timer&&F.timer--,60===F.timer?y.open(F.appointment):0!==F.timer||b.isOpen()||(y.isOpen()&&y.close(),b.open(F.appointment,F.session,F.inclSelf,F.inclSpouse,F.isEdit,F.selfGuest,F.spouseGuest)))},1e3)};function H(){F.guestLanguage=null,F.languageAssistanceNeeded=!1,F.previousSelectedLanguageAssistance=null,F.spouseLanguage=null,F.spouseLanguageAssistanceNeeded=!1,F.previousSelectedSpouseLanguageAssistance=null}function U(t){F.appointment.appointmentType===m.PROXY_ENDOWMENT||F.appointment.appointmentType===m.LIVING_ENDOWMENT?c.getEndowmentAvLanguages().then(function(e){F.languages=e,t&&H()}):c.getOrdinanceCardsLanguages().then(function(e){F.languages=e,t&&H()})}var V=function(){return F.appointment.language&&F.appointment.userIsScheduler?F.appointment.language:F.languageLabel||F.appointment.sessionLanguage||F.language||F.ordinanceLanguage||(F.primaryLanguages&&1===F.primaryLanguages.length?o.get("tisf.language."+F.primaryLanguages[0]):o.get("tisf.language.0"))},W=function(e){F.smsConfirmation=!(!e||!e.isSubscribed),F.userHasSmsSubscriptionEntryForTemple=Boolean(e),F.userHasSmsSubscriptionEntryForTemple&&(F.userIsSubscribedToSmsForTemple=e.isSubscribed),F.originalSmsConfirmation=F.smsConfirmation};F.$onInit=function(){A.$on("resetTimer",function(){F.timer=120}),A.$on("resetOpening",function(){F.isOpen=!1}),i.$on("set_original_additional_guests",function(e,t){F.originalAdditionalMaleGuestCount=t.originalAdditionalMaleGuestCount,F.originalAdditionalFemaleGuestCount=t.originalAdditionalFemaleGuestCount,F.originalAdditionalGuestCount=t.originalAdditionalGuestCount}),"schedule.guest"!==l.current.name?R():setTimeout(function(){var e=i.$watch("$ctrl.appointment.guestCanSchedule",function(){F.appointment.guestCanSchedule&&(R(),e())})},2e4),"schedule.guest"===l.current.name&&F.appointment.appointmentType===m.LIVING_SEALING&&L.setupGuestOrEditDetails(F.appointment);var n=i.$watch("$ctrl.appointment",function(){if("schedule.edit"!==l.current.name||"schedule.edit"===l.current.name&&F.appointment&&F.appointment.id&&F.appointment.details&&void 0!==F.appointment.details.guestCount){n(),i.$watch("$ctrl.appointment.appointmentDateTime",function(e){if(e){var t=d.getCorrectAppointmentType(F.appointment);C.getOrdinanceConfig(F.appointment.templeOrgId,t).then(function(e){F.arrivalTime=F.appointment.displayedAppointmentDate?f(d.getArrivalTimeForSpecificAppointmentTime(F.appointment,F.appointment.displayedAppointmentDate,e),"time"):f(d.getArrivalTimeForAppointment(F.appointment,e),"time")})}});var e=function(){F.session&&!F.session.language&&F.primaryLanguages&&0<F.primaryLanguages.length?F.ordinanceLanguage=1===F.primaryLanguages.length?o.get("tisf.language."+F.primaryLanguages[0]):"":F.session&&F.session.language&&F.primaryLanguages?(F.language=F.appointment.language||F.session.language,F.appointment.sessionLanguage=F.session.language,c.getLanguageAssistanceName(F.appointment.appointmentType,F.language).then(function(e){F.ordinanceLanguage=e})):F.ordinanceLanguage="",F.languageLabel=V()};i.$watch("$ctrl.primaryLanguages",e),i.$watch("$ctrl.session",e);var t=d.isLivingOrdinance(F.appointment.appointmentType);r.getUserInfo(t).then(function(e){var n,t;F.setContactInfo(F.appointment,e),"schedule.edit"===l.current.name?(t=F.appointment,c.getTempleMessagingInfoByOrgId(t.templeOrgId).then(function(e){e&&e.messagingEnabledFlg&&e.messagingPhone?d.isLivingOrdinance(t.appointmentType)?(F.shouldShowMessagingControls=!1,F.smsConfirmation=!1):(F.shouldShowMessagingControls=!0,F.templeMessagingPhone=e.messagingPhone,F.smsConfirmation=!!t.contactSmsConfirmation,F.originalSmsConfirmation=F.smsConfirmation):(F.smsConfirmation=!1,F.shouldShowMessagingControls=!1),F.disableSmsCheckbox=!F.smsConfirmation&&F.isEdit}).then(function(){F.templeMessagingPhone&&_.getSmsSubscriptionPreferences(F.appointment.contactInfo.phone,F.templeMessagingPhone).then(function(e){F.userHasSmsSubscriptionEntryForTemple=Boolean(e),F.userHasSmsSubscriptionEntryForTemple&&(F.userIsSubscribedToSmsForTemple=e.isSubscribed)})}),F.emailConfirmation=!!F.appointment.contactEmailConfirmation):(n="schedule.guest"===l.current.name?F.appointmentContact.contactInfo:F.appointment.contactInfo.phone,c.getTempleMessagingInfoByOrgId(F.appointment.templeOrgId).then(function(e){return e&&e.messagingEnabledFlg&&e.messagingPhone&&!d.isLivingOrdinance(F.appointment.appointmentType)?(F.shouldShowMessagingControls=!0,F.templeMessagingPhone=e.messagingPhone,e.messagingPhone):(F.shouldShowMessagingControls=!1,null)}).then(function(t){return t?k.lookupPhoneNumber(n).then(function(e){return e.valid&&"US"===e.country_code?(F.patronMessagingPhone=e.phone_number,F.usNumError=!1,{patronNumber:e.phone_number,templeNumber:t}):(F.usNumError=!0,null)}):null}).then(function(e){return e?_.getSmsSubscriptionPreferences(e.patronNumber,e.templeNumber):null}).then(function(e){W(e)}),F.emailConfirmation=!0)}),"schedule.guest"===l.current.name||"schedule.edit"===l.current.name?function(){if(l.router&&l.router.urlRouter&&l.router.urlRouter.location&&("schedule.edit"===l.current.name||"schedule.guest"===l.current.name)){if(!F.appointment)return l.go("landing");F.appointmentId=F.appointment.id,F.appointment.contactInfo={},d.findSpouseInAppointment(F.appointment).then(function(e){F.appointment.inclSpouse=!!e,F.appointment.inclSpouse&&r.spouseHasEmail().then(function(t){F.spouseHasEmail=t.spouseHasEmail;var e=d.isLivingOrdinance(F.appointment.appointmentType);r.getIndexOfSpouseGuest(F.appointment.guestList,e).then(function(e){0<=e&&(F.indexOfSpouseGuest=e,F.appointment.guestList[e].guestEmailConfirmationFlg=!!t.spouseHasEmail&&(void 0===F.appointment.guestList[e].guestEmailConfirmationFlg||F.appointment.guestList[e].guestEmailConfirmationFlg))})})});var e=d.isLivingOrdinance(F.appointment.appointmentType);r.getIndexOfSpouseGuest(F.appointment.guestList,e).then(function(e){0<=e&&(F.indexOfSpouseGuest=e,F.spouseLanguage=F.appointment&&F.appointment.guestList&&F.appointment.guestList[e]&&F.appointment.guestList[e].language||void 0,F.spouseLanguageAssistanceNeeded=!!F.spouseLanguage,F.spouseGuest=!0)}),r.getIndexOfSelfGuest(F.appointment.guestList).then(function(e){F.selfGuest=0<=e}),F.session&&F.session.language&&(F.language||(F.language=F.appointment.language||F.session.language),F.appointment.sessionLanguage=F.session.language,c.getLanguageAssistanceName(F.appointment.appointmentType,F.language).then(function(e){F.ordinanceLanguage=e}))}}():F.appointment.userIsScheduler=!0,F.appointment.language=F.appointment.language||null,F.appointment.inclSelf=!!F.inclSelf,i.$watch("$ctrl.inclSpouse",function(e,t){if(e&&t!==e){F.appointment.inclSpouse=!0;var n=d.isLivingOrdinance(F.appointment.appointmentType);r.getIndexOfSpouseGuest(F.appointment.guestList,n).then(function(t){0<=t?(F.indexOfSpouseGuest=t,F.appointment.guestList[t].guestEmailConfirmationFlg=void 0===F.appointment.guestList[t].guestEmailConfirmationFlg||F.appointment.guestList[t].guestEmailConfirmationFlg,r.spouseHasEmail().then(function(e){F.spouseHasEmail=e.spouseHasEmail,F.appointment.guestList[t].guestEmailConfirmationFlg=!!e.spouseHasEmail&&(void 0===F.appointment.guestList[t].guestEmailConfirmationFlg||F.appointment.guestList[t].guestEmailConfirmationFlg)}),F.spouseGuest=!0):F.spouseGuest=!1})}else e||t===e||(F.appointment.inclSpouse=!1,F.spouseLanguage=null)}),i.$watch("$ctrl.inclSelf",function(e,t){r.getIndexOfSelfGuest(F.appointment.guestList).then(function(e){F.selfGuest=0<=e}),e&&t!==e?F.appointment.inclSelf=!0:e||t===e||(F.appointment.inclSelf=!1)}),U(!1),i.$watch("$ctrl.languageAssistanceNeeded",function(e,t){e!==t&&(e?F.previousSelectedLanguageAssistance&&(F.guestLanguage=F.previousSelectedLanguageAssistance):(F.previousSelectedLanguageAssistance=F.guestLanguage,F.guestLanguage=null,F.appointment.guestList.forEach(function(e){F.appointment.contactInfo&&F.appointment.contactInfo.mrn&&F.appointment.contactInfo.mrn===e.guestMrn&&(e.language=null)})))}),i.$watch("$ctrl.guestLanguage",function(t,e){null!==t&&t!==e&&F.appointment&&(F.appointment.userIsScheduler?F.appointment.appointmentType===m.LIVING_ENDOWMENT?F.appointment.language=t:F.appointment.guestList.forEach(function(e){F.appointment.contactInfo&&F.appointment.contactInfo.mrn&&F.appointment.contactInfo.mrn===e.guestMrn&&(e.language=t)}):F.appointmentContact&&F.appointmentContact.guestMrn&&(F.appointmentContact.language=t))}),F.appointment&&F.appointment.guestList&&0<F.appointment.guestList.length&&i.$watch("$ctrl.spouseLanguageAssistanceNeeded",function(e,t){null!==e&&e!==t&&(e?F.previousSelectedSpouseLanguageAssistance&&(F.spouseLanguage=F.previousSelectedSpouseLanguageAssistance):(F.previousSelectedSpouseLanguageAssistance=F.spouseLanguage,F.spouseLanguage=null))}),i.$watch("$ctrl.spouseLanguage",function(t,e){if(null!==t&&t!==e&&F.appointment&&0<F.appointment.guestList.length){var n=d.isLivingOrdinance(F.appointment.appointmentType);r.getIndexOfSpouseGuest(F.appointment.guestList,n).then(function(e){0<=(F.indexOfSpouseGuest=e)&&(F.indexOfSpouseGuest=e,F.appointment.guestList[e].language=t)})}}),i.$watch("$ctrl.appointment.appointmentType",function(e,t){null!==e&&e!==t&&U(!0)})}});if("schedule.guest"===l.current.name){var e=d.isLivingOrdinance(F.appointment.appointmentType);r.getUserInfo(e).then(function(e){var t=!1;if(e.recommend&&e.recommend.expirationDate&&F.appointment&&F.appointment.appointmentDateTime&&angular.isDate(F.appointment.appointmentDateTime)){var n=$.parseDateAsLocalTime(e.recommend.expirationDate);t=F.appointment.appointmentDateTime>n}var i=e.recommend&&"ACTIVE"===e.recommend.status,o=!!e.endowmentDate;if(e.appointments&&0<e.appointments.length){var a=e.appointments.find(function(e){return e.appointmentType===m.LIVING_ENDOWMENT});a&&F.appointment.appointmentDateTime&&angular.isDate(F.appointment.appointmentDateTime)&&(o=new Date(a.appointmentDateTime)<F.appointment.appointmentDateTime)}d.needsRegularRecommend(F.appointment.appointmentType)&&(e.recommend&&"NONE"===e.recommend.recommendType||!o)?D.open().result.then(function(){l.go("landing")}):i&&!t||E.open()})}},F.onEditContactInfoClicked=function(){F.openContactInfoModal()},F.getMaleAdultName=function(){return L.getMaleAdultName()},F.getFemaleAdultName=function(){return L.getFemaleAdultName()},F.getChildName=function(e){return L.getChildName(e)},F.shouldShowChildrenAndObservers=function(){return L.shouldShowChildrenAndObservers()},F.getChildrenForSealing=function(){return L.getChildrenForSealing()},F.getObserversForSealing=function(){return L.getObserversForSealing()},F.getSealingTypeMessage=function(){return L.getSealingTypeMessage()},F.getLanguageLabel=function(){var e=F.appointment.appointmentType===m.LIVING_ENDOWMENT||F.appointment.appointmentType===m.PROXY_ENDOWMENT?c.getCachedEndowmentAvLanguages():c.getCachedOrdinanceCardsLanguages();F.languageLabel=V();var t=e.find(function(e){return e.value===F.languageLabel});return t?t.label:F.languageLabel},F.openContactInfoModal=function(){F.canComplete=!1,t.open(F.appointmentContact,"schedule.edit"===l.current.name&&(F.originalSmsConfirmation||F.smsConfirmation)).result.then(function(t){if(F.appointmentContact||(F.appointmentContact={}),angular.extend(F.appointmentContact,t),m.LIVING_ENDOWMENT===F.appointment.appointmentType||m.LIVING_SEALING===F.appointment.appointmentType){var e=F.appointment.patronList.find(function(e){return e.memberInfo.mrn===t.guestMrn});e.personalPhone=t.contactInfo,e.email=t.email}else{var n=F.appointment.guestList.find(function(e){return e.guestMrn===t.guestMrn});n&&angular.extend(n,t)}F.appointment.userIsScheduler&&(F.appointment.contactInfo.phone=t.contactInfo,F.appointment.contactInfo.email=t.email),F.shouldShowMessagingControls&&"schedule.edit"!==l.current.name?k.lookupPhoneNumber(t.contactInfo).then(function(e){return e.valid&&"US"===e.country_code?(F.patronMessagingPhone=e.phone_number,F.usNumError=!1,e.phone_number):(F.usNumError=!0,null)}).then(function(e){return e?_.getSmsSubscriptionPreferences(e,F.templeMessagingPhone):null}).then(function(e){W(e),F.canComplete=!0}).catch(function(e){s.error("Unexpected error when updating SMS data",e),F.canComplete=!0}):F.canComplete=!0},function(e){s.info("Did not update contact info:",e),F.canComplete=!0}).catch(function(e){s.error("Unexpected error while trying to update contact info:",e),F.canComplete=!0})};var B=function(){l.go("landing")},q=function(e){if(F.canComplete=!0,s.error("Error: ",e),e.validationErrors){for(var t,n=0;n<e.validationErrors.length;n++){var i=e.validationErrors[n],o=i.validationException===g.APPOINTMENT_NO_LONGER_EXISTS,a=i.validationException===g.APPOINTMENT_TIME_NOT_ENOUGH_SEATS,r=i.validationException===g.PAST_APPOINTMENT;if(F.isAGroupAppointment()&&!F.appointment.userIsScheduler&&a)O.open(!0,F.appointment).result.then((B(),function(){}));else{if(o||a||r){t=p.open(F.appointment,F.session,o,a,r);break}if(i.validationException===g.MAX_APPOINTMENTS_SCHEDULED)return h.open(!F.isEdit).result.then((l.go("schedule",{appointment:{templeOrgId:F.appointment.templeOrgId}}),B()));if(i.validationException===g.SPOUSE_CONFLICTING_APPOINTMENT)return S.open(F.appointment,{spouseAppointmentConflict:!0});if(i.validationException===g.SPOUSE_AND_PATRON_CONFLICTING_APPOINTMENT)return"schedule.guest"===l.current.name?T.open(F.appointment,{spouseAndPatronAppointmentConflict:!0}):S.open(F.appointment,{spouseAndPatronAppointmentConflict:!0})}}t||u.open(F.appointment.templeOrgId)}else s.error("There was a problem saving the appointment:",e),u.open(F.appointment.templeOrgId)},z=function(){C.getOrdinanceConfig(F.appointment.templeOrgId,F.appointment.appointmentType).then(function(e){!function(e){if(F.appointment.userIsScheduler&&F.isAGroupAppointment()){if(!d.isLivingOrdinance(F.appointment.appointmentType))return w.proxyGuestCountIsValid(F,e);if(m.LIVING_ENDOWMENT===F.appointment.appointmentType)return w.livingGuestCountIsValid(F,e);if(m.LIVING_SEALING===F.appointment.appointmentType)return F.appointment.livingSealingSeatCount&&F.appointment.details&&F.appointment.details.guestCount<=F.appointment.livingSealingSeatCount}else if(m.LIVING_SEALING===F.appointment.appointmentType)return F.appointment.guestList.length+1<=F.appointment.details.locationSeats;return!0}(e)?m.LIVING_SEALING===F.appointment.appointmentType?F.appointment.userIsScheduler?M.open():P.open().result.finally(B):M.open():(F.canComplete=!1,F.appointment.currentUserMrn=F.appointmentContact.guestMrn,F.appointment.userAlreadyInGuestList=F.appointment.guestList.some(function(e){return e.guestMrn===F.appointmentContact.guestMrn}),function(){if("schedule.guest"!==l.current.name){if(F.appointment.userIsScheduler&&(F.appointment.contactSmsConfirmation=F.smsConfirmation,F.appointment.contactEmailConfirmation=F.emailConfirmation,F.appointment.contactInfo.phone=F.smsConfirmation&&F.patronMessagingPhone||F.appointment.contactInfo.phone,F.appointment.userAlreadyInGuestList)){var e=F.appointment.guestList.findIndex(function(e){return e.guestMrn===F.appointment.contactInfo.mrn});F.appointment.guestList[e].guestSmsConfirmationFlg=F.smsConfirmation,F.appointment.guestList[e].guestEmailConfirmationFlg=F.emailConfirmation,F.smsConfirmation&&(F.appointment.guestList[e].contactInfo=F.patronMessagingPhone||F.appointment.guestList[e].contactInfo)}}else F.appointmentContact.guestSmsConfirmationFlg=F.smsConfirmation,F.appointmentContact.guestEmailConfirmationFlg=F.emailConfirmation;F.appointmentContact.contactInfo=F.smsConfirmation&&F.patronMessagingPhone||F.appointmentContact.contactInfo}(),!F.isAGroupAppointment()||F.appointment.userIsScheduler||F.appointment.userAlreadyInGuestList||(F.increasePatronCountWhenExceeded(),F.appointmentContact.appointmentGuestAction="ADD",F.appointment.guestList.push(F.appointmentContact)),F.appointment.needsLangAsst=F.languageAssistanceNeeded,F.isAGroupAppointment()&&!F.appointment.userIsScheduler?d.userCanScheduleAnotherAppointment(F.appointment).then(function(e){e?F.saveAppointment():h.open(!0).result.then(function(){l.go("schedule",{appointment:{templeOrgId:F.appointment.templeOrgId}})},function(){return l.go("landing")})}).catch(function(e){q(e)}):F.saveAppointment())})};F.scheduleAppointment=function(){F.appointment?F.getContactName()&&F.getContactEmail()?F.smsConfirmation&&"schedule.edit"!==l.current.name?k.lookupPhoneNumber(F.getContactPhoneNumber()).then(function(e){e.valid&&"US"===e.country_code?(F.usNumError=!1,F.patronMessagingPhone=e.phone_number,z()):x.open().result.then(function(){F.usNumError=!0,F.openContactInfoModal()},function(){F.usNumError=!0})}):z():n.open().result.then(function(){F.openContactInfoModal()}):s.error("Unable to save appointment",F.appointment)},F.increasePatronCountWhenExceeded=function(){d.isLivingOrdinance(F.appointment.appointmentType)&&F.appointment.details.guestCount<=F.appointment.guestList.length&&F.appointment.details.guestCount++;var e=F.appointment.details.malePatronCount,t=F.appointment.details.femalePatronCount,n=F.appointment.guestList.slice().filter(function(e){return"MALE"===e.gender}).length,i=F.appointment.guestList.slice().filter(function(e){return"FEMALE"===e.gender}).length;"MALE"===F.appointmentContact.gender&&e<=n&&F.appointment.details.malePatronCount++,"FEMALE"===F.appointmentContact.gender&&t<=i&&F.appointment.details.femalePatronCount++},F.saveAppointment=function(){F.appointment&&F.appointment.originalAppointmentDateTime!==F.appointment.appointmentDateTime&&(F.appointment.details.relatedInitiatoryApptId=null),!F.userHasSmsSubscriptionEntryForTemple&&F.smsConfirmation?_.saveNewSmsSubscription(F.patronMessagingPhone,F.templeMessagingPhone).finally(function(){F.continueSaveAppointment()}):F.continueSaveAppointment()},F.continueSaveAppointment=function(){d.saveAppointment(F.appointment).then(function(e){"schedule.guest"===l.current.name?G.trackPageView("TOS|Appointment|Guest|Finalize",null,"TOS Appointment"):G.trackPageView("TOS|Appointment|Finalize",null,"TOS Appointment"),l.go("landing",{successfullyScheduledAppointment:!0,savedAppointment:e})}).catch(function(e){q(e)})},F.getScheduleButtonText=function(){var e=F.isEdit?"finalizeAppointment.updateScheduleButton":"finalizeAppointment.scheduleAppointmentButton";return o.get(e)},F.getContactName=function(){return F.appointmentContact&&F.appointmentContact.name?F.appointmentContact.name:F.appointment&&F.appointment.contactInfo&&F.appointment.contactInfo.name},F.getNameFieldText=function(){var e=F.getContactName()||o.get("finalizeAppointment.requiredLabel");return o.get("finalizeAppointment.usersName",e)},F.getGroupNameFieldText=function(){var e=F.appointment.details.groupName||o.get("finalizeAppointment.requiredLabel");if(m.LIVING_ENDOWMENT!==F.appointment.appointmentType)return o.get("appointmentDetails.groupName",e);var t=o.get("appointmentType."+F.appointment.appointmentType);return o.get("appointmentDetails.living.groupName",[e,t])},F.getContactEmail=function(){return F.appointmentContact&&F.appointmentContact.email?F.appointmentContact.email:F.appointment&&F.appointment.contactInfo&&F.appointment.contactInfo.email},F.getEmailFieldText=function(){var e=F.getContactEmail()||o.get("finalizeAppointment.requiredLabel");return o.get("finalizeAppointment.usersEmailAddress",e)},F.getContactPhoneNumber=function(){return F.appointmentContact&&F.appointmentContact.contactInfo?F.appointmentContact.contactInfo:F.appointment&&F.appointment.contactInfo&&F.appointment.contactInfo.phone},F.getPhoneNumberFieldText=function(){var e=F.getContactPhoneNumber()||"";return o.get("finalizeAppointment.usersMobilePhoneNumber",e)},F.isRecommendExpiringSoon=function(){if(!(F.appointment.contactInfo&&F.appointment.appointmentDateTime&&F.appointment.contactInfo.recommend&&F.appointment.contactInfo.recommend.expirationDate))return!1;var e=new Date(F.appointment.contactInfo.recommend.expirationDate);return F.recommendExpirationDate=f(e,f.formatNames.monthLongYear),new Date(e.setDate(e.getDate()-31))<=new Date(F.appointment.appointmentDateTime)},F.isAGroupAppointment=function(){return d.isAGroupAppointment(F.appointment)},F.setContactInfo=function(t,n){F.appointment.contactInfo={},"schedule.guest"!==l.current.name&&(F.appointment.contactInfo.name=t.details.contactName||n.name,F.appointment.contactInfo.phone=t.details.contactInfo||n.phone,F.appointment.contactInfo.email=t.details.contactEmail||n.email,F.appointment.contactInfo.mrn=t.details.contactMrn||n.mrn),F.isAGroupAppointment(t)||"schedule.guest"!==l.current.name||B();var e,i=F.appointment&&F.appointment.guestList&&F.appointment.guestList.find(function(e){return e.guestMrn===n.mrn});if(F.guestLanguage=(e=i,F.appointment.appointmentType===m.LIVING_ENDOWMENT?F.appointment.language:e?e.language:""),F.languageAssistanceNeeded=!!F.guestLanguage,n&&!F.contactInfo)if(!F.isAGroupAppointment(t)||F.appointment.userIsScheduler)F.appointment.contactInfo=_objectSpread(_objectSpread({},n),F.appointment.contactInfo),t.details&&(F.appointmentContact.name=t.details.contactName||n.name,F.appointmentContact.contactInfo=t.details.contactInfo||n.phone,F.appointmentContact.email=t.details.contactEmail||n.email,F.appointmentContact.guestMrn=t.details.mrn||n.mrn);else{F.appointmentContact.appointmentId=t.id,F.appointmentContact.name=n.name,F.appointmentContact.contactInfo=n.phone,F.appointmentContact.email=n.email,F.appointmentContact.gender=n.gender,F.appointmentContact.guestMrn=n.mrn;var o=t.guestList.find(function(e){return e.id&&e.id===t.details.contactId});o&&(F.appointment.contactInfo.gender=o.gender)}else!n&&F.appointment.contactInfo.name&&F.appointment.contactInfo.phone&&F.appointmentContact.email&&F.appointmentContact.guestMrn&&(F.appointmentContact.name=t.details.contactName,F.appointmentContact.contactInfo=t.details.contactInfo,F.appointmentContact.email=t.details.contactEmail,F.appointmentContact.guestMrn=t.details.mrn)},F.shouldDisableScheduleAppointmentButton=function(){return!F.canComplete||"schedule.guest"===l.current.name&&!F.appointment.guestCanSchedule},F.getAttendeeCount=function(){return F.appointment.appointmentType===m.LIVING_ENDOWMENT?F.appointment.patronList.length+F.appointment.additionalGuestCount:F.appointment.details.guestCount},F.getDisplayedAppointmentDateTime=function(){return F.appointment.displayedAppointmentDate||F.appointment.appointmentDateTime},F.isLivingOrdinance=function(e){return d.isLivingOrdinance(e)}}]}),angular.module("tos-ui").component("goodBadRatingQuestion",{templateUrl:"/app/modules/components/good-bad-rating-question/good-bad-rating-question.html",bindings:{question:"<",feedbackResponse:"="},controller:function(){}}),angular.module("tos-ui").component("modalHeader",{templateUrl:"/app/modules/components/modal-header/modal-header.html",bindings:{headerText:"<",canDismiss:"<",dismissFunction:"&",iconClass:"<",includeIcon:"<",leftAlignTitle:"<",isModal:"<?"},controller:["$scope",function(e){var t=this;t.updateIncludeIcon=!0,t.includeIcon&&(t.updateIncludeIcon=t.includeIcon),t.isUndefinedOrNull=function(e){return angular.isUndefined(e)||null===e},t.closeModal=function(){"[object Function]"!=={}.toString.call(t.dismissFunction)||t.isUndefinedOrNull(t.dismissFunction)||t.dismissFunction(),!1!==t.isModal&&e.$parent.$dismiss("closed")}}]}),angular.module("tos-ui").component("ordinanceSelector",{templateUrl:"/app/modules/components/ordinance-selector/ordinance-selector.html",bindings:{selectedOrdinanceType:"=",templePhoneNumber:"<",templeOrgId:"<",previouslySelectedOrdinanceType:"<",templeEmail:"<"},controller:["tisfTranslateService","tosTempleConfigService","$scope","$rootScope","AppointmentType","$filter","appointmentService","SloqQualificationStatus","sloqService","tosHoldService","tosUserInfoService","tosTempleInfoService","$state","tosLivingSealingService","multipleLivingSealingModal","licensedMarriageModal","sealingSameTimeModal","SealingType","combineSealingsModal","alreadyScheduledModal","unableToEditModal","tosTempleScheduleService",function(n,i,e,o,a,t,r,l,s,p,c,d,u,m,g,f,h,S,T,v,y,b){var A=this;A.AppointmentType=a,A.livingOrdinancesEnabled=!1,A.legalMarriagesAllowed=!1,A.shouldShowLivingOrdinances=!1,A.showSpinner=!1;var I=function(){c.getUserInfo(A.shouldShowLivingOrdinances).then(function(e){if(A.userIsEndowed=!!e.endowmentDate,A.userRecommendType=e.recommend&&e.recommend.recommendType,A.userRecommendIsActive=e.recommend&&"ACTIVE"===e.recommend.status,A.shouldShowLivingOrdinances){s.initializeSloqData(e),A.isUnitSloqEnabled=e.isSloqEnabled,A.sloqEnabledOrdinances=e.activeOrdinances?e.activeOrdinances:[];var t=e.unit&&e.unit.executiveSecretary?e.unit.executiveSecretary:{positionAndName:"",phones:[{privacyLevel:"PUBLIC",value:" "}]};A.execSecretaryName=t.positionAndName;var n=t.phones.find(function(e){return"PUBLIC"===e.privacyLevel});A.execSecretaryPhone=n?n.value:" "}r.getExistingAppointments().then(function(e){var t=e.find(function(e){return e.appointmentType===a.LIVING_ENDOWMENT}),n=e.find(function(e){return e.appointmentType===a.LIVING_SEALING});A.userEndowmentIsScheduled=!(!t||!t.appointmentDateTime),A.userSealingIsScheduled=!(!n||!n.appointmentDateTime),A.alreadyScheduledEndowment=t,A.alreadyScheduledSealing=n,A.showSpinner=!1}).catch(function(){A.showSpinner=!1})})};A.$onInit=function(){e.$watch("$ctrl.templeOrgId",function(){A.templeOrgId&&(i.getAppointmentTypeOnlineSchedulingStatus(A.templeOrgId).then(function(e){if(e.forEach(function(e){switch(e.appointmentType){case a.LIVING_ENDOWMENT:case a.LIVING_SEALING:e.onlineSchedulingAvailable&&(A.livingOrdinancesEnabled=!0)}}),angular.isArray(e)){var o={LIVING_ENDOWMENT:0,LIVING_SEALING:1,PROXY_BAPTISM:2,PROXY_INITIATORY:3,PROXY_ENDOWMENT:4,PROXY_SEALING:5};e.sort(function(e,t){var n=e.appointmentType,i=t.appointmentType;return o[n]<o[i]?-1:o[i]<o[n]?1:0})}A.ordinanceOptions=e}),d.getTempleInfo().then(function(e){A.legalMarriagesAllowed=e.legalMarriagesIsAllowed}),i.getOrdinanceConfig(A.templeOrgId,a.LIVING_SEALING).then(function(e){A.preventLivingSealingEditsMinBefore=e.preventEditsMinBefore,A.minCutoffScheduleLivingSealing=e.minCutoffSchedule}))}),I()};var C=function(t){!A.legalMarriagesAllowed&&m.isSelectedSealingLicensedMarriage()?f.open(!0).result.then(function(e){e&&o.$broadcast("appointmentTypeChange",t,e)}):o.$broadcast("appointmentTypeChange",t)};A.isAlreadyScheduledLivingAppointment=function(e){return r.isLivingEndowment(e)?A.userEndowmentIsScheduled:!!r.isLivingSealing(e)&&1===m.getAllSealings().length&&A.userSealingIsScheduled},A.proceedAfterMultipleSealingModal=function(e){A.selectedOrdinanceType=e.appointmentType,s.livingSealingSelected(),C(e.appointmentType)},A.onOrdinanceClicked=function(e){e.onlineSchedulingAvailable&&e.isEnabledForUser&&(p.clearHoldData(!0),A.isAlreadyScheduledLivingAppointment(e.appointmentType)?A.handleAlreadyScheduledLivingOrdinance(e):A.proceedWithOrdinanceOption(e))},A.proceedWithOrdinanceOption=function(n){if(r.isLivingSealing(n.appointmentType)){if(A.showInvalidSloqOnlineWarning(n))return;m.clearSelectedSealing(),1<m.getAllSealings().length?g.open(!0).result.then(function(t){t&&"sealingSameTime"===t.modal?t.sealingTypeToConnect===S.CHILD_TO_PARENTS_SEALING?h.open(S.CHILD_TO_PARENTS_SEALING).result.then(function(){m.addChildrenToSelectedSealing()}).finally(function(){A.proceedAfterMultipleSealingModal(n)}):t.sealingTypeToConnect===S.WIFE_TO_HUSBAND_SEALING&&h.open(S.WIFE_TO_HUSBAND_SEALING).result.then(function(){m.setSelectedSealingAsHTWAndAddChildren()}).finally(function(){A.proceedAfterMultipleSealingModal(n)}):t&&"combineSealings"===t.modal&&t.scheduledSealing?A.shouldPreventLivingSealingEdits(t.scheduledSealing.scheduledAppointment).then(function(e){t.scheduledSealing.scheduledAppointment&&A.templeOrgId===t.scheduledSealing.scheduledAppointment.templeOrgId?T.open(t.scheduledSealing,e).result.then(function(){e||(S.CHILD_TO_PARENTS_SEALING===t.scheduledSealing.type?m.setSelectedSealingAsHTWAndAddChildren(t.scheduledSealing,!0):S.WIFE_TO_HUSBAND_SEALING===t.scheduledSealing.type&&m.addChildrenToSelectedSealing(t.scheduledSealing,!0)),A.proceedAfterMultipleSealingModal(n)},function(){e||A.proceedAfterMultipleSealingModal(n)}):A.proceedAfterMultipleSealingModal(n)}):A.proceedAfterMultipleSealingModal(n)}):A.handleSelectedSingleLivingSealing(n.appointmentType)}else A.selectedOrdinanceType=n.appointmentType,m.changeSelectedSealing(),o.$broadcast("appointmentTypeChange",n.appointmentType)},A.handleSelectedSingleLivingSealing=function(e){A.selectedOrdinanceType=e,m.changeSelectedSealing("FIRST"),C(e)},A.handleAlreadyScheduledLivingOrdinance=function(t){var n=t.appointmentType===a.LIVING_SEALING?A.alreadyScheduledSealing:A.alreadyScheduledEndowment,e=t.appointmentType===a.LIVING_SEALING?m.getAllSealings()[0]:null;v.open(n,e).result.then(function(){return i.getOrdinanceConfig(n.templeOrgId,n.appointmentType)}).then(function(e){return r.shouldPreventAppointmentEditsOrCancellationsPromise(n,e)}).then(function(e){if(e)y.open(n);else{if(r.shouldDisableEditsAndCancellations(n)||!r.userCanEditAppointment(n))return;t.appointmentType===a.LIVING_SEALING?A.handleSelectedSingleLivingSealing(t.appointmentType):A.editAppointment(n)}})},A.editAppointment=function(t){var n=t&&r.isLivingOrdinance(t.appointmentType);c.getUserInfo(n).then(function(e){if(n)return s.initializeSloqData(e)}).then(function(){return b.getSession(t.appointmentType,t.appointmentTimeId,t.templeOrgId)}).then(function(e){m.changeSealingForAppointmentEdit(t),u.go("schedule.edit",{appointment:t,selectedDate:t.appointmentDateTime?new Date(t.appointmentDateTime):new Date,appointmentId:t.id,session:e,isEdit:!0})})},A.getOrdinanceSchedulingStatusOfAppointmentType=function(e){return e.onlineSchedulingAvailable?"":n.get("onlineSchedulingStatus.noOnlineScheduling")},A.getProxyOrdinances=function(){var e;return A.ordinanceOptions&&(e=A.ordinanceOptions.filter(function(e){return A.isProxyOrdinance(e.appointmentType)})).forEach(function(e){e.appointmentType===a.PROXY_BAPTISM?e.isEnabledForUser=A.userHasRecommend():e.isEnabledForUser=A.userHasRecommend()&&(A.userIsEndowed||A.userEndowmentIsScheduled)}),e},A.getLivingOrdinances=function(){var e;return A.ordinanceOptions&&(e=A.ordinanceOptions.filter(function(e){return A.isLivingOrdinance(e.appointmentType)}))&&A.sloqEnabledOrdinances&&e.forEach(function(t){A.sloqEnabledOrdinances.forEach(function(e){s.tosSloqAppointmentTypesEqual(t.appointmentType,e.ordinance.ordinanceType)&&(t.canSchedule=e.ordinance.canScheduleOrdinance&&!1!==e.userCanSchedule,t.isEnabledForUser=t.canSchedule)})}),e},A.isProxyOrdinance=function(e){return r.isProxyOrdinance(e)},A.isLivingOrdinance=function(e){return r.isLivingOrdinance(e)},A.shouldShowThisOrdinanceType=function(t){return(t.appointmentType!==a.LIVING_ENDOWMENT||!A.userIsEndowed)&&A.isUnitSloqEnabled&&A.sloqEnabledOrdinances&&A.sloqEnabledOrdinances.some(function(e){return e&&e.ordinance&&s.tosSloqAppointmentTypesEqual(t.appointmentType,e.ordinance.ordinanceType)})},A.sloqUserReady=function(e){return A.shouldShowThisOrdinanceType(e)&&"READY"===A.sloqStatus},A.unitIsSloqEnabledButUserNotReady=function(e){return A.isUnitSloqEnabled&&s.userHasStartedSloqProcess(e.appointmentType)&&!s.userIsSloqReady(e.appointmentType)},A.unitIsSloqEnabledButUserNotStarted=function(e){return s.isUnitSloqEnabled&&s.userHasNotStartedSloqProcess(e.appointmentType)},A.livingOrdinancesAllowed=function(){return A.livingOrdinancesEnabled&&A.isUnitSloqEnabled},A.shouldAllowOrdinanceTypeToBeScheduled=function(e){return(e.appointmentType!==a.LIVING_SEALING||!A.showInvalidSloqOnlineWarning(e))&&A.shouldShowThisOrdinanceType(e)&&e.canSchedule&&e.onlineSchedulingAvailable},A.userHasRecommend=function(){return"NONE"!==A.userRecommendType},A.getPopoverHtml=function(){return A.userHasRecommend()?A.userIsEndowed||A.userEndowmentIsScheduled?void 0:n.get("ordinanceSelector.userNotEndowedMessage"):n.get("ordinanceSelector.userRecommendInactiveMessage")},A.showLicensedMarriageWarning=function(e){return e.appointmentType===a.LIVING_SEALING&&!A.checkLicensedMarriageStatus()},A.showInvalidSloqOnlineWarning=function(e){return e.appointmentType===a.LIVING_SEALING&&(m.hasNonSloqParticipants()||m.hasInvalidSloqPatrons())},A.checkLicensedMarriageStatus=function(){return!m.hasLicensedMarriageSealing()||A.legalMarriagesAllowed},A.resolveSloqStatus=function(){if(A.isUnitSloqEnabled){if(Array.isArray(A.sloqEnabledOrdinances)&&0<A.sloqEnabledOrdinances.length){var t=!1;return A.sloqEnabledOrdinances.forEach(function(e){e.ordinance.canScheduleOrdinance&&(t=!0)}),t?"READY":"NOT_READY"}return"NOT_STARTED"}return"READY"},A.enableLivingOrdinances=function(){A.shouldShowLivingOrdinances=!0,A.showSpinner=!0,I()},A.getOrdinanceNotAllowedToScheduleLabel=function(e){if(a.LIVING_SEALING===e&&s.someSealingsReady(A.sloqEnabledOrdinances))return n.get("ordinanceSelector.sloq.ordinance.one.still.not.ready.body");var t=r.getAppointmentTypeLabel(e);return t?n.get("ordinanceSelector.sloq.ordinance.not.allowed.to.schedule.specific.ordinance",t):n.get("ordinanceSelector.sloq.ordinance.not.allowed.to.schedule")},A.shouldPreventLivingSealingEdits=function(o){return o&&(A.preventLivingSealingEditsMinBefore||A.minCutoffScheduleLivingSealing)?d.getCurrentTimeOfTempleByTempleOrgId(A.templeOrgId).then(function(e){var t=new Date(e.year,e.month-1,e.day,e.hour,e.minute),n=o.appointmentDateTime-t,i=Math.round(n/6e4);return A.preventLivingSealingEditsMinBefore&&i<A.preventLivingSealingEditsMinBefore||A.minCutoffScheduleLivingSealing&&i<A.minCutoffScheduleLivingSealing||!1}):new Promise(function(e){return e(!1)})}}]}),angular.module("tos-ui").component("appointmentDateSelector",{templateUrl:"/app/modules/components/session-selector/appointment-date-selector.html",bindings:{appointment:"<",selectedDate:"=",inclSelf:"=",inclSpouse:"=",templeOrgId:"<",appointmentType:"<",disableSessionSelection:"=",ordinanceConfig:"=",selectedDayOfCalendar:"=",hideSessionSpinner:"=",groupAppointmentsLoaded:"=",isEdit:"="},controller:["localizeDateTimeFilter","$timeout","$window","$rootScope","tisfTranslateService","tosTempleScheduleService","$log","AppointmentType","$scope","$locale","$q","tosTempleConfigService","tosDateService","$state","appointmentService","screenSizeService","tosScrollService","generalErrorModal","tosTempleInfoService","appointmentTypeService","Gender","sloqService",function(i,s,n,r,t,c,d,u,o,e,a,l,p,m,g,f,h,S,T,v,y,b){var A=this;A.AppointmentType=u;var I,C=new Date;T.getCurrentTempleTime(A.templeOrgId).then(function(e){I=e});var O=C.getMonth(),E=C.getFullYear(),$=C,L={},N={},M={},D={};r.schedulesLoadingOrLoaded={};var w=function(){!A.currentMonthAndYearText&&$&&(A.currentMonthAndYearText=i($,i.formatNames.monthLongYear))},P=function(){return A.templeOrgId&&A.appointmentType&&A.templeOrgId+"-"+A.appointmentType},G=function(e){var t,n=[],i=1,o=(t=e)&&t.month===O&&t.year===E?new Date(e.year,e.month,e.days[0].dayOfMonth):new Date(e.year,e.month,1);if(o)for(;i<=o.getDay();)n.push({}),i++;return n},k=function(t){G(t).forEach(function(e){t.days.unshift(e)})},_=function(e){var t=e.onlineApptWindow;return I?new Date(I.year,I.month+t,0,23,59,59,999):new Date(C.getFullYear(),C.getMonth()+t+1,0,23,59,59,999)},x=function(e,t){return t<=_(e)},F=function(e,t,n){if(e===n.month){k(n);var i=g.getMonthKey(e,t,n,A.inclSpouse,A.templeOrgId,A.appointmentType,A.gender);L[i]=n}},R=function(){var e=l.getOrdinanceConfig(A.templeOrgId,A.appointmentType),t=P();if(t){if(e)return M[t]=e,M[t].then(function(e){A.ordinanceConfig=e,D[t]=e}),M[t];d.warn("No ordinanceConfigPromise for ordinanceConfigKey",t)}},H=function(l){var s=P();d.info("getTempleScheduleForMonth: "+s),M[s]||(d.info("ordinanceConfigPromises not set for: "+s),R(),d.info("Done loading ordinanceConfigPromises  for: "+s));var p=a.defer();return M[s]?(d.info("Setting Then on promise: "+s),M[s].then(function(e){d.info("The promise of ordinanceConfigPromise Executing: "+s);var t=g.getMonthKey(l.getMonth(),l.getFullYear(),null,A.inclSpouse,A.templeOrgId,A.appointmentType,A.gender);if(x(e,l)){d.info("Getting schedulesForMonth: "+s);var n=g.isAGroupAppointment(A.appointment,A.appointment.details.guestCount,A.isEdit),i=u.LIVING_ENDOWMENT===A.appointment.appointmentType?g.getLivingPatronCountMap(A.appointment,A.appointment.contactInfo):g.getPatronCounts(A.appointment,A.appointment.contactInfo),o=i[y.MALE],a=i[y.FEMALE],r=g.isLivingSealing(A.appointment.appointmentType)?A.appointment.details.guestCount:0;N[t]=c.getTempleScheduleForMonth(l,A.templeOrgId,A.appointmentType,A.inclSelf,A.inclSpouse,o,a,r,n),N[t].then(function(e){e.isGroupAppointment=n,d.info("Resolving monthlySchedules: "+s),p.resolve(e)}).catch(function(e){d.error("There was an issue getting the temple's schedule.",e),A.hideSpinner=!0,A.hideSessionSpinner=!0,S.open(A.templeOrgId).result.then(function(){return m.go("landing")},function(){return m.go("landing")})})}else d.info("Calling defer.resolve(): "+s),p.resolve()})):(d.warn("No ordinance config for: "+s),p.resolve()),p.promise},U=function(e,t){if(p.isValidDate(A.selectedDate)){var n=e||A.selectedDate.getMonth(),i=t||A.selectedDate.getFullYear(),o=g.getMonthKey(n,i,null,A.inclSpouse,A.templeOrgId,A.appointmentType,A.gender);if(!r.schedulesLoadingOrLoaded[o]){r.schedulesLoadingOrLoaded[o]=!0;var a=new Date(A.selectedDate);a.setFullYear(i,n,A.selectedDate.getDate()),d.info("A calling getTempleScheduleForMonth: "+a),H(a).then(function(e){if(e){e.days.forEach(function(e){(e.dayOfMonth===a.getDate()||A.appointment&&A.appointment.appointmentDateTime&&A.appointment.appointmentDateTime.getDate&&A.appointment.appointmentDateTime.getDate()===e.dayOfMonth||A.appointment&&A.appointment.displayedAppointmentDate&&A.appointment.displayedAppointmentDate.getDate()===e.dayOfMonth)&&(A.selectedDayOfCalendar=e)}),F(a.getMonth(),a.getFullYear(),e),A.currentMonthSchedule=(n=a.getMonth(),i=a.getFullYear(),o=e,L[g.getMonthKey(n,i,o,A.inclSpouse,A.templeOrgId,A.appointmentType,A.gender)]);var t=g.getMonthKey(a.getMonth(),a.getFullYear(),null,A.inclSpouse,A.templeOrgId,A.appointmentType,A.gender);A.currentMonthSchedule&&(A.currentMonthAndYearText=null,$=A.selectedDate,A.groupAppointmentsLoaded=e.isGroupAppointment,A.hideSpinner=!0,r.schedulesLoadingOrLoaded[t]=!1)}var n,i,o})}}},V=function(){var e=P();e?(M[e]||R(),M[e].then(function(e){var t=_(e);A.hideNextMonthArrow=!x(e,$)||$&&t.getFullYear()===$.getFullYear()&&t.getMonth()===$.getMonth()})):A.hideNextMonthArrow=!1};A.$onInit=function(){if("schedule.edit"===m.current.name)var e=o.$watch("$ctrl.appointment",function(){A.appointment&&A.appointment.details&&A.appointment.details.guestCount&&(e(),A.groupAppointmentsLoaded=g.isAGroupAppointment(A.appointment),A.selectedDate=p.getSlcDateTime(A.appointment.appointmentDateTime),$=A.selectedDate,w(),A.appointmentType=A.appointment.appointmentType,d.info("Calling B loadNeededSchedulesForCalendar"),U())});o.$watch("$ctrl.selectedDate",function(){p.isValidDate(A.selectedDate)&&(r.currentDateString=i(A.selectedDate,i.formatNames.date),$||($=new Date(A.selectedDate),A.appointmentType&&(d.info("Calling C loadNeededSchedulesForCalendar"),U()),w()))}),Array.prototype.diff=function(t){return this.filter(function(e){return t.indexOf(e)<0})},o.$watch("$ctrl.inclSpouse",function(){A.appointmentType===u.PROXY_INITIATORY&&(r.schedulesLoadingOrLoaded={},L={},N={},A.currentMonthSchedule=null,$=A.selectedDate,w())}),o.$watch("$ctrl.appointmentType",function(){$||($=C),A.isLivingOrdinance=g.isLivingOrdinance(A.appointmentType),A.isLivingOrdinance&&"schedule.edit"!==m.current.name&&(A.selectedDate=b.getEarliestScheduleDate(A.appointmentType)),A.openCalendar=!1,A.appointmentType&&p.isValidDate(A.selectedDate)?(d.info("Calling E loadNeededSchedulesForCalendar"),U()):(A.selectedDate=null,A.currentMonthSchedule=null,A.hideSpinner=!1,L={},A.currentMonthAndYearText=null,$=null,r.schedulesLoadingOrLoaded={})}),A.daysOfTheWeek=[t.get("selectAppointmentDate.sundayShort"),t.get("selectAppointmentDate.mondayShort"),t.get("selectAppointmentDate.tuesdayShort"),t.get("selectAppointmentDate.wednesdayShort"),t.get("selectAppointmentDate.thursdayShort"),t.get("selectAppointmentDate.fridayShort"),t.get("selectAppointmentDate.saturdayShort")],r.currentDateString=i(C,i.formatNames.date),o.$watch("$ctrl.openCalendar",function(){if(A.openCalendar){var e=A.currentMonthSchedule?A.currentMonthSchedule.month:null,t=A.currentMonthSchedule?A.currentMonthSchedule.year:null;A.currentMonthSchedule=null,d.info("Calling A loadNeededSchedulesForCalendar monthToRequest: "+e+" yearToRequest: "+t),U(e,t),V()}})},A.selectAppointmentDate=function(e){var t=angular.isNumber(e)?e:e.dayOfMonth,n=new Date(A.currentMonthSchedule.year,A.currentMonthSchedule.month,t);A.isLivingOrdinance&&!b.isValidScheduleDate(A.appointmentType,n)||(A.selectedDayOfCalendar=e,A.openCalendar=!1,A.selectedDate=n,r.currentDateString=i(A.selectedDate,i.formatNames.date),h.scrollToElement("session-selector"))},A.isSelectedDay=function(e){return!!(e&&e.dayOfMonth&&A.selectedDate&&A.currentMonthSchedule&&A.selectedDayOfCalendar)&&e.dayOfMonth===A.selectedDayOfCalendar.dayOfMonth&&A.currentMonthSchedule.month===A.selectedDate.getMonth()};var W=function e(t){if(t.target){if("secondSelect"===t.target.id||t.target.closest("#secondSelect")||"svg"===t.target.tagName&&"calendar-graphic"===t.target.getAttribute("class"))return;!t.target.closest("#calendar-element")&&A.openCalendar&&(A.openCalendar=!1,s(function(){n.document.removeEventListener("click",e)}))}};A.toggleCalendarOpen=function(){A.openCalendar=!A.openCalendar,A.currentMonthSchedule=null,A.currentMonthAndYearText=null,$=A.selectedDate||C;var e=200+f.calculateWindowHeight();f.communicateHeightChange(e);var t=n.innerWidth<=600;A.openCalendar&&t||A.openCalendar&&A.appointmentType!==u.PROXY_BAPTISM?(n.document.addEventListener("click",W),h.scrollToElement("my-temple-appointments-link")):A.openCalendar&&h.scrollToElement("numberOfMalesToHelpWithBaptisms")},A.templeOpenNoApptsAvail=function(e){return!(!e||e.ordinanceAvailable||!e.templeOpen||A.isVisiblePastDay(e))},A.templeOpenApptsAvail=function(e){return!(!e||!e.ordinanceAvailable||A.isVisiblePastDay(e))},A.isVisiblePastDay=function(e){if(!e||!$)return!1;if(!e.templeOpen)return!0;var t=new Date($);return t.setDate(e.dayOfMonth),t<C.setHours(0,0,0,0)||A.isLivingOrdinance&&!b.isValidScheduleDate(A.appointmentType,t)},A.isHiddenPastDay=function(e){return e&&!e.dayOfMonth},A.getCurrentMonthAndYearText=function(){return w(),A.currentMonthAndYearText},A.shouldShowPreviousMonthButton=function(){return A.currentMonthSchedule&&(A.currentMonthSchedule.month>O||A.currentMonthSchedule.year>E)};var B=function(){var e=n.document.getElementsByClassName("calendar-month-button");Array.prototype.forEach.call(e,function(e){e.blur()})},q=function(e,t){$=t,A.currentMonthSchedule=e,A.currentMonthSchedule&&!A.hideSpinner&&(A.hideSpinner=!0),A.currentMonthAndYearText=null,s(function(){B()},100)};function z(e){return e.addSpouse===A.inclSpouse&&e.appointmentType===A.appointmentType}A.goToNextMonth=function(){var e,t,n=(e=$,(t=new Date(e.getFullYear(),e.getMonth(),2)).setMonth(t.getMonth()+1),t),i=g.getMonthKey(n.getMonth(),n.getFullYear(),null,A.inclSpouse,A.templeOrgId,A.appointmentType,A.gender);A.currentMonthSchedule=null,A.currentMonthSchedule&&A.hideSpinner&&(A.hideSpinner=!1),d.info("B calling getTempleScheduleForMonth: "+n);var o=H(n);(N[i]=o).then(function(e){var t;z(e)&&((t=e)&&F(t.month,t.year,t),q(e,n),V())})},A.goToPreviousMonth=function(){A.hideNextMonthArrow=!1,A.hideSpinner=!1;var e,t,n=0===A.currentMonthSchedule.month?11:A.currentMonthSchedule.month-1,i=A.currentMonthSchedule.year-1;if(O<=n||E<=i){var o=(e=$,(t=new Date(e.getFullYear(),e.getMonth(),2)).setMonth(t.getMonth()-1),t);if(!A.shouldShowPreviousMonthButton())return void d.warn("Unable to navigate to month in the past");var a=g.getMonthKey(o.getMonth(),o.getFullYear(),null,A.inclSpouse,A.templeOrgId,A.appointmentType,A.gender),r=L[a];if(r)$=o,A.currentMonthSchedule=r,A.currentMonthAndYearText=null,A.currentMonthSchedule&&!A.hideSpinner&&(A.hideSpinner=!0),s(function(){B()},100);else{d.info("C calling getTempleScheduleForMonth: "+o);var l=H(o);(N[a]=l).then(function(e){z(e)&&(A.currentMonthSchedule=null,A.currentMonthAndYearText=null,q(e,o),k(e))})}}},A.getCalendarDayTitleText=function(e){if(!e||!e.dayOfMonth||A.isHiddenPastDay(e))return"";var t=new Date(A.currentMonthSchedule.year,A.currentMonthSchedule.month,e.dayOfMonth);return i(t,"date")},A.appointmentTypeAllowsGroups=function(){return v.appointmentTypeAllowsGroups(A.appointmentType)},A.reloadAppointmentTimes=function(){return r.reloadAppointmentTimes},A.showCurrentDateString=function(){return r.reloadAppointmentTimes?t.get("selectDateLabel"):r.currentDateString},A.getAttendeeCount=function(){return A.appointmentType===u.LIVING_ENDOWMENT?A.appointment.patronList.length+A.appointment.additionalGuestCount:A.appointment.details.guestCount}}]}),angular.module("tos-ui").component("appointmentOptions",{templateUrl:"/app/modules/components/session-selector/appointment-options.html",bindings:{appointment:"=",disableSessionSelection:"=",inclSelf:"=",inclSpouse:"=",inclGuests:"=",selfGuest:"=",spouseGuest:"=",isEdit:"=",session:"=",sessionListForDate:"=",previousAppointmentTimeId:"=",proxyBaptismPatronCountPerAppointment:"="},controller:["AppointmentType","$scope","tosUserInfoService","appointmentService","tosTempleConfigService","appointmentTypeService","tisfTranslateService","$rootScope","tosHoldService","Gender","$state","tspPatron","tosTempleInfoService","tosLivingSealingService","sloqService","tosTempleScheduleService","guestCountValidatorService",function(f,t,e,h,n,s,i,S,o,T,p,v,a,y,r,l,c){var d,u,b=this;b.AppointmentType=f,b.tosLivingSealingService=y,b.spouseGuest=null,b.isEdit&&(b.disableElementWhileLoad=!0),b.initInclSelf=!0,b.initInclSpouse=!1,b.originalInclSelf=null,b.originalInclSpouse=null,b.originalAdditionalGuestCount=null,b.originalAdditionalMalePatronCount=null,b.originalAdditionalFemalePatronCount=null,b.originalMalePatronCount=null,b.originalFemalePatronCount=null,b.inclGuests=!1,b.ordinanceConfig=null,b.sessionIsFull=!1,b.languages=[],b.isLivingAppointment=!1;var m="validation.notEnoughSeatsToAddAdditionalAttendees",g="validation.notEnoughSeatsToAddAdditionalMaleAttendees",A="validation.notEnoughSeatsToAddAdditionalFemaleAttendees",I=function(){b.appointment.templeOrgId&&b.appointment.appointmentType&&(b.appointment.appointmentType===f.PROXY_BAPTISM&&(b.numberOfMalesToAssistTooltip=i.get("scheduleAppointment.info.baptizerMustBePriestOrElder"),b.numberOfEndowedMalesToAssist=i.get("scheduleAppointment.info.confirmationPriesthoodHolderHelp"),b.numberOfFemalesToAssistTooltip=i.get("scheduleAppointment.info.numberOfFemalesToAssist"),n.getProxyBaptismConfig(b.appointment.templeOrgId).then(function(e){b.ordinanceConfig=e,d=e.patronCountPerHour,u=e.maxOnlineGroupSize,b.restrictedCount=u})),n.getOrdinanceConfig(b.appointment.templeOrgId,b.appointment.appointmentType).then(function(e){b.appointment.appointmentType===f.PROXY_BAPTISM&&e.maxOverrideCapacity&&u>e.maxOverrideCapacity?(b.restrictedCount=e.maxOverrideCapacity,u=e.maxOverrideCapacity):b.appointment.appointmentType!==f.PROXY_BAPTISM&&(u=e.maxOverrideCapacity),b.ordinanceConfig=e}))},C=function(e){if("schedule.guest"!==p.current.name){if(h.isLivingOrdinance(b.appointment.appointmentType)){b.isLivingAppointment=!0;var t=b.appointment.details.guestCount;return"schedule.edit"!==p.current.name&&b.appointment.appointmentType!==f.LIVING_SEALING&&(b.inclSelf&&t--,b.spouseGuest&&t--),b.appointment.additionalGuestCount=t,b.originalAdditionalGuestCount=t,b.inclGuests=!!b.appointment.additionalGuestCount,void S.$broadcast("set_original_additional_guests",{originalAdditionalGuestCount:t})}var n=b.appointment.details.malePatronCount||0,i=b.appointment.details.femalePatronCount||0;b.inclSelf&&(e.gender===T.MALE?n&&0<n&&n--:i&&0<i&&i--),b.spouseGuest&&(b.spouseGuest.gender===T.MALE?n--:i--),b.appointment.additionalMaleGuestCount=n,b.appointment.additionalFemaleGuestCount=i,b.originalAdditionalMalePatronCount=n,b.originalAdditionalFemalePatronCount=i,S.$broadcast("set_original_additional_guests",{originalAdditionalMaleGuestCount:n,originalAdditionalFemaleGuestCount:i}),b.inclGuests=!(!b.appointment.additionalMaleGuestCount&&!b.appointment.additionalFemaleGuestCount)}else b.appointment.details.guestCount===b.appointment.guestList.length&&void 0===h.findMrnInGuestList(e.mrn,b.appointment.guestList)&&(h.isLivingOrdinance(b.appointment.appointmentType)?(b.isLivingAppointment=!0,b.appointment.details.guestCount++):e.gender===T.MALE?b.appointment.details.malePatronCount++:b.appointment.details.femalePatronCount++)};b.additionalGuestCountIsValid=function(e,t){if(null===e)return!0;var n=f.LIVING_ENDOWMENT===t?1:0;return angular.isNumber(e)&&n<=e&&b.ordinanceConfig&&(t===f.LIVING_SEALING||t!==f.LIVING_SEALING&&e<=b.ordinanceConfig.maxNumberOfGuests)};var O=function(){return!b.inclSpouse&&!b.inclSelf||(f.PROXY_BAPTISM===b.appointment.appointmentType?h.countPatronsToParticipateInGroupOrdinance(b.appointment.details.femalePatronCount,b.appointment.details.malePatronCount)<=0||S.patronCountExceedsMaxGroupSize:!(!b.inclGuests||(h.isLivingOrdinance(b.appointment.appointmentType)?(b.isLivingAppointment=!0,b.additionalGuestCountIsValid(b.appointment.additionalGuestCount,b.appointment.appointmentType)):(b.isLivingAppointment=!1,b.additionalGuestCountIsValid(b.appointment.additionalFemaleGuestCount+b.appointment.additionalMaleGuestCount,b.appointment.appointmentType)))))},E=function(e){return e&&e.spouseInfo&&!e.spouseInfo.deathDate&&(e.spouseInfo.confirmationDate||e.spouseInfo.endowmentDate)},$=function(){e.getUserInfo(b.isLivingAppointment).then(function(e){return e&&(!b.isLivingAppointment&&b.appointment.contactInfo||(b.appointment.contactInfo=_objectSpread({},e),b.appointment.details&&(b.appointment.contactInfo.email=b.appointment.details.contactEmail||b.appointment.contactInfo.email,b.appointment.contactInfo.name=b.appointment.details.contactName||b.appointment.contactInfo.name,b.isEdit&&!b.appointment.details.groupName&&b.appointment.appointmentType!==f.LIVING_SEALING&&(b.appointment.details.groupName=b.appointment.contactInfo.name),b.appointment.contactInfo.phone=b.appointment.details.contactInfo||b.appointment.contactInfo.phone)),b.appointment.contactInfo.gender||(b.appointment.contactInfo.gender=e.gender)),e}).then(function(e){b.appointment.guestList=b.appointment.guestList||[],b.appointment.patronList=b.appointment.patronList||[];var t="schedule.guest"===p.current.name;return b.selfGuest=!t&&h.findMrnInGuestList(e.mrn,b.appointment.guestList),b.spouseGuest=!t&&E(e)&&h.findSpouseInGuestList(e,b.appointment.guestList),b.isEdit?b.appointment.appointmentType===f.LIVING_ENDOWMENT||b.appointment.appointmentType===f.LIVING_SEALING?b.inclSelf=!0:b.inclSelf=!!b.selfGuest:b.inclSelf=!0,b.inclSpouse=!!b.spouseGuest,b.appointmentTypeAllowsGroups()&&C(e),e}).then(function(l){return t.$on("appointmentTypeChange",function(){b.setupInclSelfWithInfo(b.inclSelf,b.inclSelf)}),t.$watch("$ctrl.inclSpouse",function(e,t){if((e!==t||b.initInclSpouse)&&"schedule.guest"!==p.current.name){b.initInclSpouse=!1,null===b.originalInclSpouse&&(b.originalInclSpouse=e);var n=e,i=b.appointment.guestList.findIndex(function(e){return e.guestMrn===l.spouseInfo.mrn}),o=0<=i;n&&!o?(b.spouseGuest=E(l)&&(b.spouseGuest||{guestMrn:l.spouseInfo.mrn,name:l.spouseInfo.name,gender:l.spouseInfo.gender,email:l.spouseInfo.email,contactInfo:l.spouseInfo.phone}),b.appointment.guestList.push(b.spouseGuest)):!n&&o&&(b.appointment.guestList[i].id?b.appointment.guestList[i].appointmentGuestAction="REMOVE":b.appointment.guestList.splice(i,1)),b.spouseGuest&&t&&!e&&(T.MALE===b.spouseGuest.gender&&0<b.appointment.details.malePatronCount?b.appointment.details.malePatronCount--:T.FEMALE===b.spouseGuest.gender&&0<b.appointment.details.femalePatronCount&&b.appointment.details.femalePatronCount--);var a=new Date(S.currentDateString).getMonth(),r=new Date(S.currentDateString).getFullYear();S.schedulesLoadingOrLoaded[h.getMonthKey(a,r,null,b.inclSpouse,b.appointment.templeOrgId,b.appointment.appointmentType)]=!1,b.handleGroupPatronCountChange()}}),t.$watch("$ctrl.inclSelf",function(e,t){(e!==t||b.initInclSelf)&&"schedule.guest"!==p.current.name&&b.appointment.appointmentType&&b.setupInclSelfWithInfo(e,t)}),t.$watch("$ctrl.inclGuests",function(e){"schedule.guest"!==p.current.name&&((b.appointment.inclGuests=e)||(S.patronCountExceedsMaxGroupSize=!1,b.appointment.additionalMaleGuestCount=0,b.appointment.additionalFemaleGuestCount=0),b.handleGroupPatronCountChange())}),t.$watch("$ctrl.session",function(){b.isEdit&&b.appointment&&b.session&&(b.checkSessionIsFull(),b.disableElementWhileLoad=!1)}),l})},L=function(){f.LIVING_ENDOWMENT===b.appointment.appointmentType&&(b.appointment.inclEscort=!0,b.appointment.details.needsTempleEscort=b.appointment.details.needsTempleEscort||!1)},N=function(){b.appointment.appointmentType===f.PROXY_ENDOWMENT||b.appointment.appointmentType===f.LIVING_ENDOWMENT?a.getEndowmentAvLanguages().then(function(e){b.languages=e}):a.getOrdinanceCardsLanguages().then(function(e){b.languages=e})};b.$onInit=function(){var e=t.$watch("$ctrl.appointment",function(){b.appointment&&(e(),t.$on("appointmentTypeChange",function(e,t,n){if(b.appointment.appointmentType=t,b.appointment.invalidateCivilMarriageFlag=n,h.isLivingOrdinance(t)&&(b.isLivingAppointment=!0,r.assignSloqOrdIds(b.appointment,t),$(),L(),t===f.LIVING_SEALING)){var i=y.getSelectedSealing();i&&(b.appointment.details.sealingType=i.sealingType)}b.handleGroupPatronCountChange(),N()}),t.$watch("$ctrl.appointment.appointmentType",I),t.$watch("$ctrl.appointment.details.femalePatronCount",b.handleGroupPatronCountChange),t.$watch("$ctrl.appointment.details.malePatronCount",b.handleGroupPatronCountChange),t.$watch("$ctrl.appointment.additionalFemaleGuestCount",b.handleGroupPatronCountChange),t.$watch("$ctrl.appointment.additionalMaleGuestCount",b.handleGroupPatronCountChange),t.$watch("$ctrl.appointment.additionalGuestCount",b.handleGroupPatronCountChange),N(),L(),t.$watch("$ctrl.inclGuests",function(e){"schedule.guest"!==p.current.name&&((b.appointment.inclGuests=e)||b.isEdit?b.appointment.contactInfo&&!b.appointment.details.groupName&&b.appointment.appointmentType!==f.LIVING_SEALING&&(b.appointment.details.groupName=b.appointment.contactInfo.name):(S.patronCountExceedsMaxGroupSize=!1,b.appointment.additionalMaleGuestCount=0,b.appointment.additionalFemaleGuestCount=0,b.appointment.additionalGuestCount=0,b.appointment.details.groupName=null),b.handleGroupPatronCountChange())}),b.isEdit&&(b.appointment.appointmentType===f.LIVING_SEALING&&(b.isLivingAppointment=!0,t.$watch("$ctrl.tosLivingSealingService.parsedLivingSealings",function(e){e&&angular.isArray(e)&&y.changeSealingForAppointmentEdit(b.appointment)},!0),l.getSessionList(b.appointment.appointmentDateTime,b.appointment.appointmentType,b.appointment.templeOrgId).then(function(e){var t=e.sessionList.find(function(e){return e.sealingRoomId===b.appointment.details.locationId&&e.appointmentTimeId===b.appointment.appointmentTimeId});t&&(b.appointment.livingSealingSeatCount=t.sealingRoomSeats)})),h.isLivingOrdinance(b.appointment.appointmentType)&&C(),b.originalAppointment=angular.copy(b.appointment),b.originalMalePatronCount=b.appointment.details.malePatronCount,b.originalFemalePatronCount=b.appointment.details.femalePatronCount,I()),b.noSeatsAvailable=i.get("tooltip.not.enough.seats"),b.addAdditionalPeopleHelpText=i.get("scheduleAppointment.addAdditionalPeopleHelpText"),$())})},b.setupInclSelfWithInfo=function(t,n){h.isLivingOrdinance(b.appointment.appointmentType)?(b.isLivingAppointment=!0,e.getUserInfo(b.isLivingAppointment).then(function(e){return b.setupInclSelf(t,n,e)})):b.setupInclSelf(t,n,b.appointment.contactInfo)},b.setupInclSelf=function(e,t,n){b.initInclSelf=!1,null===b.originalInclSelf&&(b.originalInclSelf=e);var i=null,o=n.unit?n.unit.unitNumber:"";if(f.LIVING_ENDOWMENT===b.appointment.appointmentType){b.isLivingAppointment=!0;var a=n.activeOrdinances.find(function(e){return"ENDOWMENT"===e.ordinance.ordinanceType});a&&a.ordinance&&a.ordinance.participants&&0<a.ordinance.participants.length&&(i=a.ordinance.participants[0].id,o=a.ordinance.participants[0].confidential&&a.ordinance.participants[0].confidential.person&&a.ordinance.participants[0].confidential.person.unit?a.ordinance.participants[0].confidential.person.unit.unitNumber:null)}else f.LIVING_SEALING===b.appointment.appointmentType&&(b.isLivingAppointment=!0,i=y.getOrdinanceId());var r=e,l=b.appointment.patronList.findIndex(function(e){return e.memberInfo.mrn===n.mrn}),s=b.appointment.guestList.findIndex(function(e){return e.guestMrn===n.mrn}),p=0<=l,c=0<=s;if(h.isLivingOrdinance(b.appointment.appointmentType))if(b.isLivingAppointment=!0,r&&!c&&(b.selfGuest=b.selfGuest||{guestMrn:n.mrn,name:n.name,gender:n.gender,email:n.email,contactInfo:n.phone}),r&&!p){var d=f.LIVING_ENDOWMENT===b.appointment.appointmentType?"PATRON":"CONTACT",u=v.create(d,n.gender,"STANDARD");u.gender=n.gender,u.email=n.email,u.personalPhone=n.phone,u.housePhone=n.householdPhone,u.address=n.address,u.memberInfo.mrn=n.mrn,u.primaryContact=!0,u.sloqOrdPersonId=i,u.memberInfo.unitNumber=o,u.memberInfo.wardName=n.unit?n.unit.name:"",u.memberInfo.wardNameLocal=n.unit?n.unit.localizedName:"",u.memberInfo.stakeName=n.unit?n.unit.parentUnit.name:"",u.memberInfo.stakeNameLocal=n.unit?n.unit.parentUnit.localizedName:"",b.appointment.patronList.push(u)}else!r&&p&&b.appointment.patronList.splice(l,1);else b.isLivingAppointment=!1,r&&!c&&b.appointment.appointmentType!==f.PROXY_BAPTISM?(b.selfGuest=b.selfGuest||{guestMrn:n.mrn,name:n.name,gender:n.gender,email:n.email,contactInfo:n.phone},b.appointment.guestList.push(b.selfGuest)):!r&&c&&b.appointment.guestList.splice(s,1);b.shouldShowAddToSpouseCheckbox()&&b.selfGuest&&e&&!b.appointment.details.malePatronCount&&!b.appointment.details.femalePatronCount?T.MALE===b.selfGuest.gender?b.appointment.details.malePatronCount=1:T.FEMALE===b.selfGuest.gender&&(b.appointment.details.femalePatronCount=1):b.selfGuest&&t&&!e&&(T.MALE===b.selfGuest.gender&&0<b.appointment.details.malePatronCount?b.appointment.details.malePatronCount--:T.FEMALE===b.selfGuest.gender&&0<b.appointment.details.femalePatronCount&&b.appointment.details.femalePatronCount--);var m=new Date(S.currentDateString).getMonth(),g=new Date(S.currentDateString).getFullYear();S.schedulesLoadingOrLoaded[h.getMonthKey(m,g,null,b.inclSpouse,b.appointment.templeOrgId,b.appointment.appointmentType)]=!1,b.handleGroupPatronCountChange()},b.shouldShowPrimaryContactCheckbox=function(){return s.appointmentTypeAllowsSelfToBeAdded(b.appointment.appointmentType)},b.shouldShowAddToSpouseCheckbox=function(){var e=!(!s.appointmentTypeAllowsSpouseToBeAdded(b.appointment.appointmentType)||!(b.spouseGuest||b.appointment.contactInfo&&b.appointment.contactInfo.spouseInfo&&E(b.appointment.contactInfo)));return e||(b.inclSelf=!0),e},b.calculateAppointmentLengthInMinutes=function(){return h.calculateAppointmentLengthInMinutes(d,h.determineFemalePatronCountForAppointment(b.appointment),h.determineMalePatronCountForAppointment(b.appointment))},b.handleBaptismPatronCountChange=function(){b.appointment.details.sessionLength=b.calculateAppointmentLengthInMinutes();var e=h.countPatronsToParticipateInGroupOrdinance(b.appointment.details.femalePatronCount,b.appointment.details.malePatronCount);S.patronCountExceedsMaxGroupSize=u<e,b.disableSessionSelection=O()},b.verifyAndSetHold=function(){if(b.isEdit)if(!b.sessionIsFull&&b.inclSpouse){var e=b.session;b.selectedSession&&(e=b.selectedSession),h.sessionIsAvailableForHold(b.appointment,e,b.inclSelf,b.selfGuest,b.inclSpouse,b.spouseGuest,b.isEdit).then(function(e){S.noRoomForSpouseError=!e||"SUCCESS"!==e.status,S.noRoomForSpouseError&&(b.inclSpouse=!1)})}else S.noRoomForSpouseError=!1,b.isEdit&&o.deleteSessionTimeHold(b.appointment.appointmentTimeId,b.appointment.contactInfo.uuid,!0)},b.handleGroupPatronCountChange=function(){if(b.appointment&&b.appointment.appointmentType===b.AppointmentType.LIVING_ENDOWMENT&&(b.appointment.additionalGuestCount=b.appointment.additionalGuestCount||1),b.appointment&&b.appointment.appointmentType===b.AppointmentType.LIVING_SEALING&&b.appointment.guestList&&0<b.appointment.guestList.length&&(b.appointment.additionalGuestCount=Math.max(b.appointment.additionalGuestCount||0,b.appointment.guestList.length)),b.appointment.appointmentType&&(b.selfGuest||b.spouseGuest||h.isLivingOrdinance(b.appointment.appointmentType)&&(b.inclSelf||b.inclSpouse))&&(b.appointment.details.guestCount=h.determineGuestCount(b.appointment,b.inclSelf,b.selfGuest,b.inclSpouse,b.spouseGuest,!1),b.appointment.appointmentType=b.getValidAppointmentTypeFromScope(),s.appointmentTypeAllowsGroups(b.appointment.appointmentType))){if(!h.isLivingOrdinance(b.appointment.appointmentType)){b.isLivingAppointment=!1;var e=h.calculateMaleAndFemalePatronCounts(b.appointment,b.inclSelf,b.selfGuest,b.inclSpouse,b.spouseGuest);b.appointment.details.malePatronCount=e.malePatronCount,b.appointment.details.femalePatronCount=e.femalePatronCount}S.patronCountExceedsMaxGroupSize=b.attendeeCountExceedsLimit(),f.LIVING_SEALING!==b.appointment.appointmentType&&function(){if(b.getNoAdditionalAttendeesMessageKey())if(h.isLivingOrdinance(b.appointment.appointmentType)){b.isLivingAppointment=!0;var e=b.appointment.details.guestCount,t=b.originalAppointment.details.guestCount;b.noAdditionalAttendeesMessageKey===m&&(b.noAdditionalAttendeesMessageKeyIsInErrorState=t<e)}else{b.isLivingAppointment=!1;var n=h.getPatronCounts(b.appointment,b.appointment.contactInfo),i=n[T.MALE],o=n[T.FEMALE],a=i+o,r=b.originalAppointment.details.malePatronCount,l=b.originalAppointment.details.femalePatronCount,s=r+l;b.noAdditionalAttendeesMessageKey===m?b.appointment.appointmentType===f.PROXY_INITIATORY?b.noAdditionalAttendeesMessageKeyIsInErrorState=s<a||r<i||l<o:b.noAdditionalAttendeesMessageKeyIsInErrorState=s<a:b.noAdditionalAttendeesMessageKey===g?b.noAdditionalAttendeesMessageKeyIsInErrorState=r<i:b.noAdditionalAttendeesMessageKey===A?b.noAdditionalAttendeesMessageKeyIsInErrorState=l<o:b.noAdditionalAttendeesMessageKeyIsInErrorState=!1}else b.noAdditionalAttendeesMessageKeyIsInErrorState=!1}(),b.disableSessionSelection=O()}},b.getValidAppointmentTypeFromScope=function(){return b.appointment&&b.appointment.appointmentType||b.ordinanceConfig&&b.ordinanceConfig.appointmentType},t.$on("sessionSelected",function(e,t){b.checkSessionIsFull(t,!0)}),b.checkSessionIsFull=function(e,t){var n=b.appointment.appointmentType===f.PROXY_BAPTISM,i=b.appointment.appointmentType===f.PROXY_SEALING,o=e||b.session,a=h.determineGuestCount(b.appointment,b.inclSelf,b.selfGuest,b.inclSpouse,b.spouseGuest,!0),r=h.getSessionSeatInfo(o,o.appointmentType,b.inclSelf,b.inclSpouse,b.appointment.contactInfo,a,i||n,b.sessionListForDate.findIndex(function(e){return e.appointmentTimeId===o.appointmentTimeId}),b.sessionListForDate,n?b.ordinanceConfig.appointmentLength:null,n?Math.floor(b.ordinanceConfig.patronCountPerHour*b.ordinanceConfig.appointmentLength/60):null,b.appointment);if(b.sessionIsFull=!r.valid,b.isEdit&&!b.disableElementWhileLoad){var l=function(e){if(!b.isEdit||!s.appointmentTypeAllowsGroups(b.appointment.appointmentType))return"";if(!(b.originalAppointment&&b.appointment&&b.originalAppointment.appointmentTimeId&&b.originalAppointment.appointmentTimeId===b.appointment.appointmentTimeId))return"";if(e.appointmentType===f.PROXY_INITIATORY){var t=0<e.details.femaleSeatsAvailable,n=0<e.details.maleSeatsAvailable;if(!t&&!n)return m;if(!t)return A;if(!n)return g}else if(h.determineSeatsAvailableInSession(e)<=0)return m;return""}(o);l!==b.noAdditionalAttendeesMessageKey&&(b.noAdditionalAttendeesMessageKey=l)}t?b.selectedSession=e:delete b.selectedSession},b.getMaxOnlineGroupSize=function(){return u},b.noPrimaryAttendeesAreAdded=function(){return!b.inclSelf&&!b.inclSpouse},b.appointmentTypeAllowsGroups=function(){return s.appointmentTypeAllowsGroups(b.appointment.appointmentType)},b.attendeeCountExceedsLimit=function(){return!!b.ordinanceConfig&&(h.isLivingOrdinance(b.appointment.appointmentType)?(b.isLivingAppointment=!0,!c.livingGuestCountIsValid(b,b.ordinanceConfig)):!c.proxyGuestCountIsValid(b,b.ordinanceConfig))},b.getNoAdditionalAttendeesMessageKey=function(){return b.noAdditionalAttendeesMessageKey},b.getGroupSeatReleaseCutoffTime=function(){if(!b.ordinanceConfig||!b.ordinanceConfig.groupSeatReleaseCutoffTime)return"";var e=b.ordinanceConfig.groupSeatReleaseCutoffTime,t="time.";e<72?t+="hours":e<168?(t+="days",e/=24):(t+=168===e?"week":"weeks",e/=168);var n=e+" "+i.get(t);return i.get("scheduleAppointment.seatConfirmed",[n])},b.getMaxGroupSize=function(){if(!b.ordinanceConfig)return"";if(f.PROXY_BAPTISM===b.ordinanceConfig.appointmentType)return b.getMaxOnlineGroupSize();var e=!!b.shouldShowAddToSpouseCheckbox();return(b.ordinanceConfig.maxNumberOfGuests||0)+1+e},b.getChildName=function(e){return y.getChildName(e)},b.getMaleAdultName=function(){return y.getMaleAdultName()},b.getFemaleAdultName=function(){return y.getFemaleAdultName()},b.shouldShowChildrenAndObservers=function(){return y.shouldShowChildrenAndObservers()},b.getChildrenForSealing=function(){return y.getChildrenForSealing()},b.getObserversForSealing=function(){return y.getObserversForSealing()},b.getSealingTypeMessage=function(){return y.getSealingTypeMessage()}}]}),angular.module("tos-ui").component("appointmentTimeSelector",{templateUrl:"/app/modules/components/session-selector/appointment-time-selector.html",bindings:{selectedDate:"<",selectedSession:"=",appointment:"=",sessionListForDate:"<",loadingTimes:"=",inclSelf:"<",inclSpouse:"<",languages:"<",disableSessionSelection:"=",ordinanceConfig:"<",templePhoneNumber:"<",selectedDayOfCalendar:"<",hideSessionSpinner:"=",previouslySelectedAppointmentTimeId:"<",previouslySelectedAppointmentSealingRoomId:"<",proxyBaptismPatronCountPerAppointment:"=",selfGuest:"<",spouseGuest:"<",groupAppointmentsLoaded:"<"},controller:["AppointmentType","$scope","appointmentService","tosTempleConfigService","$filter","appointmentTypeService","tosTempleInfoService","tosDateService","$state","$rootScope","scheduleLimitReachedModal","tosScrollService","tisfTranslateService","exceptionService","sloqService",function(p,e,c,t,d,n,o,f,a,i,r,l,s,u,m){var g,h,S,T=this;T.AppointmentType=p,T.hideSessionSpinner=!1,T.showAppointmentsForDay=!1,T.showEarliestScheduleDate=!1,T.disableAppointmentTime=!1,T.disabledSessions=[],T.closeAppointmentsForDay=function(){T.showAppointmentsForDay=!1},T.closeEarliestScheduleDate=function(){T.showEarliestScheduleDate=!1};var v=function(){return T.sessionListForDate&&0<T.sessionListForDate.length?T.sessionListForDate.filter(function(e,t){return!T.shouldHideSessionTime(e,t)}):[]},y=function(){T.displayNoSessionsAvailableMessage=T.sessionListForDate&&0===v().length&&!T.loadingTimes||T.selectedDayOfCalendar&&!T.selectedDayOfCalendar.templeOpen,T.displayNoSessionsForGroupSizeMessage=T.sessionListForDate&&0<T.sessionListForDate.length&&0===v().length&&!T.loadingTimes&&(T.appointment.appointmentType===p.PROXY_BAPTISM||T.appointment.appointmentType===p.PROXY_SEALING),T.displayCurrentAppointmentTime=T.appointment&&T.appointment.originalAppointmentDateTime&&T.selectedDate&&new Date(T.appointment.originalAppointmentDateTime).getDay()===T.selectedDate.getDay(),T.displayNoSessionsForGroupSizeMessage&&(T.displayNoSessionsAvailableMessage=!1)},b=function(){T.displayNoSessionsAvailableMessage=!1,T.displayCurrentAppointmentTime=!1,T.displayNoSessionsForGroupSizeMessage=!1,T.disabledSessions=[],T.sessionListForDate&&(T.hideNoGroupTimesMessage=!1,T.hideNoSessionsAvailableMessage=!1,T.sessionListToDisplay=T.sessionListForDate&&0!==T.sessionListForDate.length?v():[],y())},A=function(){null!==T.loadingTimes&&(T.loadingTimes=!T.sessionListForDate&&(T.appointment&&T.appointment.details&&!!T.appointment.details.malePatronCount&&0<T.appointment.details.malePatronCount||T.appointment&&T.appointment.details&&!!T.appointment.details.femalePatronCount&&0<T.appointment.details.femalePatronCount||T.appointment&&T.appointment.details&&T.appointment.details.guestCount&&0<T.appointment.details.guestCount)),b(),T.disabledSessions=[]},I=function(){c.clearExistingAppointmentsCache(),A()};T.$onInit=function(){var n;T.isEdit="schedule.edit"===a.current.name,n=e.$watch("$ctrl.selectedDayOfCalendar",function(e,t){e&&!t&&(A(),n())}),T.isEdit&&T.appointment&&(T.appointment.id=T.appointment&&T.appointment.id||a.router.urlRouter.location.split("/").pop(),T.appointmentStartTime=new Date(T.appointment.appointmentDateTime),T.appointment.details.sessionLength&&(T.appointmentEndTime=new Date(T.appointmentStartTime).setMinutes(T.appointmentStartTime.getMinutes()+T.appointment.details.sessionLength)),T.appointmentStartTime=T.appointmentStartTime.getTime()),e.$watch("$ctrl.appointment.templeOrgId",function(){T.appointment&&T.appointment.templeOrgId&&(t.getProxyBaptismConfig(T.appointment.templeOrgId).then(function(e){h=Math.floor(e.patronCountPerHour*e.appointmentLength/60),g=e.appointmentLength}),t.getOrdinanceConfig(T.appointment.templeOrgId,p.PROXY_SEALING).then(function(e){T.sealingOptimumCapacity=e?e.optimumCapacity:null}))}),e.$watch("$ctrl.selectedDate",function(e,t){e!==t&&T.selectedDate&&c.getAppointmentsForDate(T.selectedDate).then(function(e){e&&T.appointment&&(e=(e=e.filter(function(e){return e.id!==T.appointment.id})).filter(function(e){return!0===e.userInGuestList})),e&&0<e.length?(T.showAppointmentsForDay=!0,T.appointmentsForSelectedDay=e.map(function(e){var t,n=c.getCorrectAppointmentType(e),i=e&&e.appointmentType===p.PROXY_BAPTISM&&e.details?e.details.sessionLength:void 0;i&&0<i&&(t=f.addTimeToTimeString(e.appointmentTime,i));var o=f.getTimePartsFromTimeString(e.appointmentTime),a=t?f.getTimePartsFromTimeString(t):t,r=T.selectedDate.getFullYear(),l=T.selectedDate.getMonth(),s=T.selectedDate.getDate();return{appointmentType:n,appointmentTime:d("tosAppointmentTimeSpan")(new Date(r,l,s,o.hour,o.minutes)),appointmentEnd:t?d("tosAppointmentTimeSpan")(new Date(r,l,s,a.hour,a.minutes)):null}})):(T.appointmentsForSelectedDay=[],T.showAppointmentsForDay=!1)})}),e.$watch("$ctrl.appointment.inclSelf",I),e.$watch("$ctrl.appointment.inclSpouse",I),e.$watch("$ctrl.appointment.details.femalePatronCount",A),e.$watch("$ctrl.appointment.details.malePatronCount",A),e.$watch("$ctrl.appointment.additionalFemaleGuestCount",A),e.$watch("$ctrl.appointment.additionalMaleGuestCount",A),e.$watch("$ctrl.sessionListForDate",b),e.$watch("$ctrl.loadingTimes",function(){T.loadingTimes&&(T.displayNoSessionsAvailableMessage=!1,T.displayNoSessionsForGroupSizeMessage=!1,T.displayCurrentAppointmentTime=!1)}),e.$watch("$ctrl.appointment.appointmentType",function(e,t){var n,i;T.earliestScheduleDate=m.getEarliestScheduleDate(T.appointment.appointmentType),T.showEarliestScheduleDate=c.isLivingOrdinance(T.appointment.appointmentType),T.appointment.templeOrgId&&(T.selectedDayOfCalendar=void 0,o.getCurrentTimeOfTempleByTempleOrgId(T.appointment.templeOrgId).then(function(e){S=e})),i=t,!(n=e)||i||T.isEdit||"schedule.guest"===a.current.name||n!==p.LIVING_SEALING||o.getTempleInfo().then(function(e){e.primaryLanguages&&0<e.primaryLanguages.length?T.appointment.language=e.primaryLanguages[0]:T.appointment.language="ENGLISH"})})};var C=function(e){return!!(e.details&&null!==e.details.totalSeatsRemaining&&angular.isDefined(e.details.totalSeatsRemaining)&&T.sealingOptimumCapacity)&&!T.isEdit&&e.details.totalSeatsRemaining<T.sealingOptimumCapacity};T.shouldDisplaySessionList=function(){return!(!T.selectedDayOfCalendar||!T.selectedDayOfCalendar.templeOpen||T.reloadTimesForGroups())&&T.sessionListToDisplay&&0<T.sessionListToDisplay.length&&!T.loadingTimes},T.isPreviouslySelectedTime=function(e){return e.appointmentType===p.LIVING_SEALING?T.previouslySelectedAppointmentTimeId===e.appointmentTimeId&&T.previouslySelectedAppointmentSealingRoomId===e.ordinanceRoom.id:T.previouslySelectedAppointmentTimeId===e.appointmentTimeId},T.popoverEnabled=function(e){return(e.appointmentType===p.LIVING_SEALING||e.appointmentType===p.LIVING_ENDOWMENT)&&!m.isValidScheduleTime(e.appointmentType,e.time)},T.getPopoverHtml=function(){return m.userHasScheduledLivingSealing()?s.get("ordinanceSelector.livingEndowmentBeforeSealing"):s.get("ordinanceSelector.livingSealingAfterEndowment")};var O=function(e){return"NO_APPOINTMENTS_NEEDED"===e.scheduleSubType},E=function(e){return T.appointment.appointmentType===p.LIVING_SEALING?T.appointment.appointmentTimeId===e.appointmentTimeId&&T.appointment.details.locationId===e.sealingRoomId:T.appointment.appointmentTimeId===e.appointmentTimeId},$=function(e){if(!(e&&S&&T.groupAppointmentsLoaded&&T.ordinanceConfig&&T.ordinanceConfig.groupSeatReleaseCutoffTime))return!1;var t=new Date(e.time);if(e.endTime){var n=new Date(e.endTime);t=f.getDateWithCorrectTime(e.sessionEndTime,n)}else t=f.getDateWithCorrectTime(e.sessionTime,t);var i=t-new Date(S.year,S.month-1,S.day,S.hour,S.minute);return Math.round(i/6e4)<=60*T.ordinanceConfig.groupSeatReleaseCutoffTime};T.sessionIsSelectable=function(e,t){if(T.disableSessionSelection)return!1;if(T.requestingHoldTimeId&&T.requestingHoldTimeId===e.appointmentTimeId&&T.requestingHoldLocationId===e.sealingRoomId)return!1;if(e.appointmentType===p.LIVING_SEALING&&!m.isValidScheduleTime(e.appointmentType,e.time))return!1;if(e.appointmentType===p.LIVING_ENDOWMENT&&!m.isValidScheduleTime(e.appointmentType,e.time))return!1;if(T.appointment.id&&E(e))return!0;if(e.appointmentType===p.LIVING_SEALING&&e.livingSealingIsFull)return!1;if(e.appointmentType===p.LIVING_SEALING&&e.details&&C(e))return!1;if(e.appointmentType===p.LIVING_ENDOWMENT&&(n=e)&&n.details&&n.details.livingEndowmentAppointmentsCount&&T.ordinanceConfig.maxLivingApptsPerSession&&n.details.livingEndowmentAppointmentsCount>=T.ordinanceConfig.maxLivingApptsPerSession)return T.disabledSessions.push(e),!1;var n;if(O(e))return!1;if(T.checkForAppointmentTimeIsDisabled(e))return!1;if($(e))return T.disabledSessions.push(e),!1;var i=c.determineGuestCount(T.appointment,T.inclSelf,T.selfGuest,T.inclSpouse,T.spouseGuest,!0);return c.getSessionSeatInfo(e,T.appointment.appointmentType,T.inclSelf,T.inclSpouse,T.appointment.contactInfo,i,T.appointment.appointmentType===p.PROXY_SEALING||T.appointment.appointmentType===p.PROXY_BAPTISM,t,T.sessionListForDate,g,h,T.appointment).valid},T.getSessionTimeAndSchedulingType=function(e,t){var n=0,i=T.checkForAppointmentTimeIsDisabled(e);e.details&&!i&&(n=c.determineSeatsAvailableInSession(e)),e.details&&T.appointment.appointmentType===T.AppointmentType.LIVING_SEALING&&(n=e.sealingRoomSeats,i=e.livingSealingIsFull||e.details&&C(e));var o="";return e&&e.details&&(o=T.appointment.appointmentType===T.AppointmentType.PROXY_INITIATORY?s.get("selectAppointmentTime.male.female.seats.available",[Math.max(e.details.adjustedMaleCapacity-e.details.totalMalePatronCount,0),Math.max(e.details.adjustedFemaleCapacity-e.details.totalFemalePatronCount,0)]):d("tosSeatsAvailable")(n)),d("tosSessionTimeAndSchedulingType")(e,T.languages,T.inclSelf,T.inclSpouse,T.appointment.contactInfo,c.determineGuestCount(T.appointment,T.inclSelf,T.selfGuest,T.inclSpouse,T.spouseGuest,!0),t,T.sessionListForDate,g,h,o,i,T.appointment)};var L=function(a,e){var r=null;return e&&0<e.length&&e.forEach(function(e){if(!r){var t=T.inclSelf&&(e.inclSelf||e.userInGuestList||e.userIsScheduler),n=T.inclSpouse&&(e.inclSpouse||T.appointment&&c.findSpouseInGuestList(T.appointment.contactInfo,e.guestList));(t||n)&&(o=e,(i=a)&&o&&(o.displayedAppointmentDate||(o.displayedAppointmentDate=f.getSlcDateTime(o.appointmentDateTime)),c.appointmentsAreConflicting(i.appointmentType,i.time,o.appointmentType,o.displayedAppointmentDate)&&(!T.appointment.id||T.appointment.id!==o.id)))&&((r=e).userIncluded=t,r.spouseIncluded=!!n)}var i,o}),r},N=function(n){c.getExistingAppointments(T.inclSelf,T.inclSpouse).then(function(e){var t=L(n,e);t?c.handleConflictingAppointment(t,T.appointment.templeOrgId):(T.selectedSession=n,i.$broadcast("sessionSelected",n),l.scrollToElement("session-selector"))})};T.checkForAppointmentTimeIsDisabled=function(t){return-1!==T.disabledSessions.findIndex(function(e){return t.appointmentType===p.LIVING_SEALING&&e.appointmentType===p.LIVING_SEALING?e.appointmentTimeId===t.appointmentTimeId&&e.sealingRoomId===t.sealingRoomId:e.appointmentTimeId===t.appointmentTimeId})},T.determineNotEnoughSeatsMessageKey=function(e){return T.appointment.id&&T.appointment.appointmentTimeId===e.appointmentTimeId?"online.appointment.seat.count.change":$(e)?"online.appointment.group.cutoff":"online.appointment.seat.count.full"},T.removeSessionFromDisabledSessions=function(t){var e=T.disabledSessions.findIndex(function(e){return t.appointmentType===p.LIVING_SEALING&&e.appointmentType===p.LIVING_SEALING?e.appointmentTimeId===t.appointmentTimeId&&e.sealingRoomId===t.sealingRoomId:e.appointmentTimeId===t.appointmentTimeId});-1<e&&T.disabledSessions.splice(e,1)},T.onSessionClicked=function(t,e){if(T.sessionIsSelectable(t,e))return T.requestingHoldTimeId=t.appointmentTimeId,T.requestingHoldLocationId=t.sealingRoomId,c.sessionIsAvailableForHold(T.appointment,t,T.inclSelf,T.selfGuest,T.inclSpouse,T.spouseGuest,T.isEdit).then(function(e){if(e&&"SUCCESS"===e.status){if(!(T.isEdit||T.appointment&&"DETACHED"===T.appointment.appointmentStatus))return c.userCanScheduleAnotherAppointment({appointmentType:T.appointment.appointmentType,appointmentId:T.appointment.appointmentId,appointmentTimeId:t.appointmentTimeId,templeOrgId:T.appointment.templeOrgId,appointmentDateTime:new Date(t.time),userIsScheduler:!0,inclSelf:T.appointment.inclSelf,inclSpouse:T.appointment.inclSpouse}).then(function(){N(t)}).catch(function(e){return c.deleteSessionTimeHold(t.appointmentTimeId,T.appointment&&T.appointment.contactInfo&&T.appointment.contactInfo.uuid,!0),u.checkBasicValidationExceptions(e,T.appointment)});N(t)}else T.checkForAppointmentTimeIsDisabled(t)||T.disabledSessions.push(t)}).finally(function(){return T.requestingHoldTimeId=null})},T.shouldHideSessionTime=function(e){return!(!T.loadingTimes&&(E(e)||!function(e){if(T.ordinanceConfig&&null!==T.ordinanceConfig.minCutoffSchedule&&S){var t=f.getTimePartsFromTimeString(e.sessionEndTime)||f.getTimePartsFromTimeString(e.sessionTime),n=new Date(e.time);if(e.endTime){var i=new Date(e.endTime);n=f.getDateWithCorrectTime(e.sessionEndTime,i)}else n=f.getDateWithCorrectTime(e.sessionTime,n);var o=e.time.getMonth()+1,a=S.year===n.getFullYear(),r=S.month===o,l=S.day===n.getDate(),s=S.hour===t.hour,p=S.year>n.getFullYear(),c=a&&S.month>o,d=a&&r&&S.day>n.getDate(),u=a&&r&&l&&S.hour>t.hour,m=a&&r&&l&&s&&S.minute>=t.minutes;if(p||c||d||u||m)return!0;var g=n-new Date(S.year,S.month-1,S.day,S.hour,S.minute);return Math.round(g/6e4)<T.ordinanceConfig.minCutoffSchedule}return!1}(e)&&(O(e),1)))},T.thereAreNoPatronsForGroupOrdinance=function(){return n.appointmentTypeAllowsGroups(T.appointment.appointmentType)?c.determineGuestCount(T.appointment,T.inclSelf,T.selfGuest,T.inclSpouse,T.spouseGuest,!1):c.countPatronsToParticipateInGroupOrdinance(c.determineFemalePatronCountForAppointment(T.appointment),c.determineMalePatronCountForAppointment(T.appointment))<=0},T.hideSpinner=function(e){e&&(T.loadingTimes=null)},T.appointmentTypeAllowsGroups=function(){return n.appointmentTypeAllowsGroups(T.appointment.appointmentType)},T.showAppointmentTimesSection=function(){var e=T.appointmentTypeAllowsGroups(),t=T.thereAreNoPatronsForGroupOrdinance();return e||!e&&T.sessionListToDisplay&&!t},T.reloadTimesForGroups=function(){if(void 0===T.groupAppointmentsLoaded)return!1;var e=c.isAGroupAppointment(T.appointment,T.appointment.details.guestCount);return i.reloadAppointmentTimes=e!==T.groupAppointmentsLoaded,i.reloadAppointmentTimes}}]}),angular.module("tos-ui").component("currentAppointment",{templateUrl:"/app/modules/components/session-selector/current-appointment.html",bindings:{appointment:"=",isEdit:"="},controller:["localizeDateTimeFilter","tosDateService","$scope",function(n,i,e){var o=this;o.$onInit=function(){var t=e.$watch("$ctrl.appointment",function(){if(o.appointment){t();var e=i.getDateWithCorrectTime(o.appointment.appointmentTime,i.getSlcDateTime(new Date(o.appointment.appointmentDateTime)));o.appointmentDate=n(e,n.formatNames.date),o.appointmentTime=n(e,n.formatNames.time),o.showCurrentAppointment=o.isEdit&&o.appointment,o.appointmentType=o.appointment.appointmentType}})},e.$on("appointmentTypeChange",function(e,t){t&&t!==o.appointmentType?o.showCurrentAppointment=!1:o.appointment&&o.appointment.id&&t===o.appointmentType&&(o.showCurrentAppointment=!0)})}]}),angular.module("tos-ui").component("sessionSelector",{templateUrl:"/app/modules/components/session-selector/session-selector.html",bindings:{preselectionCompleted:"<",selectedSession:"=",inclSelf:"=",inclSpouse:"=",inclGuests:"=",appointment:"=",sessionsForSelectedDate:"=",previouslySelectedAppointmentTimeId:"<",previouslySelectedAppointmentSealingRoomId:"<",templePhoneNumber:"<",isShowing:"<",primaryLanguages:"="},controller:["tosTempleScheduleService","$scope","$timeout","generalErrorModal","AppointmentType","tosDateService","appointmentService","appointmentTypeService","tosCalendarService","tosTempleInfoService","$stateParams","$state","Gender","$log",function(a,e,t,r,l,s,p,c,n,i,o,d,u,m){var g=this;g.preselectionCompleted=null,g.selectedSession=null,g.isShowing=!1;var f=function(){g.sessionsForSelectedDate=null,s.isValidDate(g.selectedDate)&&g.sessionList&&(g.sessionList.length?(g.sessionList.forEach(function(e){if(e.time){var t=new Date(e.time);s.isValidDate(t)&&(g.sessionsForSelectedDate?g.sessionsForSelectedDate.push(e):g.sessionsForSelectedDate=[e])}}),g.sessionsForSelectedDate||(g.sessionsForSelectedDate=[])):g.sessionsForSelectedDate=[])},h="sessionSelectorContext",S=function(t,e){if((t=s.tryGetValidDate(t))&&g.appointment.appointmentType&&g.appointment.templeOrgId){var n=a.getSessionList[h]=a.getSessionList[h]||{},i=function(){return n.loadingTimesDate&&n.loadingTimesDate.getTime()===t.getTime()};if(n.updateSessionListForDay=n.updateSessionListForDay||e,g.appointment.appointmentType&&t.getTime()&&!i()){g.loadingTimes=!0,n.loadingTimesDate=new Date(t),g.disableSessionSelection=!c.appointmentTypeAllowsGroups(g.appointment.appointmentType)&&p.countPatronsToParticipateInGroupOrdinance(p.determineFemalePatronCountForAppointment(g.appointment),p.determineMalePatronCountForAppointment(g.appointment))<=0||!g.inclSelf&&!g.inclSpouse&&g.appointment.appointmentType!==l.PROXY_BAPTISM;var o=[];a.getSessionList(t,g.appointment.appointmentType,g.appointment.templeOrgId).then(function(e){i()&&(e=e||{},g.primaryLanguages=e.primaryLanguages,o=e.sessionList,g.sessionList=o,g.languages=e.languages,g.appointment&&g.appointment.appointmentTimeId&&o.forEach(function(e){e.appointmentTimeId===g.appointment.appointmentTimeId&&(g.appointment.appointmentDateTime=new Date(e.time),g.session=e)}),g.appointment.appointmentType!==l.PROXY_INITIATORY&&g.appointment.appointmentType!==l.PROXY_BAPTISM||(g.appointment.details||(g.appointment.details={}),g.appointment.details.sessionLength=e.blockSize),n.updateSessionListForDay&&g.sessionList&&f())}).catch(function(e){m.error("Unable to get sessions for date: "+t+" ordinance type: "+g.appointment.appointmentType+" temple org id: "+g.appointment.templeOrgId,e),g.disableSessionSelection=!0,g.loadingTimes=!1,r.open(g.appointment.templeOrgId).result.then(function(){return d.go("landing")},function(){return d.go("landing")})}).finally(function(){i()&&(g.loadingTimes=!1,n.loadingTimesDate=void 0,n.updateSessionListForDay=void 0)})}}},T=function(){if(!g.selectedDate&&"schedule.finalize"===d.current.name&&o.appointmentTypeId&&o.appointmentTimeId&&o.templeOrgId){var t=c.getValue(o.appointmentTypeId);a.getSession(t,o.appointmentTimeId,o.templeOrgId).then(function(e){e?g.selectedDate=new Date(e.time):(m.warn("determineSelectedDate: Unable to get session appointmentTypeId",t,"appointmentTimeId",o.appointmentTimeId,"templeOrgId",o.templeOrgId),g.hideSessionSpinner=!0)})}else i.getCurrentTempleTime().then(function(e){g.currentTempleTime=new Date,g.currentTempleTime.setFullYear(e.year),g.currentTempleTime.setMonth(e.month-1),g.currentTempleTime.setDate(e.day),g.currentTempleTime.setHours(e.hour),g.currentTempleTime.setMinutes(e.minute),g.selectedDate="schedule.edit"===d.current.name?g.appointment.displayedAppointmentDate:g.selectedSession&&g.selectedSession.time?new Date(g.selectedSession.time):g.selectedDate?new Date(g.selectedDate):g.currentTempleTime&&g.currentTempleTime.getTime()>Date.now()?new Date(g.currentTempleTime):new Date})};g.$onInit=function(){g.isEdit="schedule.edit"===d.current.name,g.selectedDate?S(g.selectedDate,!0):T(),e.$watch("$ctrl.selectedDate",function(e,t){null!==e&&e!==t&&S(g.selectedDate,!0)}),e.$watch("$ctrl.sessionList",function(){f()}),e.$watch("$ctrl.isShowing",function(){g.isShowing&&S(g.selectedDate,!0)}),e.$watch("$ctrl.appointment.appointmentType",function(){g.selectedDate||g.appointment.appointmentTimeId||T()}),g.appointment.appointmentTimeId&&g.appointment.appointmentType&&g.appointment.templeOrgId?a.getSession(g.appointment.appointmentType,g.appointment.appointmentTimeId,g.appointment.templeOrgId).then(function(e){g.selectedSession=e,T()},function(e){m.error("Error getting session from preselectAppointmentTimeId: "+g.appointment.appointmentTimeId,e)}).finally(function(){angular.isFunction(g.preselectionCompleted)&&t(g.preselectionCompleted,0,!1)}):T()}}]}),angular.module("tos-ui").component("tosAccordionHeader",{templateUrl:"/app/modules/components/tos-accordion-header/tos-accordion-header.html",bindings:{heading:"@",headerClick:"&",isOpen:"<",isCompleted:"<",canEditStep:"&?",createToEditMessage:"@?"},controller:function(){}}),angular.module("tos-ui").component("tosAccordion",{templateUrl:"/app/modules/components/tos-accordion/tos-accordion.html",bindings:{appointment:"<",temple:"<",currentStepId:"=currentStep",totalSteps:"="},controller:["$scope","generalErrorModal","sessionNotAvailableModal","tosAccordionService","tosTempleScheduleService","$timeout","$window","tosTempleInfoService","screenSizeService","localizeDateTimeFilter","tisfTranslateService","tosTempleNameFilter","tosAppointmentTypeFilter","tosAppointmentTypeGuestFilter","$state","conflictingAppointmentModal","conflictingAppointmentGuestModal","appointmentService","tosDateService","appointmentTypeService","scheduleLimitReachedModal","$anchorScroll","$location","templeSelectorModal","tosUserInfoService","AppointmentType","$log","$rootScope","sessionIsFullModal","exceptionService","guestAlreadyAddedModal",function(t,o,e,n,i,a,r,l,s,p,c,d,u,m,g,f,h,S,T,v,y,b,A,I,C,O,E,$,L,N,M){var D=this;D.step1Header=D.step1Title=c.get("scheduleAppointment.selectAnOrdinanceTitle"),D.step2Header=D.step2Title=c.get("scheduleAppointment.selectAppointmentTimeTitle"),D.step3Header=D.step3Title=c.get("scheduleAppointment.finalizeAppointmentTitle"),D.step1Id=1,D.step2Id=2,D.step3Id=3,D.session=void 0,D.isEdit=null,D.loadingSession=!1;var w=function(){g.go("landing")};D.scroll=function(){A.hash("templeSelector"),b()},D.loadTempleContacts=function(){D.appointment&&D.appointment.templeOrgId&&l.getTempleContacts(D.appointment.templeOrgId).then(function(e){D.selectedTemplesPhoneNumber=e.phoneNumber||" ",D.selectedTemplesOfficeEmail=e.officeEmail||" "})},D.$onInit=function(){D.isEdit="schedule.edit"===g.current.name,D.isGuest="schedule.guest"===g.current.name,(D.isEdit||D.isGuest)&&D.appointment&&D.appointment.appointmentDateTime&&(D.appointment.originalAppointmentDateTime||(D.appointment.originalAppointmentDateTime=new Date(D.appointment.appointmentDateTime),D.appointment.originalAppointmentTime=D.appointment.appointmentTime),D.appointment.displayedAppointmentDate=T.getSlcDateTime(D.appointment.appointmentDateTime)),D.isEdit&&D.isGuest||D.appointment.spouseOnly||(D.inclSelf=!0);var e=t.$watch("$ctrl.appointment",function(){D.appointment&&(e(),function(){if(D.loadingSession=!!D.appointment.appointmentTimeId,D.appointmentWithSelectedValues=_objectSpread({},D.appointment),!D.contactInfo){var e=S.isLivingOrdinance(D.appointment.appointmentType);C.getUserInfo(e).then(function(e){D.contactInfo=e,D.isGuest&&D.appointment&&(D.appointment.userIsScheduler||D.appointment.guestList.find(function(e){return e.guestMrn===D.contactInfo.mrn}))&&M.open(!0).result.then((w(),function(){}))})}}())});D.loadTempleContacts(),t.$watch("$ctrl.appointment.templeOrgId",function(e,t){e!==t&&(e?(D.appointmentWithSelectedValues.templeOrgId!==e&&(D.appointmentWithSelectedValues={templeOrgId:D.appointment.templeOrgId}),D.loadTempleContacts()):w(),D.goToCurrentStep())}),t.$watch("$ctrl.appointment.appointmentType",function(e,t){e!==t&&(e?D.appointmentWithSelectedValues.appointmentType!==e&&(D.appointmentWithSelectedValues.appointmentType=D.appointment.appointmentType,D.appointmentWithSelectedValues.appointmentDateTime=null,D.appointmentWithSelectedValues.appointmentTimeId=null):(D.appointment.appointmentDateTime=null,D.appointment.appointmentTimeId=null),D.goToCurrentStep())}),t.$watch("$ctrl.appointment.appointmentTimeId",function(e,t){e!==t&&(D.isEdit&&(D.currentStepId||null===D.appointment||null!==D.appointment.appointmentTimeId&&D.appointment.appointmentTimeId===e)||D.goToCurrentStep())}),t.$watch("$ctrl.session",function(e,t){if(null!==e&&e!==t&&D.session){var n=D.session&&new Date(D.session.time);D.session&&(n=T.getDateWithCorrectTime(D.session.sessionTime,D.session.time)),D.appointment.appointmentDateTime=n||D.appointment.appointmentDateTime,D.session&&(D.appointment.appointmentTime=D.session.sessionTime||D.appointment.appointmentTime),D.appointment.appointmentTimeId=D.session&&D.session.appointmentTimeId,e&&D.appointment.appointmentDateTime&&D.appointment.appointmentTimeId&&(D.appointmentWithSelectedValues.appointmentDateTime=D.appointment.appointmentDateTime,D.appointmentWithSelectedValues.appointmentTimeId=D.appointment.appointmentTimeId,D.appointment.appointmentType===O.LIVING_SEALING&&(D.session.ordinanceRoom?D.appointmentWithSelectedValues.sealingRoomId=D.session.ordinanceRoom.id:D.appointmentWithSelectedValues.sealingRoomId=D.appointment.details?D.appointment.details.locationId:null))}}),t.$watch("$ctrl.appointment.details.malePatronCount",function(e,t){e!==t&&(D.appointmentWithSelectedValues.details||(D.appointmentWithSelectedValues.details={}),D.appointmentWithSelectedValues.details.malePatronCount=D.appointment.details.malePatronCount)}),t.$watch("$ctrl.appointment.details.femalePatronCount",function(e,t){e!==t&&(D.appointmentWithSelectedValues.details||(D.appointmentWithSelectedValues.details={}),D.appointmentWithSelectedValues.details.femalePatronCount=D.appointment.details.femalePatronCount)}),t.$watch("$ctrl.appointment.appointmentDateTime",function(e,t){e!==t&&(D.appointment.displayedAppointmentDate=D.appointmentWithSelectedValues&&angular.isDate(D.appointmentWithSelectedValues.appointmentDateTime)?D.appointmentWithSelectedValues.appointmentDateTime:D.appointment.appointmentDateTime?T.getSlcDateTime(D.appointment.appointmentDateTime):T.getSlcDateTime(D.appointmentWithSelectedValues.appointmentDateTime)||new Date)}),t.$on("sessionSelected",function(e,t){!D.appointment.appointmentTimeId&&t&&(D.appointment.appointmentTimeId=t.appointmentTimeId),D.selectedDate&&!D.appointment.appointmentDateTime&&(D.appointment.appointmentDateTime=new Date(D.selectedDate.getTime())),t&&t.appointmentType===O.LIVING_SEALING&&(D.appointment.sealingRoomId=t.sealingRoomId,D.appointment.livingSealingSeatCount=t.sealingRoomSeats),D.goToCurrentStep()}),D.totalSteps=3,D.goToCurrentStep()};var P=function(){return S.determineGuestCount(D.appointment,D.inclSelf,D.contactInfo,D.inclSpouse,D.contactInfo&&D.contactInfo.spouseInfo,!0)};D.goToCurrentStep=function(){D.isGuest?D.currentStepId=D.step3Id:!D.appointment||D.appointment.templeOrgId||D.isEdit?D.appointment&&!D.appointment.appointmentType?D.currentStepId=D.step1Id:g.params&&g.params.skipToFinalStep||!(D.isEdit&&D.currentStepId!==D.step2Id||D.appointment&&!D.appointment.appointmentTimeId||!P()&&O.LIVING_SEALING!==D.appointment.appointmentType)?D.currentStepId=D.step3Id:D.currentStepId=D.step2Id:w()},D.checkExistingAppointments=function(){S.getExistingAppointments().then(function(e){var t,n=S.findConflictingAppointment(D.appointment,e);if(n&&D.appointment.id!==n.id)t=n,D.isGuest?h.open(t).result.then(function(){w()}).catch(function(e){E.error("Unknown modal error while trying to notify user of conflicting appointments.",e),o.open(D.appointment.templeOrgId)}):f.open(t).result.then(function(e){!0===e&&D.goToSelectATime()},function(){return w()}).catch(function(e){E.error("Unknown modal error while trying to notify user of conflicting appointments.",e),o.open(D.appointment.templeOrgId)});else if(!D.isGuest){var i=D.checkSeatAvailability();D.isEdit||i?l.getCurrentTimeOfTempleByTempleOrgId(D.appointment.templeOrgId).then(function(e){var t=e,n=new Date(t.year,t.month-1,t.day,t.hour,t.minute);T.getDateWithCorrectTime(D.appointment.appointmentTime,D.appointment.appointmentDateTime)<n&&(S.isAGroupAppointment(D.appointment,D.appointment.details.guestCount)&&!D.appointment.userIsScheduler?g.go("invitation",{templeOrgId:D.appointment.templeOrgId}):D.openSessionNotAvailableModal())}):"DETACHED"!==D.appointment.appointmentStatus&&null===i&&D.session?o.open().result.finally(function(){return w()}):S.isAGroupAppointment(D.appointment,D.appointment.details.guestCount)&&!D.appointment.userIsScheduler?L.open(!0,D.appointment).result.then((w(),function(){})):D.openSessionNotAvailableModal()}D.appointment.guestCanSchedule=!0,D.appointment.appointmentType=D.session&&D.session.appointmentType||D.appointment.appointmentType,D.appointment.templeOrgId=D.session&&D.session.templeOrgId||D.appointment.templeOrgId}).finally(function(){D.loadingSession=!1})},D.onSessionPreselectionCompleted=function(){D.appointment.templeOrgId&&D.appointment.appointmentType&&!g.params.isCombineSealing&&(!D.isEdit||D.isGuest?S.userCanScheduleAnotherAppointment(D.appointment).then(function(){D.checkExistingAppointments()}).catch(function(e){D.isGuest&&N.checkForValidationException(e.validationErrors,["IS_NOT_PROXY","PAST_APPOINTMENT","MIN_CUTOFF_SCHEDULE","IS_DELETED"])?g.go("invitation",{templeOrgId:D.appointment.templeOrgId}):D.isGuest&&N.checkForValidationException(e.validationErrors,["APPOINTMENT_TIME_NOT_ENOUGH_SEATS"])?L.open(!0,D.appointment).result.then((w(),function(){})):N.checkForValidationException(e.validationErrors,"MAX_APPOINTMENTS_SCHEDULED")?y.open(!0).result.then(function(){g.go("schedule",{appointment:{templeOrgId:D.appointment.templeOrgId}})},function(){return w()}):o.open().result.finally(function(){return w()})}):D.checkExistingAppointments())},D.checkSeatAvailability=function(){var e=D.isGuest&&D.appointment.guestList.length>=D.appointment.details.guestCount,t=!!D.session;return!D.session||D.isGuest&&!e||(t="PROXY_ENDOWMENT"===D.session.appointmentType||"LIVING_ENDOWMENT"===D.session.appointmentType?0<D.session.details.remainingOnlineSeatsAvailable:"PROXY_INITIATORY"===D.session.appointmentType?D.contactInfo&&"FEMALE"===D.contactInfo.gender&&0<D.session.details.femaleSeatsAvailable||D.contactInfo&&"MALE"===D.contactInfo.gender&&0<D.session.details.maleSeatsAvailable:S.getSessionSeatInfoForTheGroupPatronCount(D.session,1).valid),t},D.openSessionNotAvailableModal=function(){e.open(D.appointment)},D.goToSelectATime=n.goToSelectATime=function(){D.onHeaderClick(D.step2Id),g.go("schedule.session",{appointment:D.appointment,templeOrgId:D.appointment.templeOrgId,appointmentTypeId:v.getId(D.appointment.appointmentType),selectedDate:D.selectedDate})},D.onAppointmentNotAvailableWhenScheduling=function(){return D.openSessionNotAvailableModal()};var G=function(){D.appointment.appointmentType===O.PROXY_BAPTISM&&D.appointment&&D.appointment.details&&(D.appointment.details.endowedMaleCount&&delete D.appointment.details.endowedMaleCount,D.appointment.details.femalesToAssistCount&&delete D.appointment.details.femalesToAssistCount,D.appointment.details.malesToAssistCount&&delete D.appointment.details.malesToAssistCount,D.appointment.details.sessionLength&&delete D.appointment.details.sessionLength),D.appointment.appointmentType=null,D.sessionsForSelectedDate=null,D.appointment.guestList=[],D.appointment.inclSpouse=null,D.inclSpouse=!1,D.inclSelf=!0,D.inclGuests=!1,D.appointment.additionalMaleGuestCount=0,D.appointment.additionalFemaleGuestCount=0},k=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];D.selectedDate=new Date(D.appointment.appointmentDateTime),D.appointment.appointmentDateTime=null,D.appointment.appointmentTimeId=null,D.session=null,D.appointment&&D.appointment.details&&e&&(D.appointment.details.malePatronCount=0,D.appointment.details.femalePatronCount=0)},_=function(){!D.appointment.appointmentType&&D.appointmentWithSelectedValues.appointmentType&&(D.appointment.appointmentType=D.appointmentWithSelectedValues.appointmentType)},x=function(e){if(!D.appointmentWithSelectedValues)return!1;switch(e){case D.step1Id:return D.appointmentWithSelectedValues.templeOrgId&&!g.params.isCombineSealing;case D.step2Id:return D.appointmentWithSelectedValues.appointmentType&&!g.params.isCombineSealing;case D.step3Id:return D.appointmentWithSelectedValues.appointmentTimeId&&0<P()||g.params.isCombineSealing;default:return!1}};D.onHeaderClick=function(e){D.isEdit&&e===D.step3Id&&!D.canEditStep(e)||!D.isEdit&&!D.canEditStep(e)||D.isEdit&&e===D.step1Id||(D.isStepCompleted(e)||x(e))&&(e===D.step3Id?(_(),!D.appointment.appointmentDateTime&&!D.appointment.appointmentTimeId&&D.appointmentWithSelectedValues.appointmentDateTime&&D.appointmentWithSelectedValues.appointmentTimeId&&(D.appointment.appointmentDateTime=D.appointmentWithSelectedValues.appointmentDateTime,D.appointment.appointmentTimeId=D.appointmentWithSelectedValues.appointmentTimeId),D.appointment.details||(D.appointment.details={}),!D.appointment.details.malePatronCount&&D.appointment.details.femalePatronCount&&(D.appointment.details.malePatronCount=D.appointmentWithSelectedValues.details.malePatronCount,D.appointment.details.femalePatronCount=D.appointmentWithSelectedValues.details.femalePatronCount),D.goToCurrentStep()):e===D.step2Id?(k(),_(),D.goToCurrentStep()):e===D.step1Id&&(k(!0),G(),D.goToCurrentStep()))},D.isStepOpen=function(e){return D.currentStepId===e};var F=function(){return void 0!==$.patronCountExceedsMaxGroupSize&&null!==$.patronCountExceedsMaxGroupSize&&$.patronCountExceedsMaxGroupSize};D.canEditStep=function(e){return!D.isGuest&&(!D.isEdit&&x(e)&&!F()||D.isEdit&&D.currentStepId!==D.step1Id&&!F()||D.currentStepId===D.step1Id&&Date.parse(D.getHeading(D.step2Id)))&&!((t=e)&&t===D.step3Id&&D.appointment&&v.appointmentTypeAllowsGroups(D.appointment.appointmentType)&&!D.inclSelf&&!D.inclSpouse)&&!(e===D.step3Id&&$.reloadAppointmentTimes);var t},D.isStepCompleted=function(e){return e<D.currentStepId||function(e){switch(e){case D.step1Id:return D.appointmentWithSelectedValues&&D.appointmentWithSelectedValues.appointmentType;case D.step2Id:return D.appointmentWithSelectedValues&&D.appointmentWithSelectedValues.appointmentDateTime&&0<P();default:return!1}}(e)},D.getTranslatedHeading=function(){var e=D.appointment.appointmentType||D.appointmentWithSelectedValues.appointmentType;return(m(e)||c.get("scheduleAppointment.stepOne")+" "+D.step1Title)+(O.LIVING_ENDOWMENT===e?" ("+u(e)+")":"")},D.getHeading=function(e){if(!D.appointmentWithSelectedValues)return"";var t;switch(e){case D.step1Id:t=D.isGuest?D.getTranslatedHeading():u(D.appointment.appointmentType)||u(D.appointmentWithSelectedValues.appointmentType)||c.get("scheduleAppointment.stepOne")+" "+D.step1Title;break;case D.step2Id:var n=new Date(D.appointment.displayedAppointmentDate?D.appointment.displayedAppointmentDate:D.appointmentWithSelectedValues.appointmentDateTime?D.appointmentWithSelectedValues.appointmentDateTime:D.appointment.appointmentDateTime||new Date);(D.appointment&&D.appointment.appointmentDateTime||D.appointmentWithSelectedValues&&D.appointmentWithSelectedValues.appointmentDateTime)&&(n=T.getDateWithCorrectTime(D.appointment.appointmentTime,new Date(n))),t=n&&D.appointment.appointmentDateTime?p(n):c.get("scheduleAppointment.stepTwo")+" "+D.step2Title;break;case D.step3Id:t=c.get("scheduleAppointment.stepThree")+" "+D.step3Title;break;default:t="UNKNOWN STEP ID"}return t}}]}),angular.module("tos-ui").factory("tosAccordionService",function(){return new function(){}}),angular.module("tos-ui").component("tosCollapse",{templateUrl:"/app/modules/components/tos-collapse/tos-collapse.html",transclude:!0,bindings:{headingMessageKey:"@",open:"="},controller:function(){this.open=this.open||!1}}),angular.module("tos-ui").component("tosConfirmationBenefits",{templateUrl:"/app/modules/components/tos-confirmation-benefits/tos-confirmation-benefits.html",bindings:{},controller:function(){}}),angular.module("tos-ui").component("tosSuccessSnackBar",{templateUrl:"/app/modules/components/tos-snackbar/tos-success-snackbar.html",bindings:{snackbarText:"<"},controller:["$scope","snackbarService",function(e,t){var n=this;n.isOpen=!1,e.$on("showSnackbar",function(){n.isOpen&&t.addTransitionInProgress(),n.isOpen=!0}),e.$on("hideSnackbar",function(){n.isOpen=!1})}]}),angular.module("tos-ui").component("tosTooltip",{templateUrl:"/app/modules/components/tos-tooltip/tos-tooltip.html",bindings:{tooltipText:"<",tooltipLabel:"<",popoverClass:"<",popoverPosition:"<",tooltipPlacement:"<",iconType:"<",highlightText:"<"},controller:["$timeout","$scope","$window","$sce",function(t,e,n,i){var o=this;o.tooltipLabel=o.tooltipLabel||"",o.tooltipText=i.trustAsHtml(o.tooltipText),o.popoverIsOpen=!1,o.onClick=function(){var e=o.popoverIsOpen;t(function(){o.popoverIsOpen=!e},0)};var a=function(){o.popoverPlacement=n.innerWidth<348?"auto top-left":"auto top"};o.$onInit=function(){o.popoverPlacement="auto top","left"===o.tooltipPlacement&&(o.popoverClass+=" popover-left"),e.$watch("$ctrl.popoverIsOpen",a),angular.element(n).bind("resize",function(){o.popoverIsOpen=!1})}}]}),angular.module("tos-ui").component("whatCanISchedule",{templateUrl:"/app/modules/components/what-can-i-schedule/what-can-i-schedule.html",bindings:{appointmentTypesAndAvailability:"<"},controller:function(){var e=this;e.whatCanIScheduleSectionHeaderClicked=function(){e.whatCanIScheduleSectionIsOpen=!e.whatCanIScheduleSectionIsOpen}}}),angular.module("tos-ui").factory("alreadyScheduledModal",["$uibModal",function(n){return new function(){this.open=function(e,t){return n.open({size:"md",templateUrl:"/app/modules/common/modals/already-scheduled-modal/already-scheduled-modal.html",controller:"alreadyScheduledController",controllerAs:"$ctrl",resolve:{appointment:function(){return e},sealing:function(){return t}}})}}}]).controller("alreadyScheduledController",["appointment","sealing","AppointmentType","SealingType","appointmentService","$uibModalInstance","tosDateService","localizeDateTimeFilter","tisfTranslateService","tspPatronService","tosLivingSealingService","tosTempleConfigService","tosTempleInfoService",function(n,e,t,i,o,a,r,l,s,p,c,d,u){var m=this;m.appointment=n,m.sealing=e,m.notEditableLabel=s.get("myAppointments.notEditableLabel"),m.notEditableText=s.get("alreadyScheduledModal.notEditable.text"),m.$onInit=function(){d.getAppointmentTypeOnlineSchedulingStatus(m.appointment.templeOrgId).then(function(e){e.forEach(function(e){e.appointmentType===m.appointment.appointmentType&&(m.appointment.onlineSchedulingIsEnabledForOrdinance=e.onlineSchedulingAvailable)})}),(n&&n.templeOrgId?u.getTempleContacts(n.templeOrgId).then(function(e){return e&&e.phoneNumber?e.phoneNumber:""}):"").then(function(e){var t=e?'<br><a href="tel:"'+e+'">'+e+"</a>":"";m.notEditableText+=n&&n.templeOrgId?"<br><br>"+s.get("temple.name."+n.templeOrgId)+t:""})},m.getAppointmentType=function(){var e;return m.isLivingEndowment()?e=t.LIVING_ENDOWMENT:m.isLivingSealing()&&(e=m.appointment.details&&m.appointment.details.sealingType===i.PARENTS_SEALED?i.CHILD_TO_PARENTS_SEALING:i.WIFE_TO_HUSBAND_SEALING),s.get("appointmentType."+e)},m.getDescriptionPartTwo=function(){return s.get("alreadyScheduledModal.description.2",s.get("ordinanceType_".concat(m.appointment.appointmentType)))},m.getTranslatedDateAtTimeString=function(){var e=m.appointment.displayedAppointmentDate||r.getSlcDateTime(m.appointment.appointmentDateTime),t=l(e,"dateShort"),n=l(e,"time");return s.get("combineSealingsModal.description.date.at.time",[t,n])},m.isLivingEndowment=function(){return o.isLivingEndowment(m.appointment.appointmentType)},m.isLivingSealing=function(){return o.isLivingSealing(m.appointment.appointmentType)},m.isOpAppointment=function(){return o.isSloqAppt(m.appointment)},m.getEndowmentPatronName=function(){var e=null;if(m.appointment&&angular.isArray(m.appointment.patronList)&&0<m.appointment.patronList.length){var t=m.appointment.patronList[0];e=p.getPersonalName(t)}if(e&&angular.isString(e)||n.patrons&&0<n.patrons.length&&(e=n.patrons[0]),e&&angular.isString(e))return s.get("scheduleAppointment.endowment.patron",e)},m.getMaleAdultName=function(){return c.getMaleAdultName(m.sealing)},m.getFemaleAdultName=function(){return c.getFemaleAdultName(m.sealing)},m.isChildToParentSealing=function(){return c.isChildToParentSealing(m.sealing)},m.getChildrenForSealing=function(){return c.getChildren(m.sealing)},m.getObserversForSealing=function(){return c.getObservers(m.sealing)},m.shouldDisableEdits=function(){return o.shouldDisableEditsAndCancellations(m.appointment)||!o.userCanEditAppointment(m.appointment)}}]),angular.module("tos-ui").factory("combineSealingsModal",["$uibModal",function(n){return new function(){this.open=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n.open({size:"md",templateUrl:"/app/modules/common/modals/combine-sealings-modal/combine-sealings-modal.html",controller:"combineSealingsModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{scheduledSealing:e,isWarningModal:t}})}}}]).controller("combineSealingsModalController",["$uibModalInstance","$rootScope","scheduledSealing","SealingType","tosModalService","tisfTranslateService","isWarningModal","tosDateService","localizeDateTimeFilter","tosTempleInfoService","simpleModal","tosLivingSealingService",function(n,e,t,i,o,a,r,l,s,p,c,d){var u=this;u.scheduledSealing=t,u.isWarningModal=r,u.SealingType=i,u.$onInit=function(){p.getTempleContactInfo(t.scheduledAppointment.templeOrgId).then(function(e){if(e){var t=e.phones&&e.phones.find(function(e){return"Office"===e.phoneType});u.templePhone=t?t.phoneNumber:""}else u.templePhone=""}),u.buttons=r?[{id:"CONTINUE",content:a.get("buttons.continue"),type:c.Button.Type.PRIMARY,action:c.Button.Action.CLOSE}]:[{id:"YES",content:a.get("buttons.yes"),type:c.Button.Type.PRIMARY,action:c.Button.Action.CLOSE},{id:"NO",content:a.get("buttons.no"),type:c.Button.Type.SECONDARY,action:c.Button.Action.DISMISS}],e.$on("$locationChangeStart",function(){n.close()}),o.handleModalRender(n)},u.onButtonClick=function(e){var t=e.action.toLowerCase();(0,n[t])(e.id),o.handleModalRender(n)},u.getTranslatedSealingType=function(){var e=u.scheduledSealing.type===i.WIFE_TO_HUSBAND_SEALING?"toSpouse":"toChildren";return a.get("sealingSameTimeModal.".concat(e,".title"))},u.getTranslatedDateAtTimeString=function(){var e=u.scheduledSealing.scheduledAppointment,t=e.displayedAppointmentDate||l.getSlcDateTime(e.appointmentDateTime),n=s(t,"dateShort"),i=s(t,"time");return a.get("combineSealingsModal.description.date.at.time",[n,i])},u.getMaleAdultName=function(){return d.getMaleAdultName(u.scheduledSealing)},u.getFemaleAdultName=function(){return d.getFemaleAdultName(u.scheduledSealing)},u.getChildrenForSealing=function(){return d.getChildren(u.scheduledSealing)},u.getObserversForSealing=function(){return d.getObservers(u.scheduledSealing)},u.getChildName=function(e){return d.getChildName(e)},u.isChildToParentSealing=function(){return!!u.scheduledSealing&&(u.scheduledSealing.type===i.CHILD_TO_PARENTS_SEALING||u.scheduledSealing.addChildren)}}]),angular.module("tos-ui").factory("conflictingAppointmentGuestModal",["$uibModal",function(n){return new function(){this.open=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{spouseAndPatronAppointmentConflict:!1};return n.open({size:"md",templateUrl:"/app/modules/common/modals/conflicting-appointment-guest-modal/conflicting-appointment-guest-modal.html",controller:"conflictingAppointmentGuestModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{appointment:e,options:t}})}}}]).controller("conflictingAppointmentGuestModalController",["$uibModalInstance","appointment","options","$rootScope","$state","tosModalService","tosDateService","appointmentService",function(e,t,n,i,o,a,r,l){var s=this;s.appointment=t,s.spouseAndPatronAppointmentConflict=n.spouseAndPatronAppointmentConflict,s.dateToDisplay=t.displayedAppointmentDate||r.getSlcDateTime(s.appointment.appointmentDateTime),s.appointmentType=l.getCorrectAppointmentType(t),s.$onInit=function(){i.$on("$locationChangeStart",function(){e.close()}),a.handleModalRender(e)},s.goToLanding=function(){e.close(),o.go("landing")}}]),angular.module("tos-ui").factory("conflictingAppointmentModal",["$uibModal",function(n){return new function(){this.open=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{spouseAppointmentConflict:!1,spouseAndPatronAppointmentConflict:!1};return n.open({size:"md",templateUrl:"/app/modules/common/modals/conflicting-appointment-modal/conflicting-appointment-modal.html",controller:"conflictingAppointmentModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{appointment:e,options:t}})}}}]).controller("conflictingAppointmentModalController",["$uibModalInstance","appointment","options","$rootScope","tosModalService","appointmentService",function(e,t,n,i,o,a){var r=this;r.appointment=t,r.spouseAppointmentConflict=n.spouseAppointmentConflict||t.spouseIncluded,r.spouseAndPatronAppointmentConflict=n.spouseAndPatronAppointmentConflict,r.appointmentType=a.getCorrectAppointmentType(t),r.$onInit=function(){i.$on("$locationChangeStart",function(){e.close()}),o.handleModalRender(e)},r.goToSelectTime=function(){e.close(!0)}}]),angular.module("tos-ui").factory("contactInfoModal",["$uibModal",function(n){return new function(){this.open=function(e,t){return n.open({size:"md",templateUrl:"/app/modules/common/modals/contact-info-modal/contact-info-modal.html",windowClass:"contact-info-modal",controller:"contactInfoModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{contactInfo:e,shouldDisablePhoneField:t}})}}}]).controller("contactInfoModalController",["$uibModalInstance","$rootScope","contactInfo","shouldDisablePhoneField","tosModalService",function(e,t,n,i,o){var a=this;a.contactInfo=_objectSpread({},n),a.shouldDisablePhoneField=i,a.$onInit=function(){t.$on("$locationChangeStart",function(){e.close()}),o.handleModalRender(e)},a.save=function(){e.close(a.contactInfo)}}]),angular.module("tos-ui").factory("deleteAppointmentModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/delete-appointment-modal/delete-appointment-modal.html",controller:"deleteAppointmentModalController",controllerAs:"$ctrl",resolve:{appointment:e}})}}}]).controller("deleteAppointmentModalController",["$uibModalInstance","appointment","tosModalService","tosDateService","appointmentService",function(e,t,n,i,o){var a=this;a.appointment=t,a.dateToDisplay=i.getSlcDateTime(a.appointment.appointmentDateTime),a.$onInit=function(){n.handleModalRender(e)},a.deleteAppointment=function(){e.close(!0)},a.isAGroupAppointment=function(){return o.isAGroupAppointment(t)},a.getHeaderText=function(){return a.isAGroupAppointment()?"deleteAppointmentModal.group.appointment.title":"deleteAppointmentModal.title"},a.getDescription=function(){return a.isAGroupAppointment()?"deleteAppointmentModal.group.appointment.description":"deleteAppointmentModal.description"},a.getWarning=function(){return a.isAGroupAppointment()?"deleteAppointmentModal.group.appointment.warning":"deleteAppointmentModal.calendarWarning"},a.getButtonText=function(){return a.isAGroupAppointment()?"deleteAppointmentModal.group.appointment.title":"buttons.cancel.appt"}}]),angular.module("tos-ui").factory("deleteLivingAppointmentModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/delete-living-appointment-modal/delete-living-appointment-modal.html",controller:"deleteLivingAppointmentModalController",controllerAs:"$ctrl",resolve:{appointment:e}})}}}]).controller("deleteLivingAppointmentModalController",["$uibModalInstance","appointment","appointmentService","tosModalService",function(e,t,n,i){var o=this;o.appointment=t,o.editingEnabled=function(){return n.userCanEditAppointment(t)},o.$onInit=function(){i.handleModalRender(e)},o.editAppointment=function(){e.close(!1)},o.deleteAppointment=function(){e.close(!0)}}]),angular.module("tos-ui").factory("emailSentModal",["$uibModal","$log",function(t,n){return new function(){this.open=function(e){e?t.open({size:"md",templateUrl:"/app/modules/common/modals/email-sent-modal/email-sent-modal.html",controller:"emailSentModalController",controllerAs:"$ctrl",resolve:{options:e}}):n.warn("Modal tried to open without having the options variable resolved.")}}}]).controller("emailSentModalController",["$uibModalInstance","options","tosModalService","$timeout",function(e,t,n,i){this.modalTitle=t.modalTitle,this.modalDesc=t.modalDesc,this.$onInit=function(){n.handleModalRender(e),i(function(){e.close()},5e3)}}]),angular.module("tos-ui").factory("endowmentRequiredModal",["$uibModal","simpleModal","tisfTranslateService",function(e,t,n){return new function(){this.CloseButtonId="CLOSE";var e={type:t.Type.WARNING,icon:t.Icon.WARNING,title:n.get("endowmentRequired.modal.title"),description:n.get("endowmentRequired.modal.description"),buttons:[{id:this.CloseButtonId,content:n.get("buttons.close"),type:t.Button.Type.SECONDARY,action:t.Button.Action.CLOSE}]};this.open=function(){return t.open(e)}}}]),angular.module("tos-ui").factory("feedbackModal",["$uibModal","$uibModalStack","$rootScope",function(o,t,e){return new function(){var i=!1;e.$on("resetOpen",function(){i=!1}),this.open=function(e,t,n){return i=!0,o.open({size:"md",templateUrl:"/app/modules/common/modals/feedback-modal/feedback-modal.html",controller:"feedbackModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{appointment:function(){return e},currentStep:function(){return t},scheduledAppointment:function(){return n}}})},this.isOpen=function(){return i},this.close=function(){var e=t.getTop();i=!1,e?t.dismiss(e.key):t.dismissAll()}}}]).controller("feedbackModalController",["$uibModalInstance","tosModalService","feedbackService","tisfTranslateService","generalErrorModal","tosUserInfoService","appointment","currentStep","scheduledAppointment","feedbackMetadataService","$scope","$window","screenSizeService","tosScrollService",function(t,n,i,e,o,a,r,l,s,p,c,d,u,m){var g=this;g.feedbackResponse={},g.userSubmittedFeedback=!1,g.saveFeedback=function(){var t=i.prepareFeedbackDataToSave(g.feedbackResponse,g.feedbackQuestions);p.getMetaData(r,g.currentStep,s).then(function(e){e&&(t=_objectSpread(_objectSpread({},t),e)),i.saveFeedback(t).then(function(e){e&&e.onlineSchedulingFeedbackId?(g.userSubmittedFeedback=!0,g.feedbackResponse={},m.scrollToElement("top-of-landing-page")):o.openDefaultToUsersTemple(r&&r.templeOrgId)},function(){return o.openDefaultToUsersTemple(r&&r.templeOrgId)})})},g.$onInit=function(){i.checkIfUserSubmittedFeedback().then(function(e){e?g.userSubmittedFeedback=!0:i.getFeedbackQuestions().then(function(e){var t=i.prepareQuestionsForRendering(e);t&&(g.feedbackQuestions=t)}),n.handleModalRender(t)})};var f=function(){var e=d.document.querySelector("#feedback-modal");if(e){var t=e.offsetHeight+370;u.communicateHeightChange(t)}};c.$watch("$ctrl.feedbackResponse.schedulingExperienceRating",function(e){"OKAY"!==e&&"BAD"!==e||f()}),c.$watch("$ctrl.feedbackResponse.scheduledStatus",function(e){"0"===e&&f()}),g.closeModal=function(){t.close()}}]),angular.module("tos-ui").component("feedbackSideContent",{templateUrl:"/app/modules/common/modals/feedback-side-content/feedback-side-content.html",bindings:{appointment:"<?",currentStep:"<?"},controller:["tosModalService","feedbackService","tisfTranslateService","generalErrorModal","tosUserInfoService","screenSizeService","$window","feedbackMetadataService","$scope","tosScrollService",function(e,n,t,i,o,a,r,l,s,p){var c=this;c.feedbackResponse={},c.userSubmittedFeedback=!1,c.modalIsOpen=!1,c.userClickedFeedbackButton=!1,c.feedbackButton=null,c.saveFeedback=function(){var t=n.prepareFeedbackDataToSave(c.feedbackResponse,c.feedbackQuestions);l.getMetaData(c.appointment,c.currentStep).then(function(e){e&&(t=_objectSpread(_objectSpread({},t),e)),n.saveFeedback(t).then(function(e){e&&e.onlineSchedulingFeedbackId?(c.userSubmittedFeedback=!0,c.feedbackResponse={},p.scrollToElement("top-of-landing-page")):i.openDefaultToUsersTemple(c.appointment&&c.appointment.templeOrgId)},function(){return i.openDefaultToUsersTemple(c.appointment&&c.appointment.templeOrgId)})})},c.$onInit=function(){var e=r.document.getElementById("feedback-side-button");e&&angular.element(e).ready(function(){c.feedbackButton=e,c.feedbackButtonStyles=function(){var e={};if(!c.feedbackButton)return e;var t=c.determineFeedbackButtonMaxWidthValue();return void 0===t||(null!==t&&(e["max-width"]=t+"px"),c.buttonTop||(c.buttonTop=c.determineFeedbackButtonTopValue(t)),e.top=c.buttonTop,e.visibility="visible"),e}(),s.$apply()}),n.checkIfUserSubmittedFeedback().then(function(e){e?c.userSubmittedFeedback=!0:n.getFeedbackQuestions().then(function(e){var t=n.prepareQuestionsForRendering(e);t&&(c.feedbackQuestions=t)})})};var d=function(){var e=r.document.querySelector("#feedback-modal");if(e){var t=e.offsetHeight+300;a.communicateHeightChange(t)}};s.$watch("$ctrl.feedbackResponse.schedulingExperienceRating",function(e){"OKAY"!==e&&"BAD"!==e||d()}),s.$watch("$ctrl.feedbackResponse.scheduledStatus",function(e){"0"===e&&d()}),c.toggleFeedbackContentOpen=function(){c.modalIsOpen=!c.modalIsOpen},c.handleFeedbackButtonClick=function(){c.userClickedFeedbackButton=!0,n.checkIfUserSubmittedFeedback().then(function(e){c.userSubmittedFeedback=e,c.toggleFeedbackContentOpen()})},c.showFeedbackButton=function(){return!a.isMobileView||!c.modalIsOpen};var u=function(){return a.isMobileView?r.screen.availWidth:600};c.determineFeedbackContentWidth=function(){return u()+"px"},c.determineFeedbackContentRightValue=function(){return c.modalIsOpen?"0px":"-"+u()+"px"},c.determineTransitionDuration=function(){return c.userClickedFeedbackButton?"0.5s":""},c.determineFeedbackButtonTopValue=function(e){return(e||c.feedbackButton.offsetWidth)-31+"px"},c.determineFeedbackButtonMaxWidthValue=function(){return/\s/g.test(c.feedbackButton.innerText)?190:null}}]}),angular.module("tos-ui").factory("generalErrorModal",["$uibModal","tosUserInfoService",function(n,i){return new function(){var t=this;t.open=function(e){return n.open({size:"md",templateUrl:"/app/modules/common/modals/general-error-modal/general-error-modal.html",controller:"generalErrorModalController",controllerAs:"$ctrl",resolve:{templeOrgId:e}})},t.openDefaultToUsersTemple=function(e){e&&t.open(e),i.getMyTempleOrgId().then(function(e){t.open(e.templeOrgId)})}}}]).controller("generalErrorModalController",["$uibModalInstance","templeOrgId","tosTempleInfoService","$rootScope","tosModalService",function(e,t,n,i,o){var a=this;a.templeOrgId=t,a.templePhoneNumber=null,n.getTempleContacts(a.templeOrgId).then(function(e){a.templePhoneNumber=e?e.phoneNumber:" "}),i.$on("$locationChangeStart",function(){e.close()}),a.$onInit=function(){o.handleModalRender(e)}}]),angular.module("tos-ui").factory("guestAlreadyAddedModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/guest-already-added-modal/guest-already-added-modal.html",controller:"guestAlreadyAddedController",controllerAs:"$ctrl",backdrop:!e||"static",keyboard:!1})}}}]).controller("guestAlreadyAddedController",["tosTempleInfoService","tosModalService","$uibModalInstance",function(e,t,n){this.$onInit=function(){t.handleModalRender(n)}}]),angular.module("tos-ui").factory("guestLimitExceededModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/guest-limit-exceeded-modal/guest-limit-exceeded-modal.html",controller:"guestLimitExceededController",controllerAs:"$ctrl",backdrop:!e||"static",keyboard:!1})}}}]).controller("guestLimitExceededController",["tosTempleInfoService","tosModalService","$uibModalInstance",function(e,t,n){this.$onInit=function(){t.handleModalRender(n)}}]),angular.module("tos-ui").factory("informationMissingModal",["simpleModal","tisfTranslateService",function(t,n){return new function(){this.AddInfoButtonId="ADD-INFO";var e={type:t.Type.DANGER,icon:t.Icon.INFO,title:n.get("finalizeAppointment.informationMissing.title"),description:n.get("finalizeAppointment.informationMissing.description"),buttons:[{id:this.AddInfoButtonId,content:n.get("finalizeAppointment.informationMissing.button"),type:t.Button.Type.SECONDARY,action:t.Button.Action.CLOSE}]};this.open=function(){return t.open(e)}}}]),angular.module("tos-ui").factory("licensedMarriageModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/licensed-marriage-modal/licensed-marriage-modal.html",controller:"licensedMarriageController",controllerAs:"$ctrl",backdrop:!e||"static",keyboard:!1})}}}]).controller("licensedMarriageController",["tosTempleInfoService","tosModalService","$uibModalInstance","$state","tosLivingSealingService","SealingType",function(e,t,n,i,o,a){this.$onInit=function(){t.handleModalRender(n)},this.closeModal=function(e){e?(o.changeSealingType(a.SEAL_AFTER_CIVIL),n.close(!0)):(o.clearSelectedSealing(),i.go("landing"),n.close(!1))}}]),angular.module("tos-ui").factory("livingAppointmentDeletedModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/living-appointment-deleted-modal/living-appointment-deleted-modal.html",controller:"livingAppointmentDeletedModalController",controllerAs:"$ctrl",resolve:{appointment:e}})}}}]).controller("livingAppointmentDeletedModalController",["$uibModalInstance","appointment","tosModalService",function(e,t,n){this.appointment=t,this.$onInit=function(){n.handleModalRender(e)}}]),angular.module("tos-ui").factory("multipleLivingSealingModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/multiple-sealing-modal/multiple-living-sealing-modal.html",controller:"multipleLivingSealingController",controllerAs:"$ctrl",backdrop:!e||"static",keyboard:!1})}}}]).controller("multipleLivingSealingController",["tosTempleInfoService","tosModalService","$uibModalInstance","$state","tosUserInfoService","tosLivingSealingService","tisfTranslateService","$scope","SealingType",function(e,t,n,i,o,a,r,l,s){var p=this;function c(){return p.canAddChildren()?p.allSealings.find(function(e){return e.id===p.selectedSealingFull.childrenSealingId}):p.canAddSealingToSpouse()?p.allSealings.find(function(e){return e.id===p.selectedSealingFull.htwSealingId}):null}p.$onInit=function(){p.allSealings=a.getAllSealings(),p.optionSelected=!1,p.hasNonSloq=!1,p.hasInvalidSloqPatrons=!1;var e=a.getSelectedSealingId();p.selectedSealing=e||"",p.selectedSealingFull=null,p.sealingOptions=[{label:r.get("multipleSealing.placeholder"),value:""}],o.getUserInfo(!0).then(function(i){var e;p.userInfo=i,(e=p.sealingOptions).push.apply(e,_toConsumableArray(p.allSealings.map(function(e,t){var n=a.getPatronRole(i.mrn,e);return{label:"".concat(t+1,". ").concat(e.sealingType===s.PARENTS_SEALED&&"CHILD"===n||"CHILD_OBSERVER"===n?r.get("multipleSealing"+e.sealingType+"."+n):r.get("multipleSealing."+e.sealingType,"MALE"===i.gender?e.wifeOrMother.confidential.person.name:e.husbandOrFather.confidential.person.name)),value:e.id}})))}).finally(function(){return t.handleModalRender(n)}),l.$watch("$ctrl.selectedSealing",function(t){var e=p.allSealings.find(function(e){return e.id===t});p.handleSelectedSealingChange(e)})},p.handleSelectedSealingChange=function(e){p.selectedSealingFull=e||null,p.optionSelected=!!e,e&&(p.hasNonSloq=e.hasNonSloq,p.hasInvalidSloqPatrons=a.hasInvalidSloqPatrons(e))},p.disableSave=function(){return!(p.optionSelected&&!p.hasNonSloq&&!p.hasInvalidSloqPatrons)},p.isEdit=function(){return p.selectedSealing&&""!==p.selectedSealing&&p.selectedSealingFull&&p.selectedSealingFull.alreadyScheduled},p.isSealingValidAndReady=function(t){var e=p.allSealings.find(function(e){return e.type===t});return!!e&&!e.hasNonSloq&&!a.hasInvalidSloqPatrons(e)},p.proceedWithSealingAndCloseModal=function(){a.changeSelectedSealing(p.selectedSealingFull),n.close()},p.closeModalWithSelectedSealing=function(){if(p.canAddChildren()||p.canAddSealingToSpouse())if(p.neitherSealingScheduled())p.canAddChildren()&&(p.isSealingValidAndReady(s.CHILD_TO_PARENTS_SEALING)?(a.changeSelectedSealing(p.selectedSealingFull),n.close({modal:"sealingSameTime",sealingTypeToConnect:s.CHILD_TO_PARENTS_SEALING})):p.proceedWithSealingAndCloseModal()),p.canAddSealingToSpouse()&&(p.isSealingValidAndReady(s.WIFE_TO_HUSBAND_SEALING)?(a.changeSelectedSealing(p.selectedSealingFull),n.close({modal:"sealingSameTime",sealingTypeToConnect:s.WIFE_TO_HUSBAND_SEALING})):p.proceedWithSealingAndCloseModal());else{if((t=c())&&!p.selectedSealingFull.alreadyScheduled&&t.alreadyScheduled){var e=c();n.close({modal:"combineSealings",scheduledSealing:e})}p.proceedWithSealingAndCloseModal()}else p.proceedWithSealingAndCloseModal();var t},p.isChildToParentSealing=function(){return!!p.selectedSealingFull&&p.selectedSealingFull.type===s.CHILD_TO_PARENTS_SEALING},p.getMaleAdultName=function(){var e=p.selectedSealingFull&&p.selectedSealingFull.husbandOrFather&&p.selectedSealingFull.husbandOrFather.confidential&&p.selectedSealingFull.husbandOrFather.confidential.person?p.selectedSealingFull.husbandOrFather.confidential.person.name:"";return p.isChildToParentSealing()?r.get("scheduleAppointment.sealing.father",e):r.get("scheduleAppointment.sealing.husband",e)},p.getFemaleAdultName=function(){var e=p.selectedSealingFull&&p.selectedSealingFull.wifeOrMother&&p.selectedSealingFull.wifeOrMother.confidential&&p.selectedSealingFull.wifeOrMother.confidential.person?p.selectedSealingFull.wifeOrMother.confidential.person.name:"";return p.isChildToParentSealing()?r.get("scheduleAppointment.sealing.mother",e):r.get("scheduleAppointment.sealing.wife",e)},p.getChildrenForSealing=function(){return a.getChildren(p.selectedSealingFull)},p.getObserversForSealing=function(){return a.getObservers(p.selectedSealingFull)},p.canAddChildren=function(){return p.selectedSealingFull&&p.selectedSealingFull.childrenSealingId},p.canAddSealingToSpouse=function(){return p.selectedSealingFull&&p.selectedSealingFull.htwSealingId},p.neitherSealingScheduled=function(){return 1<p.allSealings.length&&!p.allSealings.some(function(e){return e.alreadyScheduled})}}]),angular.module("tos-ui").factory("needMoreTimeModal",["$uibModal","$uibModalStack","$rootScope",function(n,i,e){return new function(){var t=!1;e.$on("resetOpen",function(){t=!1}),this.open=function(e){return t=!0,n.open({size:"md",templateUrl:"/app/modules/common/modals/need-more-time-modal/need-more-time-modal.html",controller:"needMoreTimeModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{appointment:e}})},this.isOpen=function(){return t},this.close=function(){var e=i.getTop();e?i.dismiss(e.key):i.dismissAll()}}}]).controller("needMoreTimeModalController",["$rootScope","$uibModalInstance","$state","appointment","tosModalService","tosHoldService",function(e,t,n,i,o,a){this.$onInit=function(){o.handleModalRender(t)},this.addMoreTime=function(){a.extendSessionTimeHold(i.appointmentTimeId,i.contactInfo.uuid),e.$broadcast("resetTimer"),t.close()},this.cancelAppointment=function(){a.deleteSessionTimeHold(i.appointmentTimeId,i.contactInfo.uuid,!0),t.close(),n.go("landing")}}]),angular.module("tos-ui").factory("outOfTimeModal",["$uibModal","$uibModalStack","$rootScope","tosHoldService",function(s,t,e,p){return new function(){var l=!1;e.$on("resetOpen",function(){l=!1}),this.open=function(e,t,n,i,o,a,r){return p.deleteSessionTimeHold(e.appointmentTimeId,e.contactInfo.uuid,!0),l=!0,s.open({size:"md",templateUrl:"/app/modules/common/modals/out-of-time-modal/out-of-time-modal.html",controller:"outOfTimeModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{appointment:e,session:t,inclSelf:n,inclSpouse:i,isEdit:o,selfGuest:a,spouseGuest:r}})},this.isOpen=function(){return l},this.close=function(){var e=t.getTop();l=!1,e?t.dismiss(e.key):t.dismissAll()}}}]).controller("outOfTimeModalController",["$rootScope","$uibModalInstance","$state","appointment","session","inclSelf","selfGuest","inclSpouse","spouseGuest","isEdit","tosModalService","appointmentNotAvailableModal","appointmentService",function(t,n,i,o,e,a,r,l,s,p,c,d,u){this.$onInit=function(){c.handleModalRender(n)};var m=function(e){t.$broadcast("resetTimer"),e&&t.$broadcast("resetOpening"),t.$broadcast("resetOpen"),n.close()};this.checkAvailability=function(){u.sessionIsAvailableForHold(o,e,a,r,l,s,p).then(function(e){"SUCCESS"===e.status?m(!1):(m(!0),i.go("schedule",{appointment:{templeOrgId:o.templeOrgId}}),d.open())})},this.goToLanding=function(){n.close(),i.go("landing")}}]),angular.module("tos-ui").factory("patronHousingExternalLinkModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({templateUrl:"/app/modules/common/modals/patron-housing-external-link-modal/patron-housing-external-link-modal.html",controller:"patronHousingExternalLinkModalController",controllerAs:"$ctrl",keyboard:!0,resolve:{reservationInfo:e}})}}}]).controller("patronHousingExternalLinkModalController",["$uibModalInstance","reservationInfo","tosModalService",function(e,t,n){this.urlToReservationSite=t?"\n"+t.patronHousingUrl:"/",this.urlCode=t?t.discountCode:"",this.clickableUrl=t.patronHousingUrl+this.urlCode,this.$onInit=function(){n.handleModalRender(e)}}]),angular.module("tos-ui").factory("patronHousingReservationModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({templateUrl:"/app/modules/common/modals/patron-housing-reservation-modal/patron-housing-reservation-modal.html",controller:"patronHousingReservationModalController",controllerAs:"$ctrl",keyboard:!0,resolve:{templeHousing:e}})}}}]).controller("patronHousingReservationModalController",["$uibModalInstance","tosModalService","tosTempleInfoService","patronHousingExternalLinkModal","templeHousing","$window",function(e,t,n,i,o,a){var r=this;r.$onInit=function(){o&&(r.urlToReservationSite=o.patronHousingUrl,r.reservationOptions=_toConsumableArray(o.activeDiscountCodes)),r.reservationOptions.sort(function(e,t){return e.topicLookupId>t.topicLookupId?1:-1}),r.selectedOption=r.reservationOptions[0],t.handleModalRender(e)},r.openExternalLinkModal=function(){a.document.getElementsByName("reservation").forEach(function(e){e.checked&&(r.selectedOption={discountCode:e.value})}),r.urlToReservationSite&&r.selectedOption.discountCode&&(e.close(),i.open({patronHousingUrl:r.urlToReservationSite||"",discountCode:r.selectedOption.discountCode||""}))}}]),angular.module("tos-ui").factory("recommendWarningModal",["$uibModal",function(e){return new function(){this.open=function(){return e.open({size:"md",templateUrl:"/app/modules/common/modals/recommend-warning-modal/recommend-warning-modal.html",controller:"recommendWarningController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1})}}}]).controller("recommendWarningController",["tosTempleInfoService","tosModalService","$uibModalInstance",function(e,t,n){this.$onInit=function(){t.handleModalRender(n)}}]),angular.module("tos-ui").factory("removeGuestModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/remove-guest-modal/remove-guest-modal.html",controller:"removeGuestModalController",controllerAs:"$ctrl",resolve:{appointment:e}})}}}]).controller("removeGuestModalController",["$uibModalInstance","appointment","tosModalService",function(e,t,n){this.appointment=t,this.$onInit=function(){n.handleModalRender(e)},this.deleteAppointment=function(){e.close(!0)}}]),angular.module("tos-ui").factory("scheduleLimitReachedModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/schedule-limit-reached-modal/schedule-limit-reached-modal.html",controller:"scheduleLimitReachedController",controllerAs:"$ctrl",backdrop:!e||"static",keyboard:!1})}}}]).controller("scheduleLimitReachedController",["tosTempleInfoService","tosModalService","$uibModalInstance","$state",function(e,t,n,i){this.isEdit="schedule.edit"===i.current.name,this.$onInit=function(){t.handleModalRender(n)}}]),angular.module("tos-ui").factory("appointmentScheduledModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/scheduled-appointment-modal/appointment-scheduled-modal.html",controller:"appointmentScheduledController",controllerAs:"$ctrl",resolve:{appointment:function(){return e}}})}}}]).controller("appointmentScheduledController",["tosCalendarService","appointment","AppointmentType","appointmentService","tosTempleConfigService","tosUrlService","tosModalService","$uibModalInstance","tosDateService","feedbackModal","tosScrollService","localizeDateTimeFilter","tosUserInfoService","$window","tosLivingSealingService","$timeout",function(e,n,t,i,o,a,r,l,s,p,c,d,u,m,g,f){var h,S=this;S.AppointmentType=t,S.tosLivingSealingService=g,S.ordinanceReadyCampaignIdUrlSuffix="cid=RE-00035142",S.showLinkCopiedText=!1,S.showDetailsCopiedText=!1;var T=function(){n.appointmentType===t.PROXY_BAPTISM&&o.getProxyBaptismConfig(n.templeOrgId).then(function(e){h=e.patronCountPerHour,e.appointmentLength,S.appointmentLengthInMinutes||(S.appointmentLengthInMinutes=i.calculateAppointmentLengthInMinutes(h,S.appointment.details.femalePatronCount,S.appointment.details.malePatronCount)),S.appointmentLengthInMinutes})};S.$onInit=function(){S.showLinkCopiedText=!1,S.showDetailsCopiedText=!1,S.appointment=n,S.dateToDisplay=s.getSlcDateTime(S.appointment.appointmentDateTime),S.isAGroupAppointment()&&S.isSchedulingUser()&&(a.getGuestAppointmentUrl(n.id).then(function(e){S.shareableLink=e.url}),a.getAppointmentInvitationDetails(n).then(function(e){S.appointmentInvitationDetails=e.data}),a.getMailToLink(n).then(function(e){S.mailToEmailInvitation=e.url})),a.getFamilySearchUrl(S.appointment.appointmentType).then(function(e){S.familySearchHref=e.url,S.ordinanceReadyCampaignIdUrlSuffix&&(S.familySearchHref+=(S.familySearchHref.includes("?")?"&":"?")+S.ordinanceReadyCampaignIdUrlSuffix)}),i.findSpouseInAppointment(S.appointment).then(function(e){S.appointment.spouseIsIncluded=!!e});var e=i.getCorrectAppointmentType(S.appointment);o.getOrdinanceConfig(n.templeOrgId,e).then(function(e){var t=i.getArrivalTimeForAppointmentFromSlcDateTime(n,e);S.arrivalTime=d(t,"time")}),T(),r.handleModalRender(l,115);var t=i.isLivingOrdinance(n.appointmentType);u.getUserInfo(t).then(function(e){S.userInfo=_objectSpread({},e),S.userEmail=function(t){if(S.appointment&&t){var e=S.appointment.guestList.find(function(e){return e.guestMrn===t.mrn});if(e&&e.email)return e.email}return t&&t.email?t.email:S.appointment&&S.appointment.details?S.appointment.details.contactEmail:void 0}(e)})},S.addToCalendar=function(){e.addAppointmentToCalendar(S.appointment,S.userInfo)},S.isLivingSealing=function(){return i.isLivingSealing(S.appointment.appointmentType)},S.openFeedbackModal=function(){l.close(),p.open(S.appointment,null,!0),c.scrollToElement("top-of-landing-page")},S.openOrdinancesReady=function(){m.open(S.familySearchHref,"_blank")},S.isAGroupAppointment=function(){return i.isAGroupAppointment(S.appointment)},S.isSchedulingUser=function(){return S.appointment&&S.appointment.userIsScheduler},S.isProxy=function(){return i.isProxyOrdinance(S.appointment.appointmentType)},S.displayedAppointmentType=function(){return S.appointment&&!S.appointment.userIsScheduler&&"LIVING_ENDOWMENT"===S.appointment.appointmentType?"PROXY_ENDOWMENT":S.appointment&&S.appointment.appointmentType},S.getGroupSize=function(){return S.appointment.appointmentType===t.LIVING_ENDOWMENT?S.appointment.patronList.length+S.appointment.details.guestCount:S.appointment.details.guestCount},S.getMaleAdultName=function(){return g.getMaleAdultName()},S.getFemaleAdultName=function(){return g.getFemaleAdultName()},S.shouldShowChildrenAndObservers=function(){return g.shouldShowChildrenAndObservers()},S.getChildrenForSealing=function(){return g.getChildrenForSealing()},S.getObserversForSealing=function(){return g.getObserversForSealing()},S.getChildName=function(e){return g.getChildName(e)},S.getSealingTypeMessage=function(){return g.getSealingTypeMessage()},S.showClipboardSuccessText=function(e){switch(e){case"shareable-link":S.showLinkCopiedText=!0;break;case"invitation-details":S.showDetailsCopiedText=!0}f(function(){switch(e){case"shareable-link":S.showLinkCopiedText=!1;break;case"invitation-details":S.showDetailsCopiedText=!1}},5e3,!0,{type:e})}}]),angular.module("tos-ui").factory("sealingSameTimeModal",["simpleModal","tisfTranslateService","SealingType",function(a,r,l){return new function(){var o=this;o.YesButtonId="YES",o.NoButtonId="NO",o.open=function(e){var t=e===l.CHILD_TO_PARENTS_SEALING?"sealingSameTimeModal.toChildren.title":"sealingSameTimeModal.toSpouse.title",n=e===l.CHILD_TO_PARENTS_SEALING?"sealingSameTimeModal.toChildren.description":"sealingSameTimeModal.toSpouse.description",i={type:a.Type.INFO,icon:a.Icon.INFO,title:r.get(t),description:r.get(n),buttons:[{id:o.YesButtonId,content:r.get("buttons.yes"),type:a.Button.Type.PRIMARY,action:a.Button.Action.CLOSE},{id:o.NoButtonId,content:r.get("buttons.no"),type:a.Button.Type.SECONDARY,action:a.Button.Action.DISMISS}]};return a.open(i)}}}]),angular.module("tos-ui").factory("sessionIsFullModal",["$uibModal",function(n){return new function(){this.open=function(e,t){return n.open({size:"md",templateUrl:"/app/modules/common/modals/session-is-full-modal/session-is-full-modal.html",controller:"sessionIsFullController",controllerAs:"$ctrl",backdrop:!e||"static",keyboard:!1,resolve:{appointment:t}})}}}]).controller("sessionIsFullController",["tosTempleInfoService","tosModalService","$uibModalInstance","$state","tosAppointmentTypeFilter","appointment",function(e,t,n,i,o,a){this.isEdit="schedule.edit"===i.current.name,this.appointmentType=o(a.appointmentType).split(" ")[1].toLowerCase(),this.$onInit=function(){t.handleModalRender(n)}}]),angular.module("tos-ui").factory("sessionNotAvailableModal",["$log","$state","$uibModal","generalErrorModal","tosAccordionService","tosHoldService",function(l,s,p,c,d,u){return new function(){var r=this;r.actionIds={selectATime:{},dontSchedule:{}},r.open=function(t,e,n,i,o){if(!angular.isFunction(d.goToSelectATime))throw new Error("tosAccordionService.goToSelectATime is defined, or not a function");if(void 0===t.templeOrgId)throw new Error("templeOrgId is not defined. Use null if no templeOrgId is available");var a=p.open({size:"md",templateUrl:"/app/modules/common/modals/session-not-available-modal/session-not-available-modal.html",controller:"sessionNotAvailableModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{actionIds:r.actionIds,appointmentNoLongerExists:n,notEnoughSeats:i,appointmentIsPast:o,session:e,appointment:t}});return a.result.then(function(){u.deleteSessionTimeHold(t.appointmentTimeId,t.contactInfo.uuid,!0),d.goToSelectATime()},function(){u.deleteSessionTimeHold(t.appointmentTimeId,t.contactInfo.uuid,!0),s.go("landing")}).catch(function(e){l.error("Unknown modal error while trying to notify user that session is not available.",e),c.open(t.templeOrgId)}),a}}}]).controller("sessionNotAvailableModalController",["$uibModalInstance","actionIds","$rootScope","tosModalService","appointmentNoLongerExists","notEnoughSeats","appointmentIsPast","session","appointment","tisfTranslateService",function(e,t,n,i,o,a,r,l,s,p){var c=this;o?(c.titleText="schedulingNotice.appointmentNoLongerExists.title",c.descriptionText=p.get("schedulingNotice.appointmentNoLongerExists.description")):a?(c.titleText="schedulingNotice.notEnoughSeats.title",c.descriptionText=p.get("schedulingNotice.notEnoughSeats.description")):r?(c.titleText="schedulingNotice.appointmentIsPast.title",c.descriptionText=p.get("schedulingNotice.appointmentIsPast.description")):(c.titleText="schedulingNotice.title",c.descriptionText=p.get("schedulingNotice.description")),c.onSelectATimeClicked=function(){e.close()},c.$onInit=function(){i.handleModalRender(e)}}]),angular.module("tos-ui").factory("simpleModal",["$uibModal","tisfTranslateService",function(i,t){return new function(){var e=this;e.Type={INFO:"INFO",WARNING:"WARNING",DANGER:"DANGER"},e.Icon={INFO:"INFO",WARNING:"WARNING",ERROR:"ERROR"},e.Button={Type:{PRIMARY:"PRIMARY",SECONDARY:"SECONDARY",GHOST:"GHOST"},Action:{CLOSE:"CLOSE",DISMISS:"DISMISS"}},e.Button={Type:{PRIMARY:"PRIMARY",SECONDARY:"SECONDARY",GHOST:"GHOST"},Action:{CLOSE:"CLOSE",DISMISS:"DISMISS"}},e.defaultButtonIds={CLOSE:"CLOSE",OK:"OK",CANCEL:"CANCEL"},e.defaultButtons={close:{id:e.defaultButtonIds.CLOSE,content:t.get("buttons.close"),type:e.Button.Type.PRIMARY,action:e.Button.Action.CLOSE},ok:{id:e.defaultButtonIds.OK,content:t.get("buttons.ok"),type:e.Button.Type.PRIMARY,action:e.Button.Action.CLOSE},cancel:{id:e.defaultButtonIds.CANCEL,content:t.get("buttons.cancel"),type:e.Button.Type.SECONDARY,action:e.Button.Action.DISMISS}};var n={type:e.Type.INFO,icon:e.Icon.INFO,title:"title",description:"description",buttons:[_objectSpread({},e.defaultButtons.ok),_objectSpread({},e.defaultButtons.cancel)]};e.open=function(e){var t=angular.extend({},n,e);return i.open({size:"md",templateUrl:"/app/modules/common/modals/simple-modal/simple-modal.html",controller:"simpleModalController",controllerAs:"$ctrl",resolve:{options:t}})}}}]).controller("simpleModalController",["$uibModalInstance","options","tosModalService",function(n,e,i){this.options=e,this.alertType=e.type.toLowerCase(),this.alertIcon=e.icon.toLowerCase(),this.onButtonClick=function(e){var t=e.action.toLowerCase();(0,n[t])(e.id),i.handleModalRender(n)}}]),angular.module("tos-ui").factory("templeSelectorModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/temple-selector-modal/temple-selector-modal.html",controller:"templeSelectorModalController",controllerAs:"$ctrl",resolve:{yourTempleId:e}})}}}]).controller("templeSelectorModalController",["$uibModalInstance","tosModalService","tisfTranslateService","screenSizeService","tosTempleInfoService","$log","$scope","$window","$timeout","generalErrorModal","tosTempleConfigService","$state","yourTempleId","tosTempleNameFilter","tosScrollService","tosAdobeAnalyticsService",function(t,e,n,i,o,a,r,l,s,p,c,d,u,m,g,f){var h=this;h.templeSearch="",h.showSpinner=!1,h.$onInit=function(){h.loadingTemples=!0,u&&(h.yourTempleId=u,h.yourTempleName=m(h.yourTempleId),h.yourTempleElement=n.get("selectATemple.yourTemple",'<a class="your-temple">'+h.yourTempleName+"</a>")),f.trackPageView("TOS|Temple|List",null,"TOS Select Temple"),c.getAllOnlineSchedulingStatuses().then(function(e){h.loadingTemples=!1,h.temples=e}).finally(function(){h.loadingTemples=!1,e.handleModalRender(t)})},h.getSearchForTemplePlaceholderText=function(){var e=i.isMobileView?"selectATemple.searchBarPlaceholderTextForMobile":"selectATemple.searchBarPlaceholderText";return n.get(e)},h.selectTemple=function(e){h.showSpinner||(h.selectedTempleOrgId=e.templeOrgId,h.showSpinner=!0,o.selectATemple(e.templeOrgId).then(function(e){f.trackPageView("TOS|Temple|Select",null,"TOS Select Temple"),h.showSpinner=!1,t.close(e)}).catch(function(){h.showSpinner=!1,t.close()}))},h.selectTempleOnEnterKeyPress=function(){r.filteredTemples&&angular.isArray(r.filteredTemples)&&1===r.filteredTemples.length&&(h.selectedTempleOrgId=r.filteredTemples[0].templeOrgId,h.selectTemple(r.filteredTemples[0]),g.scrollToElement("temple-selector"))},h.showNoTemplesMatchingSearchMessage=function(e){return!!h.temples&&h.templeSearch&&0===e.length}}]),angular.module("tos-ui").factory("unableToEditModal",["$uibModal",function(t){return new function(){this.open=function(e){return t.open({size:"md",templateUrl:"/app/modules/common/modals/unable-to-edit-modal/unable-to-edit-modal.html",controller:"unableToEditModalController",controllerAs:"$ctrl",backdrop:"static",keyboard:!1,resolve:{appointment:e}})}}}]).controller("unableToEditModalController",["$uibModalInstance","appointment","$rootScope","$state","tosModalService","tisfTranslateService","tosTempleInfoService",function(e,t,n,i,o,a,r){var l=this;l.templeName=t?a.get("temple.name."+t.templeOrgId):"",l.$onInit=function(){r.getTempleContactInfo(t.templeOrgId).then(function(e){if(e){var t=e.phones&&e.phones.find(function(e){return"Office"===e.phoneType});l.templePhone=t?t.phoneNumber:""}else l.templePhone=""}),n.$on("$locationChangeStart",function(){e.close()}),o.handleModalRender(e)},l.closeModal=function(){e.close()}}]),angular.module("tos-ui").factory("usNumberRequiredModal",["simpleModal","tisfTranslateService",function(t,n){return new function(){var e={type:t.Type.DANGER,icon:t.Icon.ERROR,title:n.get("finalizeAppointment.usNumberRequired.title"),description:n.get("finalizeAppointment.usNumberRequired.description"),buttons:[{id:"UPDATE-MOBILE-NUMBER",content:n.get("finalizeAppointment.usNumberRequired.button"),type:t.Button.Type.SECONDARY,action:t.Button.Action.CLOSE}]};this.open=function(){return t.open(e)}}}]),angular.module("tos-ui").run(["$templateCache",function(e){e.put("/app/modules/responsive/tos-row.html",'<div class="clearfix"><div class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-offset-1 col-sm-10 col-xs-12"><div ng-transclude></div></div></div>'),e.put("/app/modules/schedule/landing.html",'<div><tos-success-snack-bar snackbar-text="\'copy.to.clipboard.success\' | tisfTranslate"></tos-success-snack-bar><div ng-show="$ctrl.showSpinner"><span class="loading-spinner"></span></div><div id="top-of-landing-page"></div><feedback-side-content></feedback-side-content><tos-row ng-if="!$ctrl.successfullyScheduledAppointment"><h2 class="landing-page-title no-margin-header">{{\'scheduleAnAppointmentTitle\' | tisfTranslate}}</h2></tos-row><div ng-if="!$ctrl.successfullyScheduledAppointment && $ctrl.showHighDemandMessage === true" class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-offset-1 col-sm-10 col-xs-12"><div class="alert in-page-alert ng-scope col-lg-8 col-md-10 col-sm-10" role="alert" style="margin:10px; margin-left:0px; padding:0; padding-top:10px; padding-bottom:10px;"><div class="inline-flex description" style="padding:0px; margin:0px;padding-right:0.5em; padding-left:0.5em;"><span class="info-icon" style="background-repeat: no-repeat!important; top:0px; height:24px; width:24px; padding-right:1.5em;"></span> &nbsp;<span>{{ \'yourTemple.highDemand\' | tisfTranslate }}</span></div></div><div class="col-lg-4 col-md-10 col-sm-10"></div></div><div><div class="desktop" ng-if="!$ctrl.successfullyScheduledAppointment"><tos-row><div class="col-lg-8 col-md-10 col-sm-10 your-temple-box"><div class="row" ng-if="$ctrl.selectedTemple"><div class="col-lg-5 col-md-5 col-sm-5 desktop"><img src="" ng-src="{{$ctrl.templeImageSrc ? $ctrl.templeImageSrc : \'tos-ui/resources/images/icons/temple-blue.svg\'}}" id="temple-img" alt="{{$ctrl.selectedTemple.templeOrgId | tosTempleName}}" class="temple-picture" width="100%"></div><div class="col-lg-7 col-md-7 col-sm-7" id="your-temple-info"><p class="bar your-temple-bar"><span ng-if="$ctrl.yourTempleId === $ctrl.selectedTemple.templeOrgId">{{\'yourTemple.title\' | tisfTranslate}}</span></p><h3 class="your-temple-name-heading">{{$ctrl.selectedTemple.templeOrgId | tosTempleName}}</h3><p class="your-temple-contact-info">{{$ctrl.selectedTemple.primaryAddress}}</p></div></div><div class="row" ng-if="$ctrl.selectedTemple"><div class="col-lg-12 col-md-12 col-sm-12" ng-if="!$ctrl.showSelectThisTemple"><p style="margin: 0">{{\'yourTemple.notSchedulingAppointmentsOnline\' | tisfTranslate}}</p></div><div class="col-lg-5 col-md-5 col-sm-5" ng-if="$ctrl.showSelectThisTemple"><button class="select-this-temple" ng-click="$ctrl.continueToSelectAppointmentType()" id="select-this-temple-button">{{\'yourTemple.selectThisTempleButton\' | tisfTranslate}}</button></div><div class="col-lg-7 col-md-7 col-sm-7" ng-class="$ctrl.showSelectThisTemple\n                                        ? \'select-a-different-temple-desktop\'\n                                        : \'select-a-different-temple-desktop-not-scheduling\'"><a ng-click="$ctrl.continueToSelectATemple()" id="select-a-different-temple-link">{{\'yourTemple.selectADifferentTempleLink\' | tisfTranslate}}</a></div></div><div class="row" ng-if="$ctrl.shouldShowPatronHousingInfo()"><div class="pad-15"><hr></div></div><div class="row" ng-if="$ctrl.shouldShowPatronHousingInfo()"><p class="col-lg-12 col-md-12 col-sm-12"><strong>{{\'yourTemple.patronHousingAvailable\' | tisfTranslate}}<br></strong><span ng-if="$ctrl.templeHousingInfo.patronHousingUrl"><a class="no-text-decoration" ng-click="$ctrl.openPatronHousingModal()">{{\'yourTemple.housingReservationWebsite\' | tisfTranslate}}</a><br></span><span ng-if="$ctrl.templeHousingInfo.patronHousingPhone" ng-bind-html="$ctrl.patronHousingPhone"></span><br ng-if="$ctrl.templeHousingInfo.patronHousingPhone"><span ng-if="$ctrl.templeHousingInfo.patronHousingEmail" ng-bind-html="$ctrl.patronHousingEmail"></span></p></div></div><div class="col-lg-4 col-md-10 col-sm-10"><what-can-i-schedule appointment-types-and-availability="$ctrl.appointmentTypesAvailForPatron"></what-can-i-schedule></div></tos-row></div><div class="mobile" ng-if="!$ctrl.successfullyScheduledAppointment"><tos-row><div ng-if="$ctrl.selectedTemple && $ctrl.selectedTemple.onlineSchedulingIsEnabled" class="select-temple-buttons"><p class="not-scheduling-message-mobile" ng-if="!$ctrl.showSelectThisTemple">{{\'yourTemple.notSchedulingAppointmentsOnline\' | tisfTranslate}}</p><button class="landing-page-mobile-button" ng-if="$ctrl.showSelectThisTemple" ng-click="$ctrl.continueToSelectAppointmentType()">{{$ctrl.selectedTemple.templeOrgId | tosTempleName}}</button> <a class="pick-different-temple-mobile-link" ng-click="$ctrl.continueToSelectATemple()">{{\'yourTemple.selectADifferentTempleLink\' | tisfTranslate}}</a></div><div ng-if="$ctrl.selectedTemple && !$ctrl.selectedTemple.onlineSchedulingIsEnabled"><p class="text3 your-temple-name-mobile">{{$ctrl.selectedTemple.templeOrgId | tosTempleName}}</p><p class="not-scheduling-message-mobile">{{\'yourTemple.notSchedulingAppointmentsOnline\' | tisfTranslate}}</p><button class="pick-different-temple-mobile-link landing-page-mobile-button" ng-click="$ctrl.continueToSelectATemple()">{{\'yourTemple.selectADifferentTempleLink\' | tisfTranslate}}</button></div><div class="row" ng-if="$ctrl.templeHousingInfo.patronHousingPhone ||\n                                        $ctrl.templeHousingInfo.patronHousingEmail ||\n                                        $ctrl.templeHousingInfo.patronHousingUrl"><p class="col-lg-12 col-md-12 col-sm-12"><strong>{{\'yourTemple.patronHousingAvailable\' | tisfTranslate}}<br></strong><span ng-if="$ctrl.templeHousingInfo.patronHousingUrl"><a class="no-text-decoration" ng-click="$ctrl.openPatronHousingModal()">{{\'yourTemple.housingReservationWebsite\' | tisfTranslate}}</a><br></span><span ng-if="$ctrl.templeHousingInfo.patronHousingPhone" ng-bind-html="$ctrl.patronHousingPhone"></span><br ng-if="$ctrl.templeHousingInfo.patronHousingPhone"><span ng-if="$ctrl.templeHousingInfo.patronHousingEmail" ng-bind-html="$ctrl.patronHousingEmail"></span></p></div><div class="what-can-i-schedule-container"><what-can-i-schedule appointment-types-and-availability="$ctrl.appointmentTypesAndAvailability"></what-can-i-schedule></div></tos-row></div><tos-row ng-if="!$ctrl.successfullyScheduledAppointment"><hr class="desktop landing-page-hr"></tos-row><tos-row><div class="margin-16-bottom my-appointments-title-section"><h2 style="margin: 4rem 0 0 !important;">{{\'myAppointments.title\' | tisfTranslate}}</h2><span ng-if="!$ctrl.userHasNoAppointments() && $ctrl.isDoneCheckingAppointments">{{\'myAppointments.allAppointmentTimesLocalToTemple\' | tisfTranslate}}</span></div><div class="margin-16-bottom family-search-landing-header" ng-if="!$ctrl.userHasNoAppointments() && $ctrl.isDoneCheckingAppointments">{{\'myAppointments.familySearchHeader\' | tisfTranslate}}</div><div class="mobile select-temple-buttons"><button ng-if="$ctrl.successfullyScheduledAppointment" ng-click="$ctrl.scheduleAnotherAppointment()" class="landing-page-mobile-button">{{\'scheduleAnotherAppointmentButtonText\' | tisfTranslate}}</button></div><div class="desktop select-temple-buttons"><button ng-if="$ctrl.successfullyScheduledAppointment" ng-click="$ctrl.scheduleAnotherAppointment()">{{\'scheduleAnotherAppointmentButtonText\' | tisfTranslate}}</button></div><div class="desktop"><p class="no-appointments" ng-if="$ctrl.userHasNoAppointments()">{{\'myAppointments.noAppointmentsScheduledMessage\' | tisfTranslate}}</p><table ng-if="$ctrl.userHasExistingAppointments()" class="my-appointments-table"><thead><tr><th class="date-column" id="date-column-header">{{\'myAppointments.dateColumnHeader\' | tisfTranslate}}</th><th class="temple-column" id="temple-column-header">{{\'myAppointments.templeColumnHeader\' | tisfTranslate}}</th><th class="ordinance-type-column" id="ordinance-type-column-header">{{\'myAppointments.appointmentTypeColumnHeader\' | tisfTranslate}}</th><th class="patrons-attending-column" id="patrons-attending-column-header">{{\'myAppointments.patronsAttendingColumnHeader\' | tisfTranslate}}</th><th class="actions-column" id="actions-column-header"></th></tr></thead><tbody><tr ng-repeat="appointment in $ctrl.existingAppointments | orderBy: [\'appointmentDateTime\', \'templeName\']" id="{{\'existing-appointment-row-\' + appointment.id}}" class="appointment-row" ng-if="appointment.shouldHide === false" ng-class="{\'highlight\':$ctrl.shouldAppointmentBeHighlighted(appointment)}" ng-click="$ctrl.onAppointmentClick(appointment)"><td class="date-column">{{appointment.displayedAppointmentDate || appointment.appointmentDateTime | localizeDateTime:\'weekday\'}}<br>{{appointment.displayedAppointmentDate || appointment.appointmentDateTime | localizeDateTime:\'dateShort\'}}<br>{{appointment | tosAppointmentTime}}<br><div class="appointment-arrival-time" ng-if="appointment.arrivalTime"><strong>{{\'finalizeAppointment.arrive.by\' | tisfTranslate:appointment.arrivalTime}}</strong></div></td><td class="temple-column">{{appointment.templeOrgId | tosTempleName}}</td><td class="ordinance-type-column"><span>{{$ctrl.getAppointmentType(appointment)}}</span> <span ng-if="!appointment.userIsScheduler && $ctrl.isLivingOrdinances(appointment.appointmentType) && appointment.details">{{appointment.details.contactName ? (\'myAppointments.guestOfLivingEndowment\' | tisfTranslate : (appointment.details.contactName)) : (\'myAppointments.iAmAGuest\' | tisfTranslate) }}</span><div ng-if="appointment.appointmentStatus === \'DETACHED\'"><tos-tooltip popover-position="\'auto top\'" tooltip-placement="\'left\'" icon-type="\'danger\'" highlight-text="false" tooltip-label="$ctrl.actionRequiredLabel" tooltip-text="appointment.actionRequiredText"></tos-tooltip></div><div ng-if="appointment.appointmentTimeHasChanged && $ctrl.isAGroupAppointmentGuest(appointment)"><i class="icon info-danger-icon"></i> <span class="danger-notice">{{ \'myAppointments.timeChanged\' | tisfTranslate }}</span></div><div ng-if="$ctrl.isProxyOrdinance(appointment)"><a style="font-weight: 400;" target="_blank" href="{{appointment.familySearchHref}}"><i class="icon print"></i> {{ \'myAppointments.printCard\' | tisfTranslate }}</a></div></td><td class="patrons-attending-column"><appointment-attendees appointment="appointment"></appointment-attendees></td><td class="actions-column"><div class="dropdown"><div class="btn-group dropup" uib-dropdown is-open="status.isopen"><button id="single-button" type="button" class="secondary action-button" uib-dropdown-toggle ng-disabled="disabled" ng-click="$ctrl.handleActionsButtonClick(appointment, $last)">{{\'myAppointments.actionsButton\' | tisfTranslate}}&nbsp;<em class="icon icon-chevrondown-dark-blue"></em></button><action-menu appointment="appointment" share-appointment-url-map="$ctrl.shareAppointmentUrlMap" contact-info="$ctrl.contactInfo" delete-appointment-fn="$ctrl.deleteAppointment" existing-appointments="$ctrl.existingAppointments"></action-menu></div></div><div ng-if="$ctrl.shouldDisableEditsAndCancellations(appointment)" class="not-editable-indicator"><tos-tooltip popover-position="\'auto top\'" icon-type="\'help\'" highlight-text="true" tooltip-label="$ctrl.notEditableLabel" tooltip-text="appointment.notEditableText"></tos-tooltip></div><div ng-if="$ctrl.isNonEditableOpOrdinance(appointment)" class="not-editable-indicator"><tos-tooltip popover-position="\'auto top\'" icon-type="\'help\'" highlight-text="true" tooltip-label="$ctrl.notEditableLabel" tooltip-text="appointment.opNotEditableText"></tos-tooltip></div></td></tr></tbody></table></div><div class="mobile"><p class="no-appointments" ng-if="$ctrl.userHasNoAppointments()">{{\'myAppointments.noAppointmentsScheduledMessage\' | tisfTranslate}}</p><div ng-if="$ctrl.userHasExistingAppointments()"><hr class="my-appointments-hr"><div ng-repeat="appointment in $ctrl.existingAppointments | orderBy: [\'appointmentDateTime\', \'templeName\']" class="appointment-card" ng-class="{\'last-appointment-card\': $last, \'highlight\':$ctrl.shouldAppointmentBeHighlighted(appointment)}" ng-click="$ctrl.onAppointmentClick(appointment)" ng-if="appointment.shouldHide === false"><div class="appointment-card-content"><span class="bar appointment-bar"></span><div class="dropdown mobile-dropdown"><div class="btn-group action-btn-group" uib-dropdown is-open="status.isopen"><a class="icon menu-vertical-icon" ng-click="$ctrl.handleActionsButtonClick(appointment, $last)" uib-dropdown-toggle></a><action-menu appointment="appointment" share-appointment-url-map="$ctrl.shareAppointmentUrlMap" contact-info="$ctrl.contactInfo" delete-appointment-fn="$ctrl.deleteAppointment" existing-appointments="$ctrl.existingAppointments"></action-menu></div></div><p class="flush-bottom">{{appointment | tosAppointmentTime}}</p><p class="appointment-date flush-top">{{appointment.displayedAppointmentDate | localizeDateTime:\'dateShort\'}}</p><p class="flush-top">{{appointment.templeOrgId | tosTempleName}}</p><p class="appointment-arrival-time" ng-if="appointment.arrivalTime"><strong>{{\'finalizeAppointment.arrive.by\' | tisfTranslate:appointment.arrivalTime}}</strong></p><div><span style="font-size:0.875rem;">{{appointment.appointmentType | tosAppointmentType}}</span></div><div class="mobile-family-search-link" ng-if="$ctrl.isProxyOrdinance(appointment)" class="mobile-family-search-link"><a target="_blank" href="{{appointment.familySearchHref}}"><i class="icon print"></i> {{ \'myAppointments.printCardMobile\' | tisfTranslate }}</a></div><appointment-attendees appointment="appointment"></appointment-attendees><div ng-if="$ctrl.shouldDisableEditsAndCancellations(appointment)" class="not-editable-indicator"><tos-tooltip popover-position="\'auto top\'" icon-type="\'help\'" highlight-text="true" tooltip-label="$ctrl.notEditableLabel" tooltip-text="appointment.notEditableText"></tos-tooltip></div></div></div></div></div></tos-row></div></div>'),e.put("/app/modules/schedule/schedule-appointment.html",'<div ng-class><feedback-side-content appointment="$ctrl.appointment" current-step="$ctrl.currentStep"></feedback-side-content><tos-row><h2 class="landing-page-title no-margin-header col-xs-12"><div class="my-temple-appointments-link"><a class="icon-chevronleft-dark-blue text3" ng-click="$ctrl.handleMyAppointmentsLinkClick()" id="my-temple-appointments-link">{{\'myTempleAppointmentsLink\' | tisfTranslate}}</a></div><span>{{\'scheduleAnAppointmentTitle\' | tisfTranslate}}</span></h2></tos-row><tos-row><h3 class="no-margin-header">{{$ctrl.appointment.templeOrgId | tosTempleName}}</h3></tos-row><tos-row><div class="text3 progress-indicator" id="progress-indicator">{{\'stepNumberIndicator\' | tisfTranslate:[$ctrl.currentStep, $ctrl.totalSteps]}}</div></tos-row><tos-row><div class="schedule-appointment-spacer"></div></tos-row><tos-row ng-if="$ctrl.appointment"><tos-accordion id="tos-accordion" appointment="$ctrl.appointment" current-step="$ctrl.currentStep" total-steps="$ctrl.totalSteps"></tos-accordion></tos-row></div>'),e.put("/app/modules/schedule/temple-ordinance-invitation.html",'<div ng-class><tos-row><h2 class="landing-page-title col-xs-12 flush-bottom"><div class="my-temple-appointments-link"><a class="icon-chevronleft-dark-blue text3" ng-click="$ctrl.handleMyAppointmentsLinkClick()" id="my-temple-appointments-link">{{\'myTempleAppointmentsLink\' | tisfTranslate}}</a></div><span>{{ \'templeOrdinanceInvitation.title\' | tisfTranslate }}</span></h2></tos-row><tos-row><h3 class="flush-bottom">{{ \'templeOrdinanceInvitation.expiredOrCancelled\' | tisfTranslate }}</h3><span>{{ \'templeOrdinanceInvitation.optionText\' | tisfTranslate }}</span></tos-row><tos-row><button ng-click="$ctrl.goToScheduler()" class="primary" style="margin-top: 30px;">{{ \'templeOrdinanceInvitation.schedule.appointment\' | tisfTranslate}}</button></tos-row></div>'),e.put("/app/modules/user/remove-session.html","<div></div>"),e.put("/app/modules/common/modals/add-to-calendar-modal.html",'<div class="alert add-to-calendar-modal" role="alert"><modal-header can-dismiss="true" header-text="\'addToCalendar.title\' | tisfTranslate" icon="\'info-icon\'"></modal-header><div class="description"><p class="text3">{{\'addToCalendar.selectAnOption\' | tisfTranslate}}</p><p class="text4 semi-bold">{{\'addToCalendar.loggedInWarning\' | tisfTranslate}}</p><label ng-repeat="option in $ctrl.options" class="calendar-name-label" ng-class="{\'disabled-label\': option.isDisabled}"><input type="radio" ng-model="$ctrl.desiredCalendar" value="{{option.name}}" ng-disabled="option.isDisabled"> <span class="radio-label text3" ng-class="{\'disabled\': option.isDisabled}">{{option.name | tisfTranslate}}</span></label> <button ng-click="$close($ctrl.desiredCalendar)" ng-disabled="!$ctrl.desiredCalendar" class="add-button text3">{{\'addToCalendar.addButton\' | tisfTranslate}}</button></div></div>'),e.put("/app/modules/components/action-menu/action-menu.html",'<ul class="dropdown-menu action-menu" ng-class="{\'dropdown-menu-right\': $ctrl.isMobile()}" uib-dropdown-menu role="menu" aria-labelledby="single-button" id="{{\'action-menu-for-appointment-\' + $ctrl.appointment.id}}"><li ng-click="$ctrl.editAppointment()" ng-if="$ctrl.shouldShowEditMenuOption()" ng-disabled="$ctrl.shouldDisableEditsAndCancellations()" id="edit-appointment"><em class="icon edit-icon" ng-class="$ctrl.shouldDisableEditsAndCancellations() ? \'edit-icon-grey\' : \'edit-icon\'"></em> {{\'myAppointments.actionsEditAppointmentOption\' | tisfTranslate}}</li><li ng-if="$ctrl.shouldShowDeleteAppointmentOption()" ng-click="$ctrl.deleteAppointmentWithModal()" ng-disabled="$ctrl.shouldDisableEditsAndCancellations()" id="action-delete-appointment"><em class="icon edit-icon" ng-class="$ctrl.shouldDisableEditsAndCancellations() ? \'trash-can-icon-grey\' : \'trash-can-icon\'"></em> {{\'myAppointments.actionsDeleteAppointmentOption\' | tisfTranslate}}</li><li ng-if="$ctrl.isNonEditableOpOrdinance() && $ctrl.isOpPatron" ng-click="$ctrl.removePatronFromOpOrdinance()" id="action-remove-patron-from-appointment"><em class="icon trash-can-icon"></em> {{ \'myAppointments.removeMeFromAppointment\' | tisfTranslate }}</li><li ng-if="$ctrl.shouldShowRemoveMeAsGuestOption()" ng-click="$ctrl.removeGuestFromGroupAppointment()" id="action-remove-guest-from-appointment"><em class="icon trash-can-icon"></em> {{ \'myAppointments.removeMeAsGuest\' | tisfTranslate }}</li><li ng-click="$ctrl.addToCalendar($event)" id="action-add-to-calendar"><em class="icon calendar-icon"></em>&nbsp;{{\'myAppointments.actionsAddAppointmentToCalendarOption\' | tisfTranslate}}</li><li ng-if="$ctrl.shouldShowCopyShareableGroupLinkOption()" ng-disabled="!$ctrl.shareableLink" id="action-copy-shareable-link" data-clipboard-text="{{$ctrl.shareableLink}}" ng-click="$ctrl.showClipboardSuccessAlert()"><em class="icon share-icon" ng-if="$ctrl.shareableLink"></em> <em class="icon share-icon-grey" ng-if="!$ctrl.shareableLink"></em> {{\'appointmentScheduled.shareAppointment.copyShareableLink\' | tisfTranslate}}</li><li class="copy-link-menu-item" data-clipboard-text="{{$ctrl.shareAppointmentLink}}" ng-disabled="!$ctrl.shareAppointmentLink" ng-if="$ctrl.shouldShowCopyLinkOption()" ng-click="$ctrl.showClipboardSuccessAlert()"><em class="icon link-icon"></em> {{\'myAppointments.actionsCopyShareableLinkOption\' | tisfTranslate}}</li><li ng-if="$ctrl.shouldShowCopyInvitationDetailsOption()" ng-disabled="!$ctrl.appointmentInvitationDetails" id="action-copy-invitation-details" data-clipboard-text="{{$ctrl.appointmentInvitationDetails}}" ng-click="$ctrl.showClipboardSuccessAlert()"><em class="icon copy-icon" ng-if="$ctrl.appointmentInvitationDetails"></em> <em class="icon copy-icon-grey" ng-if="!$ctrl.appointmentInvitationDetails"></em> {{\'appointmentScheduled.shareAppointment.copyInvitationDetails\' | tisfTranslate}}</li><li ng-if="$ctrl.shouldShowSendEmailInvitationOption()" ng-click="$ctrl.sendEmailInvitation()" id="action-send-email-invitation" ng-disabled="!$ctrl.mailToEmailInvitation"><em class="icon edit-icon" ng-class="$ctrl.mailToEmailInvitation ? \'envelope-icon-icon\' : \'envelope-icon-icon-grey\'"></em> {{\'appointmentScheduled.shareAppointment.sendEmailInvitation\' | tisfTranslate}}</li><li ng-if="$ctrl.shouldShowSendConfirmationEmailOption()" ng-click="$ctrl.resendConfirmationEmail()" id="action-send-email-confirmation"><em class="icon envelope-icon"></em> {{\'myAppointments.actionsResendAppointmentConfirmationEmail\' | tisfTranslate}}</li></ul>'),e.put("/app/modules/components/appointment-attendees/appointment-attendees.html",'<div class="appointment-attendees"><div ng-if="!$ctrl.isAGroupAppointment() && !$ctrl.isLivingSealing()" class="attendees-group-text" ng-bind-html="$ctrl.getPatronNamesOnNewLines($ctrl.appointment)"></div><div ng-if="$ctrl.isLivingSealing()"><p class="attendees-group-text" ng-bind-html="$ctrl.getLivingSealingAttendees($ctrl.appointment)"></p><div ng-if="$ctrl.appointment.userIsScheduler"><a class="confirmed-guests-link attendees-group-text" popover-class="confirmed-guests" uib-popover-html="$ctrl.buildConfirmedGuestsHtml($ctrl.appointment)" popover-trigger="\'click outsideClick\'" popover-placement="right" guest-list="$ctrl.appointment.guestList">{{\'myAppointments.totalNumberOfAttendees\' | tisfTranslate:$ctrl.appointment.details.guestCount}}</a><div class="attendees-group-text">{{\'finalizeAppointment.maxNumberOfGuests\' | tisfTranslate:$ctrl.appointment.details.locationSeats}}</div></div></div><div ng-if="$ctrl.isAGroupAppointment() && !$ctrl.isLivingSealing()" class="attendee-group-info"><div class="attendees-group-text">{{\'appointmentDetails.groupName\' | tisfTranslate:$ctrl.appointment.details.groupName}}</div><div ng-if="!$ctrl.appointment.userIsScheduler" class="attendees-group-text">{{ \'myAppointments.iAmAGuest\' | tisfTranslate }}</div><div ng-if="$ctrl.appointment.userIsScheduler"><a class="confirmed-guests-link attendees-group-text" popover-class="confirmed-guests" uib-popover-html="$ctrl.buildConfirmedGuestsHtml($ctrl.appointment)" popover-trigger="\'click outsideClick\'" popover-placement="right" guest-list="$ctrl.appointment.guestList">{{$ctrl.getGroupLinkText($ctrl.appointment.details.guestCount)}}</a><div class="text4" ng-if="$ctrl.appointment.unconfirmedCount && $ctrl.appointment.unconfirmedCount > 0 && !$ctrl.isLivingOrdinances()"><a><tos-tooltip popover-position="\'auto top\'" icon-type="\'info\'" tooltip-label="$ctrl.unconfirmedTooltipLabel" tooltip-text="$ctrl.unconfirmedTooltipText"></tos-tooltip></a></div></div></div></div>'),e.put("/app/modules/components/feedback-question/feedback-question.html",'<div><p ng-show="$ctrl.question.questionType === \'PARENT\' && $ctrl.shouldShowQuestion()" class="parent-question">{{ $ctrl.question.appLookupKey | tisfTranslate }}</p><div ng-show="$ctrl.question.radioButtonQuestions && $ctrl.question.radioButtonQuestions.length > 0" class="non-parent-question feedback-radio-section"><div ng-repeat="radioButtonQuestion in $ctrl.question.radioButtonQuestions"><label class="feedback-radio-label"><input type="radio" class="feedback-radio-button" ng-model="$ctrl.feedbackResponse.scheduledStatus" value="{{radioButtonQuestion.appLookupKey === \'feedback.modal.ableToScheduleYes\' ? 1 : 0}}"> <span class="radio-label text3">{{ radioButtonQuestion.appLookupKey | tisfTranslate }}</span></label><div ng-repeat="childQuestion in radioButtonQuestion.childQuestions | orderBy: [\'questionOrder\']" ng-show="$ctrl.feedbackResponse.scheduledStatus === \'0\'" class="radio-button-child-question-section checkbox-section"><feedback-question question="childQuestion" feedback-response="$ctrl.feedbackResponse" parent-question="$ctrl.question"></feedback-question></div></div></div><div ng-show="$ctrl.question.questionType === \'PARENT_GOOD_BAD\'"><good-bad-rating-question question="$ctrl.question" feedback-response="$ctrl.feedbackResponse"></good-bad-rating-question><div ng-repeat="childQuestion in $ctrl.question.childQuestions | orderBy: [\'questionOrder\']" ng-show="$ctrl.shouldShowQuestion()" class="good-bad-rating-sub-questions checkbox-section"><feedback-question question="childQuestion" feedback-response="$ctrl.feedbackResponse" parent-question="$ctrl.question"></feedback-question></div></div><div ng-show="$ctrl.question.questionType !== \'PARENT_GOOD_BAD\'"><div ng-show="$ctrl.question.questionType.includes(\'CHECKBOX\')" class="non-parent-question checkbox-section"><label class="check-box-label"><input type="checkbox" ng-model="$ctrl.checked" ng-change="$ctrl.handleCheckboxChange()"> {{ $ctrl.question.appLookupKey | tisfTranslate }}</label> <input ng-show="$ctrl.question.questionType === \'CHECKBOX_TEXT\' && $ctrl.checked" ng-model="$ctrl.text" ng-change="$ctrl.handleTextValueChange()" class="other-checkbox-text-input" maxlength="250" type="text"></div><div ng-show="$ctrl.question.questionType === \'TEXTAREA\'" class="feedback-textarea-section"><label for="feedback-comments">{{ \'feedback.modal.additionalComments\' | tisfTranslate }}</label> <textarea rows="2" maxlength="500" ng-model="$ctrl.feedbackResponse.comments" id="feedback-comments" class="feedback-comments-textarea"></textarea><p class="feedback-comments-hint">{{ \'feedback.modal.additionalCommentsLimit\' | tisfTranslate }}</p></div><div ng-repeat="childQuestion in $ctrl.question.childQuestions | orderBy: [\'questionOrder\']" ng-show="$ctrl.shouldShowQuestion()"><feedback-question question="childQuestion" feedback-response="$ctrl.feedbackResponse" parent-question="$ctrl.question"></feedback-question></div></div></div>'),e.put("/app/modules/components/finalize-appointment/finalize-appointment.html",'<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 finalize-step"><div class="col-xs-12 col-sm-8 col-md-8 col-lg-8 col-xl-8"><p class="neutral-grey-font"><b>{{\'finalizeAppointment.contactInfo\' | tisfTranslate}}&nbsp; </b><span class="icon edit-icon-blue clickable" ng-click="$ctrl.onEditContactInfoClicked()" id="edit-contact-info-icon"></span><br><span ng-class="{\'text-danger\':!$ctrl.getContactName()}">{{$ctrl.getNameFieldText()}} </span><span class="informational-text-color" ng-if="$ctrl.isRecommendExpiringSoon() && $ctrl.appointment.contactInfo.recommend.status === \'ACTIVE\'">{{\'finalizeAppointment.recommendExpiration\' | tisfTranslate:$ctrl.recommendExpirationDate}} </span><span class="informational-text-color" ng-if="$ctrl.appointment.contactInfo.recommend.status !== \'ACTIVE\' && $ctrl.appointment.contactInfo && $ctrl.appointment.contactInfo.recommend">{{\'finalizeAppointment.recommendIsNotActive\' | tisfTranslate}}</span><br><span ng-class="{\'text-danger\':!$ctrl.getContactEmail()}">{{$ctrl.getEmailFieldText()}}</span><br><span>{{$ctrl.getPhoneNumberFieldText()}}</span> <span ng-if="$ctrl.usNumError && $ctrl.smsConfirmation" class="text-danger"><br>{{\'finalizeAppointment.mobileMustBeUSNumber\' | tisfTranslate}}</span></p><p><span><strong>{{\'finalizeAppointment.notifications\' | tisfTranslate }}</strong></span> <label class="second-checkbox finalize-check-box-label"><input type="checkbox" ng-model="$ctrl.emailConfirmation" id="send-confirmation-email"> &nbsp;{{\'finalizeAppointment.sendConfirmationEmail\' | tisfTranslate}}</label> <label class="second-checkbox finalize-check-box-label" ng-if="$ctrl.shouldShowMessagingControls && !$ctrl.isLivingOrdinance($ctrl.appointment.appointmentType)" ng-disabled="$ctrl.disableSmsCheckbox ||\n                                    ($ctrl.userHasSmsSubscriptionEntryForTemple && !$ctrl.userIsSubscribedToSmsForTemple)"><input type="checkbox" ng-model="$ctrl.smsConfirmation" ng-disabled="$ctrl.disableSmsCheckbox ||\n                                        ($ctrl.userHasSmsSubscriptionEntryForTemple && !$ctrl.userIsSubscribedToSmsForTemple)" id="send-confirmation-sms"> &nbsp;{{\'finalizeAppointment.sendSms\' | tisfTranslate}} <label class="finalize-check-box-label default-cursor" ng-disabled="$ctrl.disableSmsCheckbox ||\n                                        ($ctrl.userHasSmsSubscriptionEntryForTemple && !$ctrl.userIsSubscribedToSmsForTemple)">{{\'finalizeAppointment.sendSms.consent\' | tisfTranslate}}</label></label></p><div class="alert info no-margin in-page-alert description-only-alert-padding" ng-if="$ctrl.originalSmsConfirmation && !$ctrl.smsConfirmation" role="alert"><span class="alert-title flex-modal-title inline-flex"><span class="icon info-icon"></span><div class="description description-only-padding no-margin-description"><span>{{\'alert.disabledMessagingForAppointment\' | tisfTranslate:$ctrl.templeMessagingPhone}}</span></div></span></div><div class="alert info no-margin in-page-alert description-only-alert-padding" ng-if="$ctrl.userHasSmsSubscriptionEntryForTemple && !$ctrl.userIsSubscribedToSmsForTemple" role="alert"><span class="alert-title flex-modal-title inline-flex"><span class="icon info-icon"></span><div class="description description-only-padding no-margin-description"><span>{{\'alert.optedOutOfSms\' | tisfTranslate:[($ctrl.appointment.templeOrgId | tosTempleName), $ctrl.START_KEYWORD, $ctrl.templeMessagingPhone]}}</span></div></span></div><p></p><p></p><p><b ng-if="$ctrl.appointment.inclSpouse">{{\'finalizeAppointment.spouseAdded\' | tisfTranslate}}</b> <label ng-if="$ctrl.appointment.inclSpouse && $ctrl.indexOfSpouseGuest >= 0" class="second-checkbox finalize-check-box-label"><input type="checkbox" ng-model="$ctrl.appointment.guestList[$ctrl.indexOfSpouseGuest].guestEmailConfirmationFlg" id="send-spouse-confirmation-email"> &nbsp;{{\'finalizeAppointment.sendConfirmationEmail\' | tisfTranslate}}</label></p><p ng-if="$ctrl.appointment.appointmentType !== \'LIVING_SEALING\'" class="neutral-grey-font"><span ng-if="$ctrl.appointment.userIsScheduler"><strong>{{$ctrl.appointment.appointmentType | tosAppointmentType}}</strong></span> <span ng-if="!$ctrl.appointment.userIsScheduler"><strong>{{$ctrl.appointment.appointmentType | tosAppointmentTypeGuest}}</strong></span><br><span>{{$ctrl.appointment.templeOrgId | tosTempleName}}</span><br><span ng-if="$ctrl.appointment.userIsScheduler && $ctrl.isAGroupAppointment() && $ctrl.appointment.details.groupName">{{\'attendees.groupSummary\' | tisfTranslate:[$ctrl.appointment.details.groupName, $ctrl.getAttendeeCount()]}}<br></span><span ng-if="!$ctrl.appointment.userIsScheduler && $ctrl.isAGroupAppointment()">{{$ctrl.getGroupNameFieldText()}}<br></span><span>{{$ctrl.appointment.appointmentDateTime | localizeDateTime: \'date\'}}</span><br><span>{{$ctrl.appointment.appointmentDateTime | localizeDateTime: \'time\'}}</span><br><span ng-if="$ctrl.arrivalTime"><strong>{{\'finalizeAppointment.arrive.by\' | tisfTranslate: $ctrl.arrivalTime}}</strong></span></p><p ng-if="$ctrl.appointment.appointmentType === \'LIVING_SEALING\'" class="neutral-grey-font"><span ng-if="$ctrl.appointment.userIsScheduler"><strong>{{ $ctrl.getSealingTypeMessage() }}</strong></span> <span ng-if="!$ctrl.appointment.userIsScheduler"><strong>{{$ctrl.appointment.appointmentType | tosAppointmentTypeGuest}}</strong></span><br><span>{{ $ctrl.getMaleAdultName() }}</span><br><span>{{ $ctrl.getFemaleAdultName() }}</span><br><span ng-if="$ctrl.shouldShowChildrenAndObservers()" ng-repeat="child in $ctrl.getChildrenForSealing()">{{\'scheduleAppointment.sealing.child\' | tisfTranslate: $ctrl.getChildName(child) }}<br></span><span ng-if="$ctrl.shouldShowChildrenAndObservers()" ng-repeat="observer in $ctrl.getObserversForSealing()">{{\'scheduleAppointment.sealing.observer\' | tisfTranslate: $ctrl.getChildName(observer) }}<br></span><span ng-if="$ctrl.appointment.userIsScheduler"><br>{{\'finalizeAppointment.estimatedNumberOfGuests\' | tisfTranslate: $ctrl.appointment.details.guestCount || 0 }}<br></span><span ng-if="$ctrl.appointment.userIsScheduler">{{\'finalizeAppointment.maxNumberOfGuests\' | tisfTranslate: $ctrl.appointment.livingSealingSeatCount || $ctrl.appointment.details.locationSeats || 0 }}<br></span><br><span>{{$ctrl.appointment.templeOrgId | tosTempleName}}</span><br><span>{{$ctrl.getDisplayedAppointmentDateTime() | localizeDateTime: \'date\'}}</span><br><span>{{$ctrl.getDisplayedAppointmentDateTime() | localizeDateTime: \'time\'}}</span><br><br><span ng-if="$ctrl.arrivalTime"><strong>{{\'finalizeAppointment.arrive.by\' | tisfTranslate: $ctrl.arrivalTime}}</strong></span><br><br><b class="special-requests-title" ng-if="$ctrl.appointment.appointmentType === \'LIVING_SEALING\'">{{\'finalizeAppointment.ordinanceLanguage\' | tisfTranslate:$ctrl.getLanguageLabel() }}</b></p><p ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM"><span>{{\'finalizeAppointment.malesToBeBaptized\' | tosCountMessage:$ctrl.appointment.details.malePatronCount}}</span><br><span>{{\'finalizeAppointment.femalesToBeBaptized\' | tosCountMessage:$ctrl.appointment.details.femalePatronCount}}</span><br><br><span>{{\'finalizeAppointment.numberOfMalesToHelpWithBaptisms\' | tosCountMessage:$ctrl.appointment.details.malesToAssistCount}}</span><br><span>{{\'finalizeAppointment.numberOfEndowedMalesToHelpWithConfirmations\' | tosCountMessage:$ctrl.appointment.details.endowedMaleCount}}</span><br><span>{{\'finalizeAppointment.numberOfFemalesToAssistInTheBaptistry\' | tosCountMessage:$ctrl.appointment.details.femalesToAssistCount}}</span></p><div class="special-requests-section"><p ng-if="!$ctrl.ordinanceLanguage && $ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_ENDOWMENT">{{\'finalizeAppointment.ordinanceLanguagePreference\' | tisfTranslate}}</p><p><b class="special-requests-title" ng-if="$ctrl.ordinanceLanguage && $ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_ENDOWMENT">{{\'finalizeAppointment.ordinanceLanguage\' | tisfTranslate:$ctrl.ordinanceLanguage}} </b><label class="second-checkbox check-box-label" ng-if="(($ctrl.ordinanceLanguage ||\n                            $ctrl.appointment.appointmentType\n                                !== $ctrl.AppointmentType.PROXY_ENDOWMENT) && $ctrl.appointment.inclSelf)\n                                && $ctrl.appointment.appointmentType !== $ctrl.AppointmentType.LIVING_SEALING"><input type="checkbox" ng-model="$ctrl.languageAssistanceNeeded" id="language-assistance-checkbox"> {{\'finalizeAppointment.needLanguageAssistance\' | tisfTranslate}}</label> <span ng-if="(($ctrl.languageAssistanceNeeded && $ctrl.appointment.inclSelf) ||\n                (!$ctrl.ordinanceLanguage && $ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_ENDOWMENT && $ctrl.appointment.inclSelf))\n                && $ctrl.appointment.appointmentType !== \'LIVING_SEALING\'" ng-class="{\'language-selection-container\': !!$ctrl.ordinanceLanguage}"><select class="text-box" ng-class="{\'margin-8-bottom\': !$ctrl.ordinanceLanguage}" ng-model="$ctrl.guestLanguage" ng-options="item.value as item.label for item in $ctrl.languages" aria-label="{{ \'finalizeAppointment.defaultLanguagePlaceholder\' | tisfTranslate}}"><option value="">{{\'finalizeAppointment.defaultLanguagePlaceholder\' | tisfTranslate}}</option></select><br><br ng-if="$ctrl.ordinanceLanguage"></span><label class="second-checkbox check-box-label" ng-if="($ctrl.ordinanceLanguage || $ctrl.appointment.appointmentType !== $ctrl.AppointmentType.PROXY_ENDOWMENT) &&\n                       $ctrl.appointment.inclSpouse && $ctrl.spouseHasEmail"><input type="checkbox" ng-model="$ctrl.spouseLanguageAssistanceNeeded" id="spouse-language-assistance-checkbox"> &nbsp;{{\'finalizeAppointment.spouseNeedsLanguageAssistance\' | tisfTranslate}}</label> <span ng-if="($ctrl.spouseLanguageAssistanceNeeded && $ctrl.appointment.inclSpouse) ||\n                (!$ctrl.ordinanceLanguage && $ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_ENDOWMENT &&\n                $ctrl.appointment.inclSpouse && $ctrl.spouseHasEmail)" ng-class="{\'language-selection-container\': !!$ctrl.ordinanceLanguage}"><select class="text-box" ng-model="$ctrl.spouseLanguage" ng-options="item.value as item.label for item in $ctrl.languages" aria-label="{{ \'finalizeAppointment.defaultSpouseLanguagePlaceholder\' | tisfTranslate}}"><option value="">{{ \'finalizeAppointment.defaultSpouseLanguagePlaceholder\' | tisfTranslate}}</option></select></span></p></div><p ng-bind-html="\'finalizeAppointment.specialNeedsMessage\' | tisfTranslate:\'<span class=\\\'temple-phone-number\\\'>\' + $ctrl.templePhoneNumber + \'</span>\'"></p></div><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 schedule-appointment-button-section"><p class="baptism-card-expectation-messages" ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM">{{\'finalizeAppointment.baptismCardNumberExpectationMessage\' | tisfTranslate}}<br>{{\'finalizeAppointment.endowedFamilyCardMessage\' | tisfTranslate}}</p><p ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_INITIATORY">{{\'finalizeAppointment.initiatoryCardNumberExpectationMessage\' | tisfTranslate}}</p><button ng-click="$ctrl.scheduleAppointment()" ng-disabled="$ctrl.shouldDisableScheduleAppointmentButton()" id="save-appointment-button">{{$ctrl.getScheduleButtonText()}}</button></div></div>'),e.put("/app/modules/components/good-bad-rating-question/good-bad-rating-question.html",'<div class="good-bad-rating-section"><p class="parent-question">{{ $ctrl.question.appLookupKey | tisfTranslate }}</p><div><label class="emotion-option"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="presentation" class="emotion-icon" style="height: 40px; width: 40px;"><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'GOOD\' ? \'#157493\' : \'black\'}}" d="M12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5ZM12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" clip-rule="evenodd" fill-rule="evenodd"></path><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'GOOD\' ? \'#157493\' : \'black\'}}" d="M17 9.5C17 10.33 16.33 11 15.5 11C14.67 11 14 10.33 14 9.5C14 8.67 14.67 8 15.5 8C16.33 8 17 8.67 17 9.5ZM8.5 11C9.33 11 10 10.33 10 9.5C10 8.67 9.33 8 8.5 8C7.67 8 7 8.67 7 9.5C7 10.33 7.67 11 8.5 11Z" clip-rule="evenodd" fill-rule="evenodd"></path><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'GOOD\' ? \'#157493\' : \'black\'}}" d="M12 18.25C14.3646 18.25 16.4225 16.9368 17.4843 15C17.7996 14.4248 17.5 14 17 14H7C6.5 14 6.24163 14.5 6.51573 15C7.57748 16.9368 9.63539 18.25 12 18.25Z"></path></svg> <input type="radio" ng-model="$ctrl.feedbackResponse.schedulingExperienceRating" value="GOOD"></label> <label class="emotion-option"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="presentation" class="emotion-icon" style="height: 40px; width: 40px;"><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'OKAY\' ? \'#157493\' : \'black\'}}" d="M12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5ZM12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" clip-rule="evenodd" fill-rule="evenodd"></path><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'OKAY\' ? \'#157493\' : \'black\'}}" d="M7.25 15.5C7.25 15.0858 7.58579 14.75 8 14.75H16C16.4142 14.75 16.75 15.0858 16.75 15.5C16.75 15.9142 16.4142 16.25 16 16.25H8C7.58579 16.25 7.25 15.9142 7.25 15.5Z" clip-rule="evenodd" fill-rule="evenodd"></path><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'OKAY\' ? \'#157493\' : \'black\'}}" d="M8.5 8C7.67157 8 7 8.67157 7 9.5C7 10.3284 7.67157 11 8.5 11C9.32843 11 10 10.3284 10 9.5C10 8.67157 9.32843 8 8.5 8ZM15.5 8C14.6716 8 14 8.67157 14 9.5C14 10.3284 14.6716 11 15.5 11C16.3284 11 17 10.3284 17 9.5C17 8.67157 16.3284 8 15.5 8Z" clip-rule="evenodd" fill-rule="evenodd"></path></svg> <input type="radio" ng-model="$ctrl.feedbackResponse.schedulingExperienceRating" value="OKAY"></label> <label class="emotion-option"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="presentation" class="emotion-icon" style="height: 40px; width: 40px;"><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'BAD\' ? \'#157493\' : \'black\'}}" d="M17.0202 17.1282C17.3671 16.9019 17.465 16.4373 17.2388 16.0903C16.1249 14.3819 14.1948 13.2499 12 13.2499C9.80517 13.2499 7.87513 14.3819 6.76121 16.0903C6.53498 16.4373 6.63286 16.9019 6.97983 17.1282C7.32681 17.3544 7.79149 17.2565 8.01772 16.9095C8.8665 15.6078 10.3333 14.7499 12 14.7499C13.6667 14.7499 15.1335 15.6078 15.9823 16.9095C16.2085 17.2565 16.6732 17.3544 17.0202 17.1282Z" clip-rule="evenodd" fill-rule="evenodd"></path><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'BAD\' ? \'#157493\' : \'black\'}}" d="M8.5 8C7.67158 8 7 8.67157 7 9.5C7 10.3284 7.67158 11 8.5 11C9.32843 11 10 10.3284 10 9.5C10 8.67157 9.32843 8 8.5 8ZM15.5 8C14.6716 8 14 8.67157 14 9.5C14 10.3284 14.6716 11 15.5 11C16.3284 11 17 10.3284 17 9.5C17 8.67157 16.3284 8 15.5 8Z" clip-rule="evenodd" fill-rule="evenodd"></path><path fill="{{$ctrl.feedbackResponse.schedulingExperienceRating === \'BAD\' ? \'#157493\' : \'black\'}}" d="M12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5ZM12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" clip-rule="evenodd" fill-rule="evenodd"></path></svg> <input type="radio" ng-model="$ctrl.feedbackResponse.schedulingExperienceRating" value="BAD"></label></div></div>'),e.put("/app/modules/components/modal-header/modal-header.html",'<h3 controller class="title alert-title flex-modal-title"><span class="inline-flex"><span ng-if="$ctrl.updateIncludeIcon" class="icon {{$ctrl.iconClass}}"></span> <span ng-class="{\'flex-modal-title-text\': $ctrl.leftAlignTitle !== false}">{{ $ctrl.headerText }} </span></span><span class="icon close-icon alert-close-button" ng-if="$ctrl.canDismiss" ng-click="$ctrl.closeModal()"></span></h3>'),e.put("/app/modules/components/ordinance-selector/ordinance-selector.html",'<div><div ng-show="$ctrl.showSpinner" ng-class="{\'currently-loading\': $ctrl.showSpinner}"><span class="loading-spinner"></span></div><div><span class="text4">{{\'ordinanceSelector.title\' | tisfTranslate}}</span></div><div id="schedule-item-container" class="schedule-item-container"><div class="disabled-ordinance-message" ng-if="!$ctrl.userHasRecommend()">{{\'ordinanceSelector.userRecommendInactiveMessage\' | tisfTranslate}}</div><div class="disabled-ordinance-message" ng-if="$ctrl.userHasRecommend() && !$ctrl.userIsEndowed && !$ctrl.userEndowmentIsScheduled">{{\'ordinanceSelector.userNotEndowedMessage\' | tisfTranslate}}</div><div class="disabled-ordinance-warning" ng-if="$ctrl.userHasRecommend() && !$ctrl.userIsEndowed && $ctrl.userEndowmentIsScheduled"><span class="icon warning-icon" style="padding-right: 5px;"></span><b>{{\'ordinanceSelector.userPendingEndowmentWarning\' | tisfTranslate}}</b></div><div id="schedule-item" class="schedule-item" ng-repeat="ordinanceOption in $ctrl.getProxyOrdinances()" ng-click="$ctrl.onOrdinanceClicked(ordinanceOption)" ng-disabled="!ordinanceOption.onlineSchedulingAvailable || !ordinanceOption.isEnabledForUser" ng-if="$ctrl.isProxyOrdinance(ordinanceOption.appointmentType)"><span class="icon icon-checkmarkdone" ng-if="$ctrl.previouslySelectedOrdinanceType === ordinanceOption.appointmentType"></span> <span class="schedule-item-text" uib-popover-html="$ctrl.getPopoverHtml()" popover-class="disabled-ordinance-message" popover-animation="true" popover-trigger="\'mouseenter\'" popover-popup-delay="500" popover-enable="!ordinanceOption.onlineSchedulingAvailable || !ordinanceOption.isEnabledForUser"><span class="ordinance-type-and-status">{{ordinanceOption.appointmentType | tosAppointmentType}}</span><span class="ordinance-type-and-status">&nbsp;{{$ctrl.getOrdinanceSchedulingStatusOfAppointmentType(ordinanceOption)}}</span></span></div></div><div><br><span class="text4">{{\'ordinanceSelector.livingOrdinanceMessageTitle\' | tisfTranslate}}</span></div><div class="schedule-item-container"><div ng-if="!$ctrl.shouldShowLivingOrdinances"><div><span>{{\'ordinanceSelector.showLivingOrdinancesText\' | tisfTranslate}}</span> <span><span class="show-living-ordinances" ng-click="$ctrl.enableLivingOrdinances()">{{\'ordinanceSelector.showLivingOrdinancesLink\' | tisfTranslate}}</span></span></div></div><div ng-if="$ctrl.shouldShowLivingOrdinances"><div ng-if="$ctrl.shouldShowThisOrdinanceType(ordinanceOption)" class="schedule-item" ng-repeat="ordinanceOption in $ctrl.getLivingOrdinances()" ng-click="$ctrl.onOrdinanceClicked(ordinanceOption)" ng-disabled="!$ctrl.shouldAllowOrdinanceTypeToBeScheduled(ordinanceOption)"><span class="icon icon-checkmarkdone" ng-if="$ctrl.previouslySelectedOrdinanceType === ordinanceOption.appointmentType"></span> <span class="schedule-item-text"><span class="ordinance-type-and-status">{{ordinanceOption.appointmentType | tosAppointmentType}}</span><span class="ordinance-type-and-status">&nbsp;{{$ctrl.getOrdinanceSchedulingStatusOfAppointmentType(ordinanceOption)}}</span><br><span class="licensed-marriage-warning" ng-if="$ctrl.showLicensedMarriageWarning(ordinanceOption)">{{\'ordinanceSelector.licensedMarriageWarning\' | tisfTranslate}}</span> <span class="non-sloq-warning" ng-if="$ctrl.showInvalidSloqOnlineWarning(ordinanceOption)">{{\'ordinanceSelector.cannotScheduleOnline\' | tisfTranslate}}</span></span><div ng-if="$ctrl.unitIsSloqEnabledButUserNotReady(ordinanceOption)" class="living-ordinance-type-message"><div class="text4 bold">{{$ctrl.getOrdinanceNotAllowedToScheduleLabel(ordinanceOption.appointmentType)}}</div><div><span class="text4 bold">{{\'ordinanceSelector.sloq.ordinance.not.allowed.to.schedule.go.to.ordinance.prep\' | tisfTranslate}}</span></div></div></div><div ng-if="$ctrl.sloqEnabledOrdinances.length == 0 && $ctrl.livingOrdinancesAllowed()" class="living-ordinance-type-message"><div class="text4">{{\'ordinanceSelector.sloq.ordinance.no.activeOrdinances\' | tisfTranslate}}</div><br><div class="text4">{{\'ordinanceSelector.sloq.executiveSecretary.name\' | tisfTranslate:$ctrl.execSecretaryName}}</div><div class="text4">{{\'misc.phone.number\' | tisfTranslate:$ctrl.execSecretaryPhone}}</div></div><div ng-if="!$ctrl.livingOrdinancesAllowed()" class="living-ordinance-type-message"><div class="text4">{{$ctrl.templeOrgId | livingOrdinancesMessage}}</div><div class="text4">{{$ctrl.templeEmail}}</div><div class="text4">{{$ctrl.templePhoneNumber}}</div></div></div></div></div>'),e.put("/app/modules/components/session-selector/appointment-date-selector.html",'<div class="appointment-date-selector-container"><div class="row"><div class="col-xs-4 col-sm-2 total-attendees-section" ng-if="$ctrl.appointmentTypeAllowsGroups() && $ctrl.appointmentType !== \'LIVING_SEALING\'"><p class="text4 total-attendees-title">{{\'scheduleAppointment.totalAttendees\' | tisfTranslate}}</p><div class="attendee-count-indicator" ng-if="$ctrl.appointment.details.guestCount || $ctrl.appointment.details.guestCount === 0"><i class="icon-profile"></i><p class="h2">{{$ctrl.getAttendeeCount()}}</p></div></div><div class="col-xs-12" ng-class="{\'col-sm-10\': $ctrl.appointmentTypeAllowsGroups() && $ctrl.appointmentType !== \'LIVING_SEALING\'}"><span class="text4">{{\'appointmentDateLabel\' | tisfTranslate}} </span><button id="secondSelect" name="secondSelect" class="calendar-date-select" ng-class="{\'calendar-select-new-date\': $ctrl.reloadAppointmentTimes()}" value="{{$ctrl.currentDateString}}" ng-click="$ctrl.toggleCalendarOpen()" ng-disabled="$ctrl.disableSessionSelection"><span>{{$ctrl.showCurrentDateString()}} </span><span class="temple-appointment-calendar-icon calendar-icon-for-calendar"><svg class="calendar-graphic" viewBox="0 0 32 32"><g><path d="M25.263 4.211h5.053v26.104c0 0.931-0.749 1.686-1.672 1.686h-26.971c-0.923 0-1.672-0.749-1.672-1.686v-26.104h5.053v-2.511c0-0.938 0.748-1.699 1.684-1.699 0.93 0 1.684 0.746 1.684 1.699v2.511h13.474v-2.511c0-0.938 0.748-1.699 1.684-1.699 0.93 0 1.684 0.746 1.684 1.699v2.511zM2.526 29.474h25.263v-17.684h-25.263v17.684zM5.053 21.053h6.737v-6.737h-6.737v6.737z"></path></g></svg></span></button></div></div><div class="temple-appointment-calendar"><div class="calendar-element" tabindex="0" id="calendar-element" data-visible="{{$ctrl.openCalendar}}"><button class="calendar-close-button" ng-click="$ctrl.toggleCalendarOpen()"><span class="temple-appointment-calendar-icon calendar-vertically-aligned-icon"><svg class="calendar-graphic" viewBox="0 0 32 32"><g><path d="M18.365 16l11.313 11.313c0.724 0.724 0.721 1.89 0 2.611-0.726 0.726-1.89 0.721-2.611-0l-11.313-11.313-11.313 11.313c-0.724 0.724-1.89 0.721-2.611 0-0.726-0.726-0.721-1.89 0-2.611l11.313-11.313-11.313-11.313c-0.724-0.724-0.721-1.89-0-2.611 0.726-0.726 1.89-0.721 2.611 0l11.313 11.313 11.313-11.313c0.724-0.724 1.89-0.721 2.611-0 0.726 0.726 0.721 1.89-0 2.611l-11.313 11.313z"></path></g></svg></span></button><div class="calendar-month-box"><button class="calendar-month-button" ng-class="{\'visibility-hidden\': !$ctrl.shouldShowPreviousMonthButton()}" ng-click="$ctrl.goToPreviousMonth()" ng-disabled="!$ctrl.currentMonthSchedule"><span class="temple-appointment-calendar-icon calendar-vertically-aligned-icon"><svg class="calendar-graphic" style="fill:#157493;" viewBox="0 0 32 32"><g><path d="M10.37 15.283c-0.404 0.393-0.404 1.041 0 1.434l7.2 7c0.396 0.385 1.029 0.376 1.414-0.020s0.376-1.029-0.020-1.414l-6.477-6.269 6.477-6.297c0.396-0.385 0.405-1.018 0.020-1.414s-1.018-0.405-1.414-0.020l-7.2 7z"></path></g></svg></span></button> <span class="calendar-title">{{$ctrl.getCurrentMonthAndYearText()}} </span><button class="calendar-month-button" ng-click="$ctrl.goToNextMonth()" ng-disabled="!$ctrl.currentMonthSchedule" ng-class="{\'visibility-hidden\': $ctrl.hideNextMonthArrow}"><span class="temple-appointment-calendar-icon calendar-vertically-aligned-icon"><svg class="calendar-graphic" style="fill:#157493;" viewBox="0 0 32 32"><g><path d="M21.63 16.717c0.404-0.393 0.404-1.041 0-1.434l-7.2-7c-0.396-0.385-1.029-0.376-1.414 0.020s-0.376 1.029 0.020 1.414l6.477 6.269-6.477 6.297c-0.396 0.385-0.405 1.018-0.020 1.414s1.018 0.405 1.414 0.020l7.2-7z"></path></g></svg></span></button></div><span class="calendar-selected-date">{{\'scheduleAppointment.currentSelectedDateTitle\' | tisfTranslate}} </span><span class="calendar-selected-date">{{$ctrl.currentDateString}}</span><div class="calendar-day-row"><div ng-repeat="dayOfTheWeek in $ctrl.daysOfTheWeek" class="calendar-cell calendar-day-cell calendar-week-day">{{dayOfTheWeek}}</div><div ng-if="!$ctrl.currentMonthSchedule || !$ctrl.hideSpinner"><span class="spinner-icon"></span></div><div class="calendar-grid" ng-if="$ctrl.currentMonthSchedule"><button ng-repeat="day in $ctrl.currentMonthSchedule.days track by $index" id="{{$ctrl.currentMonthSchedule.month + \'/\' + day.dayOfMonth + \'/\' + $ctrl.currentMonthSchedule.year}}" data-date="{{$ctrl.getCalendarDayTitleText(day)}}" title="{{$ctrl.getCalendarDayTitleText(day)}}" class="calendar-cell" ng-class="{\'calendar-open-day\': $ctrl.templeOpenNoApptsAvail(day), \'calendar-ordinance-available\': $ctrl.templeOpenApptsAvail(day), \'calendar-past-day\': $ctrl.isVisiblePastDay(day), \'visibility-hidden\': $ctrl.isHiddenPastDay(day)}" ng-click="$ctrl.selectAppointmentDate(day)"><b ng-if="$ctrl.isSelectedDay(day)">{{day.dayOfMonth}}</b> <span ng-if="!$ctrl.isSelectedDay(day)">{{day.dayOfMonth}}</span></button></div><div class="calendar-key"><div><div class="calendar-cell calendar-ordinance-available"></div><span class="calendar-legend-item">{{\'selectAppointmentTime.onlineAppointmentsAvailable\' | tisfTranslate}}</span></div><div><div class="calendar-cell calendar-day-cell calendar-open-day"></div><span class="calendar-legend-item">{{\'selectAppointmentTime.templeOpen\' | tisfTranslate}}</span></div><div><div class="calendar-cell calendar-past-day"></div><span class="calendar-legend-item">{{\'selectAppointmentTime.templeClosed\' | tisfTranslate}}</span></div></div></div></div></div></div>'),e.put("/app/modules/components/session-selector/appointment-options.html",'<div class="appointment-options"><current-appointment appointment="$ctrl.appointment" is-edit="$ctrl.isEdit"></current-appointment><div class="align-base-line" style="flex-direction: column"><p class="text4" ng-show="$ctrl.ordinanceConfig && $ctrl.ordinanceConfig.appointmentType !== \'PROXY_BAPTISM\' && $ctrl.ordinanceConfig.appointmentType !== \'LIVING_SEALING\'">{{\'scheduleAppointment.selectAttendeesLabel\' | tisfTranslate}}</p><p class="text4" ng-show="$ctrl.ordinanceConfig && $ctrl.ordinanceConfig.appointmentType === \'PROXY_BAPTISM\'">{{\'scheduleAppointment.selectAttendeesLabel\' | tisfTranslate: $ctrl.getMaxOnlineGroupSize() }}</p><div class="sealing-participant-list" ng-if="$ctrl.ordinanceConfig && $ctrl.ordinanceConfig.appointmentType === \'LIVING_SEALING\'"><p class="bold text4">{{ $ctrl.getSealingTypeMessage() }}</p><ul class="text3"><li>{{ $ctrl.getMaleAdultName() }}</li><li>{{ $ctrl.getFemaleAdultName() }}</li></ul><ul class="text3" style="margin-top: 1rem!important;" ng-if="$ctrl.shouldShowChildrenAndObservers()"><li ng-repeat="child in $ctrl.getChildrenForSealing()">{{\'scheduleAppointment.sealing.child\' | tisfTranslate: $ctrl.getChildName(child) }}</li><li ng-repeat="observer in $ctrl.getObserversForSealing()">{{\'scheduleAppointment.sealing.observer\' | tisfTranslate: $ctrl.getChildName(observer) }}</li></ul></div><div class="sealing-participant-list sealing-group-message" ng-if="$ctrl.ordinanceConfig && $ctrl.ordinanceConfig.appointmentType === \'LIVING_SEALING\'"><p class="text4">{{\'scheduleAppointment.sealing.groupSize.header\' | tisfTranslate }}</p><p class="text3">{{\'scheduleAppointment.sealing.groupSize.message\' | tisfTranslate }}</p></div><p ng-if="$ctrl.noPrimaryAttendeesAreAdded()"><span class="icon alert-error-icon"></span> <strong class="danger-notice">{{\'scheduleAppointment.oneAttendeeRequiredWarning\' | tisfTranslate}}</strong></p><div ng-if="$ctrl.shouldShowPrimaryContactCheckbox()"><label class="check-box-label larger-label-font-size" ng-class="{\'has-error\': $ctrl.noPrimaryAttendeesAreAdded()}" ng-disabled="$ctrl.disableElementWhileLoad"><input id="myself-checkbox" type="checkbox" ng-model="$ctrl.inclSelf" ng-disabled="$ctrl.disableElementWhileLoad || !$ctrl.shouldShowAddToSpouseCheckbox() || $ctrl.appointment.appointmentType.includes(\'LIVING\')"> {{\'scheduleAppointment.attending.self\' | tisfTranslate}}<span ng-if="$ctrl.noPrimaryAttendeesAreAdded()">&nbsp;*</span></label></div><div ng-if="$ctrl.shouldShowAddToSpouseCheckbox()"><label class="check-box-label larger-label-font-size" ng-class="{\'has-error\': $ctrl.noPrimaryAttendeesAreAdded()}" ng-disabled="$ctrl.disableElementWhileLoad"><input id="spouse-checkbox" type="checkbox" ng-model="$ctrl.inclSpouse" ng-disabled="$ctrl.disableElementWhileLoad"> {{\'scheduleAppointment.attending.spouse\' | tisfTranslate}}<span ng-if="$ctrl.noPrimaryAttendeesAreAdded()">&nbsp;*</span></label></div></div><div ng-if="$ctrl.ordinanceConfig.appointmentType === \'LIVING_SEALING\'" class="row male-female-group-count-options living-sealing-group-name no-padding-left"><div class="col-xs-12 no-padding-right group-name-container no-padding-left living-sealing-language"><p><label class="no-padding-left">{{\'scheduleAppointment.sealing.estimated.number.of.guests\' | tisfTranslate}} <span ng-class="{\'has-error\': !$ctrl.additionalGuestCountIsValid($ctrl.appointment.additionalGuestCount, $ctrl.appointment.appointmentType)}"><input id="living-sealing-estimated-guest-input" class="form-control" ng-model="$ctrl.appointment.additionalGuestCount" type="number" min="0" max="10000" ng-change="$ctrl.handleGroupPatronCountChange()"></span></label></p><label class="no-padding-left">{{\'scheduleAppointment.sealing.language\' | tisfTranslate}} <select id="living-sealing-language-input" class="text-box form-control living-sealing-language-input" ng-model="$ctrl.appointment.language" ng-options="item.value as item.label for item in $ctrl.languages" aria-label="{{ \'finalizeAppointment.defaultLanguagePlaceholder\' | tisfTranslate}}"><option value="">{{\'finalizeAppointment.defaultLanguagePlaceholder\' | tisfTranslate}}</option></select></label></div></div><div ng-if="$ctrl.appointmentTypeAllowsGroups() && $ctrl.ordinanceConfig.maxNumberOfGuests"><label class="check-box-label larger-label-font-size" ng-disabled="$ctrl.disableElementWhileLoad"><input id="additional-people-checkbox" type="checkbox" ng-model="$ctrl.inclGuests" ng-disabled="$ctrl.disableElementWhileLoad ||\n                                $ctrl.appointment.appointmentType === $ctrl.AppointmentType.LIVING_ENDOWMENT"> {{\'scheduleAppointment.additionalPeople\' | tisfTranslate}}</label></div><div ng-class="{\'has-error\': $ctrl.noAdditionalGuestsMessageKeyIsInErrorState}" ng-if="$ctrl.getNoAdditionalGuestsMessageKey()"><p class="help-block"><span>{{$ctrl.getNoAdditionalGuestsMessageKey() | tisfTranslate}}</span></p></div><div class="guest-options"><div ng-if="$ctrl.inclGuests && $ctrl.appointment.appointmentType !== $ctrl.AppointmentType.LIVING_SEALING" class="row male-female-group-count-options"><div ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.LIVING_ENDOWMENT"><span class="escort-span">{{\'scheduleAppointment.escort.label\' | tisfTranslate}} <a uib-popover="{{\'scheduleAppointment.escort.tooltip\' | tisfTranslate}}" popover-trigger="\'outsideClick\'" popover-placement="top" popover-append-to-body="true" popover-class="popover-width" data-html="true"><span class="icon info-icon popover-icon-size escort-icon"></span></a></span><div class="escort-radio-section"><label class="escort-radio-button"><input type="radio" ng-model="$ctrl.appointment.details.needsTempleEscort" ng-value="false"> <span class="radio-label">{{\'scheduleAppointment.escort.bringOwnEscort\' | tisfTranslate}}</span></label> <label class="escort-radio-button"><input type="radio" ng-model="$ctrl.appointment.details.needsTempleEscort" ng-value="true"> <span class="radio-label">{{\'scheduleAppointment.escort.needTempleEscort\' | tisfTranslate}}</span></label></div><div class="col-xs-3 col-sm-4 number-of-guests-container no-padding-right" ng-class="{\'has-error\': $ctrl.attendeeCountExceedsLimit()}"><label class="margin-8-right">{{\'scheduleAppointment.numberOfGuests\' | tisfTranslate}} <span ng-class="{\'has-error\': !$ctrl.additionalGuestCountIsValid($ctrl.appointment.additionalGuestCount, $ctrl.appointment.appointmentType)}"><input id="additional-guests-checkbox" class="form-control" ng-model="$ctrl.appointment.additionalGuestCount" type="number" min="1" max="10000" ng-change="$ctrl.handleGroupPatronCountChange()"></span></label><p class="help-block additional-attendee-limit-message" ng-if="$ctrl.ordinanceConfig">{{\'scheduleAppointment.additionalAttendeeLimit\' | tisfTranslate: $ctrl.ordinanceConfig.maxNumberOfGuests}}</p></div></div><div ng-if="$ctrl.appointment.appointmentType !== $ctrl.AppointmentType.LIVING_ENDOWMENT"><div class="col-xs-3 col-sm-4 number-of-guests-container no-padding-right" ng-class="{\'has-error\': $ctrl.attendeeCountExceedsLimit()}"><label class="margin-8-right">{{\'scheduleAppointment.numberOfMaleAttendees\' | tisfTranslate}} <span ng-class="{\'has-error\': !$ctrl.additionalGuestCountIsValid($ctrl.appointment.additionalMaleGuestCount, $ctrl.appointment.appointmentType)}"><input id="additional-male-checkbox" class="form-control" ng-model="$ctrl.appointment.additionalMaleGuestCount" type="number" min="0" max="10000" ng-change="$ctrl.handleGroupPatronCountChange()"></span></label> <label>{{\'scheduleAppointment.numberOfFemaleAttendees\' | tisfTranslate}} <span ng-class="{\'has-error\': !$ctrl.additionalGuestCountIsValid($ctrl.appointment.additionalFemaleGuestCount, $ctrl.appointment.appointmentType)}"><input id="additional-female-checkbox" class="form-control" ng-model="$ctrl.appointment.additionalFemaleGuestCount" type="number" min="0" max="10000" ng-change="$ctrl.handleGroupPatronCountChange()"></span></label><p class="help-block additional-attendee-limit-message" ng-if="$ctrl.ordinanceConfig">{{\'scheduleAppointment.additionalAttendeeLimit\' | tisfTranslate: $ctrl.ordinanceConfig.maxNumberOfGuests}}</p></div></div><div class="col-xs-12 col-sm-8 no-padding-right group-name-container" ng-class="{\'has-error\': !$ctrl.appointment.details.groupName}"><label>{{\'scheduleAppointment.groupName\' | tisfTranslate}} <input id="appointment-groupname-input" class="form-control" ng-model="$ctrl.appointment.details.groupName" maxlength="200" required> <i ng-if="!$ctrl.appointment.details.groupName" class="glyphicon glyphicon-exclamation-sign danger input-icon"></i> {{\'scheduleAppointment.exampleGroupNames\' | tisfTranslate}}</label><p class="group-name-error" ng-if="!$ctrl.appointment.details.groupName">{{\'scheduleAppointment.groupName.error\' | tisfTranslate}}</p></div></div><div ng-if="$ctrl.inclGuests || $ctrl.ordinanceConfig.appointmentType === \'LIVING_SEALING\'" class="row"><div class="col-xs-12"><tos-collapse open="true" heading-message-key="scheduleAppointment.groupAppointments"><ul class="text4 reserving-seats-instructions-list"><li>{{\'scheduleAppointment.seatsReserved\' | tisfTranslate}}</li><li style="padding-bottom: 4px;"><span>{{\'scheduleAppointment.instructionsLater\' | tisfTranslate}}</span> <a uib-popover-template="\'/app/modules/components/tos-confirmation-benefits/tos-confirmation-benefits.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="top"><i class="icon info-icon" style="padding-left: 5px; height: 19px !important;"></i></a></li><li>{{\'scheduleAppointment.otherQuestions\' | tisfTranslate}}</li></ul></tos-collapse></div></div><hr ng-if="$ctrl.inclGuests || $ctrl.ordinanceConfig.appointmentType === \'LIVING_SEALING\'" class="add-guests-hr"></div><div ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM" class="add-spouse-spacing"><span ng-class="{\'has-error\': $root.patronCountExceedsMaxGroupSize}"><label class="gender-label" for="malePatronCount"><span ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM">{{\'baptism.malesToBeBaptizedLabel\' | tisfTranslate}}</span></label> <input type="number" ng-model="$ctrl.appointment.details.malePatronCount" min="0" class="gender-input form-control" id="malePatronCount" ng-change="$ctrl.handleBaptismPatronCountChange()" autofocus> <label class="gender-label second-count-for-people-to-be-baptized" for="femalePatronCount"><span ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM">{{\'baptism.femalesToBeBaptizedLabel\' | tisfTranslate}}</span></label> <input type="number" ng-model="$ctrl.appointment.details.femalePatronCount" min="0" class="gender-input form-control" id="femalePatronCount" ng-change="$ctrl.handleBaptismPatronCountChange()"><p ng-if="$root.patronCountExceedsMaxGroupSize &&\n                     $ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM" class="help-block">{{\'validation.groupSizeCannotExceed\' | tisfTranslate:$ctrl.getMaxOnlineGroupSize()}}</p></span><p ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM && !$ctrl.restrictedCount" class="baptism-notice-for-people-attending-message">&#42;&nbsp;{{\'baptism.noticeForPeopleAttending\' | tisfTranslate}}</p><p ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM" class="baptism-notice-for-people-attending-message">{{\'selectAppointmentTime.phase3.bringOwnOfficiatorsAndWitnesses\' | tisfTranslate}}</p><div class="baptism-counts" ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM"><div class="baptism-count"><label for="numberOfMalesToHelpWithBaptisms">{{\'scheduleAppointment.numberOfMalesToHelpWithBaptisms\' | tisfTranslate}}<tos-tooltip popover-class="\'malesToAssistInBaptistry\'" highlight-text="true" tooltip-text="$ctrl.numberOfMalesToAssistTooltip"></tos-tooltip></label> <input type="number" min="0" max="100" class="form-control" id="numberOfMalesToHelpWithBaptisms" ng-model="$ctrl.appointment.details.malesToAssistCount"></div><div class="baptism-count"><label for="numberOfEndowedMalesToHelpWithConfirmations">{{\'scheduleAppointment.numberOfEndowedMalesToHelpWithConfirmations\' | tisfTranslate}}<tos-tooltip popover-class="\'malesToAssistInBaptistry\'" highlight-text="true" tooltip-text="$ctrl.numberOfEndowedMalesToAssist"></tos-tooltip></label> <input type="number" min="0" max="100" class="form-control" ng-model="$ctrl.appointment.details.endowedMaleCount" id="numberOfEndowedMalesToHelpWithConfirmations"></div><div class="baptism-count"><label for="numberOfFemalesToAssistInTheBaptistry">{{\'scheduleAppointment.numberOfFemalesToAssistInTheBaptistry\' | tisfTranslate}}<tos-tooltip id="numberOfFemalesToAssistTooltip" tooltip-id="\'numberOfFemalesToAssistTooltip\'" highlight-text="true" popover-class="\'femalesToAssistInBaptistry\'" tooltip-text="$ctrl.numberOfFemalesToAssistTooltip"></tos-tooltip></label> <input type="number" min="0" max="100" class="form-control" id="numberOfFemalesToAssistInTheBaptistry" ng-model="$ctrl.appointment.details.femalesToAssistCount"></div></div></div></div>'),e.put("/app/modules/components/session-selector/appointment-time-selector.html",'<div><div class="alert warning no-margin in-page-alert" ng-if="$ctrl.showAppointmentsForDay" role="alert"><h3 controller class="title alert-title flex-modal-title"><span class="inline-flex"><span class="icon warning-icon"></span> <span class="flex-modal-title-text">{{ \'alert.myAppointmentsOnThisDate\' | tisfTranslate }} </span></span><span class="icon close-icon alert-close-button clickable" ng-click="$ctrl.closeAppointmentsForDay()"></span></h3><div class="description"><p>{{\'alert.allowEnoughTimeBetweenAppts\' | tisfTranslate}}</p><ul><li ng-repeat="appointment in $ctrl.appointmentsForSelectedDay">{{appointment.appointmentType | tosAppointmentType}} {{appointment.appointmentTime}} <span ng-if="appointment.appointmentEnd">- {{appointment.appointmentEnd}}</span></li></ul></div></div><div class="alert info no-margin in-page-alert" ng-if="$ctrl.showEarliestScheduleDate" role="alert"><h3 controller class="title alert-title flex-modal-title"><span class="inline-flex"><span class="icon info-icon"></span> <span class="flex-modal-title-text">{{ \'alert.earliestScheduleDate.header\' | tisfTranslate }} </span></span><span class="icon close-icon alert-close-button clickable" ng-click="$ctrl.closeEarliestScheduleDate()"></span></h3><div class="description"><p>{{\'alert.earliestScheduleDate.message\' | tisfTranslate}}</p><ul><li class="bold">{{$ctrl.earliestScheduleDate | localizeDateTime:\'date\'}}</li></ul></div></div><div><p ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_SEALING" class="flush-top">{{\'sealing.onlyProxyCanBeScheduled\' | tisfTranslate}}<br>{{\'sealing.sealingLivingToDeceased\' | tisfTranslate}}</p></div><div class="spinner-icon" ng-if="($ctrl.loadingTimes || !$ctrl.selectedDayOfCalendar) && !$ctrl.hideSessionSpinner"></div><div ng-if="$ctrl.showAppointmentTimesSection()" class="appointment-times"><strong class="appointment-scheduled-time-message">{{[$ctrl.appointment, $ctrl.displayCurrentAppointmentTime] | tosCurrentScheduledTime}}<br></strong><div ng-if="$ctrl.displayNoSessionsAvailableMessage && !$ctrl.reloadTimesForGroups()" class="no-sessions-available-message" ng-init="$ctrl.hideSpinner(true)"><strong>{{$ctrl.appointment.appointmentType | tosNoSessionsAvailable}}</strong></div><div ng-if="$ctrl.displayNoSessionsForGroupSizeMessage && !$ctrl.reloadTimesForGroups()" class="no-sessions-available-message" ng-init="$ctrl.hideSpinner(true)"><strong>{{\'selectAppointmentTime.noTimesThatFitYourGroupSize\' | tisfTranslate}}</strong></div><div ng-if="$ctrl.shouldDisplaySessionList()"><div><span class="text4" ng-if="!$ctrl.loadingTimes">{{\'selectAppointmentTime.title\' | tisfTranslate}}</span></div><div class="schedule-item-container" ng-class="{\'no-border-top\': $ctrl.loadingTimes}"><div class="schedule-item" ng-repeat="session in $ctrl.sessionListToDisplay" ng-click="$ctrl.onSessionClicked(session, $index)" ng-disabled="!$ctrl.sessionIsSelectable(session, $index)"><div ng-init="$ctrl.hideSpinner($last);"><span uib-popover-html="$ctrl.getPopoverHtml()" popover-class="disabled-ordinance-message" popover-animation="true" popover-trigger="\'mouseenter\'" popover-popup-delay="500" popover-enable="$ctrl.popoverEnabled(session)"><span class="icon icon-checkmarkdone selected-session" ng-if="$ctrl.isPreviouslySelectedTime(session)"></span> <span ng-bind-html="$ctrl.getSessionTimeAndSchedulingType(session, $index)"></span> <span class="guest-online-schedule" ng-show="$ctrl.checkForAppointmentTimeIsDisabled(session)">{{ $ctrl.determineNotEnoughSeatsMessageKey(session) | tisfTranslate}}</span></span></div></div></div></div><div ng-if="$ctrl.reloadTimesForGroups()" class="no-sessions-available-message" ng-init="$ctrl.hideSpinner(true)"><strong>{{\'selectAppointmentTime.reloadAppointments\' | tisfTranslate}}</strong></div></div></div>'),e.put("/app/modules/components/session-selector/current-appointment.html",'<div><div class="alert info no-margin in-page-alert" ng-if="$ctrl.showCurrentAppointment" role="alert"><h3 controller class="title alert-title flex-modal-title"><span class="inline-flex"><span class="icon info-icon"></span> <span class="flex-modal-title-text">{{ \'alert.current.appointment.editing.header\' | tisfTranslate }} </span></span><span class="icon close-icon alert-close-button clickable" ng-click="$ctrl.showCurrentAppointment = false"></span></h3><div class="description"><p>{{ \'alert.current.appointment.editing.body\' | tisfTranslate }}</p><p ng-if="$ctrl.appointment.appointmentStatus === \'DETACHED\'" class="danger-notice">{{\'alert.current.appointment.editing.body.detachedNotice\' | tisfTranslate}}</p><div class="appointment-margin-left reduced-text-spacing"><p><strong>{{ $ctrl.appointment.appointmentType | tosAppointmentType}}</strong></p><p><strong>{{ $ctrl.appointmentDate }}</strong></p><p><strong>{{ $ctrl.appointmentTime }}</strong></p></div></div></div></div>'),e.put("/app/modules/components/session-selector/session-selector.html",'<div><appointment-options appointment="$ctrl.appointment" disable-session-selection="$ctrl.disableSessionSelection" incl-self="$ctrl.inclSelf" incl-spouse="$ctrl.inclSpouse" incl-guests="$ctrl.inclGuests" is-edit="$ctrl.isEdit" session="$ctrl.session" session-list-for-date="$ctrl.sessionsForSelectedDate" self-guest="$ctrl.selfGuest" spouse-guest="$ctrl.spouseGuest" proxy-baptism-patron-count-per-appointment="$ctrl.proxyBaptismPatronCountPerAppointment"></appointment-options><div ng-disabled="$ctrl.disableSessionSelection"><appointment-date-selector appointment="$ctrl.appointment" selected-date="$ctrl.selectedDate" temple-org-id="$ctrl.appointment.templeOrgId" hide-session-spinner="$ctrl.hideSessionSpinner" appointment-type="$ctrl.appointment.appointmentType" disable-session-selection="$ctrl.disableSessionSelection" ordinance-config="$ctrl.ordinanceConfig" selected-day-of-calendar="$ctrl.selectedDayOfCalendar" incl-self="$ctrl.inclSelf" incl-spouse="$ctrl.inclSpouse" group-appointments-loaded="$ctrl.groupAppointmentsLoaded" is-edit="$ctrl.isEdit"></appointment-date-selector><appointment-time-selector appointment="$ctrl.appointment" selected-date="$ctrl.selectedDate" selected-session="$ctrl.selectedSession" session-list-for-date="$ctrl.sessionsForSelectedDate" loading-times="$ctrl.loadingTimes" hide-session-spinner="$ctrl.hideSessionSpinner" incl-spouse="$ctrl.inclSpouse" incl-self="$ctrl.inclSelf" self-guest="$ctrl.selfGuest" spouse-guest="$ctrl.spouseGuest" languages="$ctrl.languages" disable-session-selection="$ctrl.disableSessionSelection" previously-selected-appointment-time-id="$ctrl.previouslySelectedAppointmentTimeId" previously-selected-appointment-sealing-room-id="$ctrl.previouslySelectedAppointmentSealingRoomId" ordinance-config="$ctrl.ordinanceConfig" temple-phone-number="$ctrl.templePhoneNumber" selected-day-of-calendar="$ctrl.selectedDayOfCalendar" proxy-baptism-patron-count-per-appointment="$ctrl.proxyBaptismPatronCountPerAppointment" group-appointments-loaded="$ctrl.groupAppointmentsLoaded"></appointment-time-selector></div></div>'),e.put("/app/modules/components/tos-accordion-header/tos-accordion-header.html",'<uib-accordion-heading><div class="tosAccordionHeader" ng-class="{\'completed-not-editable-header\': $ctrl.canEditStep && !$ctrl.canEditStep()}" ng-click="(!$ctrl.canEditStep || $ctrl.canEditStep()) && $ctrl.headerClick()" uib-popover="{{$ctrl.createToEditMessage}}" popover-trigger="\'mouseenter\'" popover-placement="auto top-left" popover-class="popover-text" popover-enable="$ctrl.isCompleted && $ctrl.canEditStep && !$ctrl.canEditStep()"><i class="pull-left icon icon-checkmarkdone" ng-if="$ctrl.isCompleted"></i> <i class="pull-right icon" ng-class="{\'icon-chevronup\': $ctrl.isOpen, \'icon-chevrondown\': !$ctrl.isOpen}"></i> <span tabindex="0" class="header-text" id="{{$ctrl.heading}}">{{$ctrl.heading}}</span></div></uib-accordion-heading>'),e.put("/app/modules/components/tos-accordion/group-template.html",'<div uib-accordion-transclude="heading"><div uib-accordion-header>{{heading}}</div></div><div class="panel-collapse collapse" uib-collapse="!isOpen"><div class="panel-body" ng-transclude></div></div>'),e.put("/app/modules/components/tos-accordion/tos-accordion.html",'<uib-accordion close-others="true"><div uib-accordion-group ng-class="{completed:$ctrl.canEditStep($ctrl.step1Id)}" template-url="/app/modules/components/tos-accordion/group-template.html" is-open="isStep1Open = $ctrl.isStepOpen($ctrl.step1Id)" id="appointment-type-selector"><tos-accordion-header header-click="$ctrl.onHeaderClick($ctrl.step1Id)" heading="{{$ctrl.getHeading($ctrl.step1Id)}}" is-open="isStep1Open" is-completed="$ctrl.isStepCompleted($ctrl.step1Id)" can-edit-step="$ctrl.canEditStep($ctrl.step1Id)" create-to-edit-message="{{\'ordinanceSelector.createNewAppointmentToChangeTheOrdinanceType\' | tisfTranslate}}"></tos-accordion-header><ordinance-selector selected-ordinance-type="$ctrl.appointment.appointmentType" temple-org-id="$ctrl.appointment.templeOrgId" temple-phone-number="$ctrl.selectedTemplesPhoneNumber" previously-selected-ordinance-type="$ctrl.appointmentWithSelectedValues.appointmentType" temple-email="$ctrl.selectedTemplesOfficeEmail"></ordinance-selector></div><div uib-accordion-group ng-class="{completed:$ctrl.canEditStep($ctrl.step2Id)}" template-url="/app/modules/components/tos-accordion/group-template.html" is-open="isStep2Open = $ctrl.isStepOpen($ctrl.step2Id)" id="session-selector"><tos-accordion-header header-click="$ctrl.onHeaderClick($ctrl.step2Id)" heading="{{$ctrl.getHeading($ctrl.step2Id)}}" is-open="isStep2Open" is-completed="$ctrl.isStepCompleted($ctrl.step2Id)"></tos-accordion-header><session-selector appointment="$ctrl.appointment" incl-self="$ctrl.inclSelf" incl-spouse="$ctrl.inclSpouse" incl-guests="$ctrl.inclGuests" selected-session="$ctrl.session" preselection-completed="$ctrl.onSessionPreselectionCompleted" sessions-for-selected-date="$ctrl.sessionsForSelectedDate" previously-selected-appointment-time-id="$ctrl.appointmentWithSelectedValues.appointmentTimeId" previously-selected-appointment-sealing-room-id="$ctrl.appointmentWithSelectedValues.sealingRoomId ? $ctrl.appointmentWithSelectedValues.sealingRoomId : null" temple-phone-number="$ctrl.selectedTemplesPhoneNumber" is-showing="isStep2Open" primary-languages="$ctrl.primaryLanguages"></session-selector></div><div uib-accordion-group ng-class="{completed:$ctrl.canEditStep($ctrl.step3Id)}" template-url="/app/modules/components/tos-accordion/group-template.html" is-open="isStep3Open = $ctrl.isStepOpen($ctrl.step3Id)"><tos-accordion-header header-click="$ctrl.onHeaderClick($ctrl.step3Id)" heading="{{$ctrl.getHeading($ctrl.step3Id)}}" is-open="isStep3Open" is-completed="$ctrl.isStepCompleted($ctrl.step3Id)"></tos-accordion-header><finalize-appointment appointment="$ctrl.appointment" is-open="isStep3Open" session="$ctrl.session" is-edit="$ctrl.isEdit" incl-self="$ctrl.inclSelf" incl-spouse="$ctrl.inclSpouse" on-appointment-not-available-when-scheduling="$ctrl.onAppointmentNotAvailableWhenScheduling" temple-phone-number="$ctrl.selectedTemplesPhoneNumber" primary-languages="$ctrl.primaryLanguages"></finalize-appointment></div></uib-accordion>'),e.put("/app/modules/components/tos-collapse/tos-collapse.html",'<div class="collapse-container"><div ng-click="$ctrl.open = !$ctrl.open" class="collapse-heading-container"><span class="collapse-heading">{{$ctrl.headingMessageKey | tisfTranslate}}</span><i class="icon" ng-class="{\'icon-arrow-close-drop-down\': $ctrl.open, \'icon-arrow-drop-down\': !$ctrl.open}"></i></div><div ng-if="$ctrl.open" class="collapse-children"><div ng-transclude></div></div></div>'),e.put("/app/modules/components/tos-confirmation-benefits/tos-confirmation-benefits.html","<div><span><strong>{{'scheduleAppointment.confirmationBenefits.title' | tisfTranslate}}</strong></span><ul><li>{{'scheduleAppointment.confirmationBenefits.one' | tisfTranslate}}</li><li>{{'scheduleAppointment.confirmationBenefits.two' | tisfTranslate}}</li><li>{{'scheduleAppointment.confirmationBenefits.three' | tisfTranslate}}</li><li>{{'scheduleAppointment.confirmationBenefits.four' | tisfTranslate}}</li></ul></div>"),e.put("/app/modules/components/tos-snackbar/tos-success-snackbar.html",'<div id="snackbar" class="snackbar" ng-class="{\'snackbar-open\': $ctrl.isOpen}"><div class="alert success snackbar-container"><span class="icon circle-selected-filled-icon"></span> <span>{{ $ctrl.snackbarText }}</span></div></div>'),e.put("/app/modules/components/tos-tooltip/popover-container.html",'<div ng-bind-html="$ctrl.tooltipText"></div>'),e.put("/app/modules/components/tos-tooltip/tos-tooltip.html","<span class=\"tos-tooltip clickable\" ng-click=\"$ctrl.onClick()\"><span ng-if=\"$ctrl.tooltipPlacement === 'left'\" ng-class=\"[\n              'icon',\n              'responsive',\n              {'help-info-icon': $ctrl.iconType === 'help' || !$ctrl.iconType, 'info-danger-icon': $ctrl.iconType === 'danger',\n               'info-info-icon': $ctrl.iconType === 'info'}\n          ]\" uib-popover-template=\"'/app/modules/components/tos-tooltip/popover-container.html'\" popover-class=\"{{$ctrl.popoverClass}}\" popover-placement=\"{{$ctrl.popoverPosition || $ctrl.popoverPlacement}}\" popover-trigger=\"'outsideClick'\" popover-is-open=\"$ctrl.popoverIsOpen\" popover-append-to-body=\"true\"></span> <span ng-class=\"{'text-info': $ctrl.highlightText}\" ng-if=\"$ctrl.tooltipLabel\" ng-bind=\"$ctrl.tooltipLabel\"></span> <span ng-if=\"$ctrl.tooltipPlacement === 'right' || !$ctrl.tooltipPlacement\" ng-class=\"[\n              'icon',\n              'responsive',\n              {'help-info-icon': $ctrl.iconType === 'help' || !$ctrl.iconType, 'info-danger-icon': $ctrl.iconType === 'danger',\n               'info-info-icon': $ctrl.iconType === 'info'}\n          ]\" uib-popover-template=\"'/app/modules/components/tos-tooltip/popover-container.html'\" popover-class=\"{{$ctrl.popoverClass}}\" popover-placement=\"{{$ctrl.popoverPosition || $ctrl.popoverPlacement}}\" popover-trigger=\"'outsideClick'\" popover-is-open=\"$ctrl.popoverIsOpen\" popover-append-to-body=\"true\"></span></span>"),e.put("/app/modules/components/what-can-i-schedule/what-can-i-schedule.html",'<uib-accordion><div uib-accordion-group class="completed what-can-i-schedule-accordion" template-url="/app/modules/components/tos-accordion/group-template.html" is-open="$ctrl.whatCanIScheduleSectionIsOpen"><tos-accordion-header header-click="$ctrl.whatCanIScheduleSectionHeaderClicked()" heading="{{\'whatCanISchedule.title\' | tisfTranslate}}" is-open="$ctrl.whatCanIScheduleSectionIsOpen"></tos-accordion-header><div class="tos-accordion-content"><p ng-if="$ctrl.appointmentTypesAndAvailability && $ctrl.appointmentTypesAndAvailability.length > 0">{{\'whatCanISchedule.canSchedule\' | tisfTranslate}}</p><ul class="what-can-i-schedule-ordinance-list text4"><li ng-repeat="ordinance in $ctrl.appointmentTypesAndAvailability">{{ordinance | tosAppointmentType}}</li></ul><p ng-if="$ctrl.appointmentTypesAndAvailability && $ctrl.appointmentTypesAndAvailability.length === 0">{{\'yourTemple.notSchedulingAppointmentsOnline\' | tisfTranslate}}</p><p>{{\'whatCanISchedule.notAllTemplesAreScheduling\' | tisfTranslate}}</p></div></div></uib-accordion>'),e.put("/app/modules/common/modals/already-scheduled-modal/already-scheduled-modal.html",'<div class="alert" role="alert"><modal-header can-dismiss="true" header-text="$ctrl.getAppointmentType()" icon-class="\'info-icon\'" include-icon="true"></modal-header><div class="description"><p class="modal-subtitle">{{\'alreadyScheduledModal.description.1\' | tisfTranslate: $ctrl.getAppointmentType()}}</p><p class="modal-subtitle">{{ $ctrl.getDescriptionPartTwo() }}</p><div class="modal-participant-list"><p class="bold text4 modal-participant-list-subheading" style="font-size: .875rem !important;">{{\'multipleSealing.alreadyScheduled\' | tisfTranslate}}</p><p class="text3" style="font-size: .875rem !important;">{{ $ctrl.appointment.appointmentType | tosAppointmentType }}</p><p class="text3" style="font-size: .875rem !important;">{{ $ctrl.appointment.templeOrgId | tosTempleName }}</p><p class="text3" style="font-size: .875rem !important;">{{ $ctrl.getTranslatedDateAtTimeString() }}</p></div><div class="modal-participant-list" ng-if="$ctrl.isLivingEndowment()"><p class="text3" style="font-size: .875rem !important;">{{ $ctrl.getEndowmentPatronName() }}</p></div><div class="modal-participant-list" ng-if="$ctrl.isLivingSealing()"><ul class="text3 sealing-modal-list" style="font-size: .875rem !important;"><li>{{ $ctrl.getMaleAdultName() }}</li><li>{{ $ctrl.getFemaleAdultName() }}</li></ul><ul class="text3" style="margin-top: 0.5rem!important; font-size: .875rem !important;" ng-if="$ctrl.isChildToParentSealing()"><li ng-repeat="child in $ctrl.getChildrenForSealing()">{{\'scheduleAppointment.sealing.child\' | tisfTranslate: child.name }}</li><li ng-repeat="observer in $ctrl.getObserversForSealing()">{{\'scheduleAppointment.sealing.observer\' | tisfTranslate: observer.name }}</li></ul></div><div ng-if="$ctrl.shouldDisableEdits()" class="not-editable-indicator"><tos-tooltip popover-position="\'auto top\'" icon-type="\'help\'" highlight-text="true" tooltip-label="$ctrl.notEditableLabel" tooltip-text="$ctrl.notEditableText"></tos-tooltip></div><div class="actions"><button class="primary no-margin-left" ng-click="$close()" ng-hide="$ctrl.shouldDisableEdits()">{{\'multipleSealing.button.edit\' | tisfTranslate}}</button> <button ng-class="$ctrl.shouldDisableEdits() ? \'primary no-margin-left\' : \'secondary margin-left\'" ng-click="$dismiss()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/combine-sealings-modal/combine-sealings-modal.html",'<div ng-class="($ctrl.isWarningModal) ? \'alert danger\' : \'alert info\'" role="alert"><modal-header can-dismiss="true" header-text="\'combineSealingsModal.title\' | tisfTranslate" icon-class="$ctrl.isWarningModal ? \'info-danger-icon\' : \'info-icon\'"></modal-header><div class="description"><p></p><div ng-if="$ctrl.scheduledSealing.type === $ctrl.SealingType.WIFE_TO_HUSBAND_SEALING">{{\'combineSealingsModal.toSpouse.description.top\' | tisfTranslate}}</div><div ng-if="$ctrl.scheduledSealing.type === $ctrl.SealingType.CHILD_TO_PARENTS_SEALING">{{\'combineSealingsModal.toChildren.description.top\' | tisfTranslate}}</div><div style="display:block" class="combine-appt-info-block"><div><strong>{{\'combineSealingsModal.description.ordinance.appointment.title\' | tisfTranslate:$ctrl.getTranslatedSealingType()}}</strong></div><div>{{$ctrl.scheduledSealing.scheduledAppointment.templeOrgId | tosTempleName}}</div><div>{{ $ctrl.getTranslatedDateAtTimeString() }}</div><br><div>{{ $ctrl.getMaleAdultName() }}</div><div>{{ $ctrl.getFemaleAdultName() }}</div><span ng-if="$ctrl.isChildToParentSealing()" ng-repeat="child in $ctrl.getChildrenForSealing()">{{\'scheduleAppointment.sealing.child\' | tisfTranslate: $ctrl.getChildName(child) }}<br></span><span ng-if="$ctrl.isChildToParentSealing()" ng-repeat="observer in $ctrl.getObserversForSealing()">{{\'scheduleAppointment.sealing.observer\' | tisfTranslate: $ctrl.getChildName(observer) }}<br></span></div><div ng-if="$ctrl.isWarningModal" style="display:block"><div>{{\'combineSealingsModal.description.warning.call.the.temple\' | tisfTranslate}}</div><br><div><strong>{{$ctrl.scheduledSealing.scheduledAppointment.templeOrgId | tosTempleName}}</strong></div><div>{{\'misc.phone.number\' | tisfTranslate: $ctrl.templePhone}}</div><br><div>{{\'combineSealingsModal.description.warning.continue.scheduling\' | tisfTranslate}}</div></div><div ng-if="!$ctrl.isWarningModal"><div ng-if="$ctrl.scheduledSealing.type === $ctrl.SealingType.WIFE_TO_HUSBAND_SEALING">{{\'combineSealingsModal.toChildren.description.bottom\' | tisfTranslate}}</div><div ng-if="$ctrl.scheduledSealing.type === $ctrl.SealingType.CHILD_TO_PARENTS_SEALING">{{\'combineSealingsModal.toSpouse.description.bottom\' | tisfTranslate}}</div></div><p></p><div class="actions"><button ng-repeat="button in $ctrl.buttons" class="{{button.type.toLowerCase()}}" ng-class="{\'flush-left\':$first}" ng-click="$ctrl.onButtonClick(button)">{{button.content}}</button></div></div></div>'),e.put("/app/modules/common/modals/conflicting-appointment-guest-modal/conflicting-appointment-guest-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="false" header-text="\'finalizeAppointment.unableToSchedule.title\' | tisfTranslate" icon-class="\'info-danger-icon\'"></modal-header><div class="description"><p></p><div ng-if="!$ctrl.spouseAppointmentConflict">{{\'conflictingAppointment.alreadyScheduledAppointmentForThisTime\' | tisfTranslate}}</div><div ng-if="$ctrl.spouseAndPatronAppointmentConflict">{{\'conflictingAppointment.spouseAndPatronAlreadyScheduledAppointmentForThisTime\' | tisfTranslate}}</div><br><strong>{{$ctrl.appointmentType | tosAppointmentType}}<br>{{$ctrl.appointment.templeOrgId | tosTempleName}}<br>{{$ctrl.dateToDisplay | localizeDateTime:\'dateShort\'}}<br>{{$ctrl.dateToDisplay | localizeDateTime:\'time\'}}</strong><div><br>{{\'conflictingAppointment.cancelOtherAppointmentToJoinGroup\' | tisfTranslate}}</div><p></p><div class="actions"><button class="secondary no-margin-left" ng-click="$ctrl.goToLanding()">{{\'buttons.okay\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/conflicting-appointment-modal/conflicting-appointment-modal.html",'<div class="alert warning" role="alert"><modal-header can-dismiss="false" header-text="\'schedulingNotice.title\' | tisfTranslate" icon-class="\'info-warning-icon\'"></modal-header><div class="description"><p></p><div ng-if="!$ctrl.spouseAppointmentConflict && !$ctrl.spouseAndPatronAppointmentConflict">{{\'conflictingAppointment.alreadyScheduledAppointmentForThisTime\' | tisfTranslate}}</div><div ng-if="$ctrl.spouseAppointmentConflict">{{\'conflictingAppointment.spouseAlreadyScheduledAppointmentForThisTime\' | tisfTranslate}}</div><div ng-if="$ctrl.spouseAndPatronAppointmentConflict">{{\'conflictingAppointment.spouseAndPatronAlreadyScheduledAppointmentForThisTime\' | tisfTranslate}}</div><br><strong>{{$ctrl.appointmentType | tosAppointmentType}}<br>{{$ctrl.appointment.templeOrgId | tosTempleName}}<br>{{$ctrl.appointment.displayedAppointmentDate | localizeDateTime:\'dateShort\'}}<br>{{$ctrl.appointment.displayedAppointmentDate | localizeDateTime:\'time\'}}</strong><div><br>{{\'conflictingAppointment.selectADifferentTime\' | tisfTranslate}}</div><p></p><div class="actions"><button ng-click="$ctrl.goToSelectTime()" class="primary margin-right">{{\'schedulingNotice.selectATime\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$dismiss(\'canceled\')">{{\'schedulingNotice.dontSchedule\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/contact-info-modal/contact-info-modal.html",'<form name="contactInfoForm" id="contact-info-modal" ng-submit="$ctrl.save()" novalidate><h3 class="title">{{\'contactInfoModal.title\' | tisfTranslate}}</h3><div class="form-group text-box required" ng-class="{ \'has-error\' : contactInfoForm.email.$invalid && !contactInfoForm.email.$pristine }"><label for="contact-info-modal-email">{{\'contactInfoModal.emailLabel\' | tisfTranslate}}</label> <input type="email" id="contact-info-modal-email" name="email" class="form-control" ng-model="$ctrl.contactInfo.email" required><p ng-show="contactInfoForm.email.$invalid && !contactInfoForm.email.$pristine" class="help-block">{{\'contactInfoModal.enterValidEmail\' | tisfTranslate}}</p></div><div class="form-group text-box"><label for="contact-info-modal-mobile" ng-disabled="$ctrl.shouldDisablePhoneField">{{\'contactInfoModal.mobileNumber\' | tisfTranslate}}</label> <input type="tel" autocomplete="tel" id="contact-info-modal-mobile" name="mobile" class="form-control" ng-disabled="$ctrl.shouldDisablePhoneField" ng-model="$ctrl.contactInfo.contactInfo"> <span class="text4 help-block" ng-if="$ctrl.shouldDisablePhoneField">{{\'contactInfoModal.nonEditable\' | tisfTranslate}}</span></div><div class="actions"><button type="button" class="ghost" ng-click="$dismiss(\'canceled\')" id="cancel-saving-contact-info-button">{{\'buttons.cancel\' | tisfTranslate}}</button> <button type="submit" ng-disabled="contactInfoForm.$invalid" id="save-contact-info-button">{{\'buttons.save\' | tisfTranslate}}</button></div></form>'),e.put("/app/modules/common/modals/delete-appointment-modal/delete-appointment-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="$ctrl.getHeaderText() | tisfTranslate" icon-class="\'info-danger-icon\'"></modal-header><div class="description"><p><span>{{$ctrl.getDescription() | tisfTranslate}}</span> <b ng-if="!$ctrl.isAGroupAppointment()">{{\'deleteAppointmentModal.description.bold\' | tisfTranslate}}</b></p><p ng-if="!$ctrl.isAGroupAppointment()"><b>{{$ctrl.appointment.appointmentType | tosAppointmentType}}<br>{{$ctrl.appointment.templeOrgId | tosTempleName}}<br>{{$ctrl.dateToDisplay | localizeDateTime:\'dateShort\'}}<br>{{$ctrl.appointment | tosAppointmentTime}}</b></p><p>{{$ctrl.getWarning() | tisfTranslate}}</p><div class="actions"><button id="cancel-appointment-modal-button" class="margin-right" ng-click="$ctrl.deleteAppointment()">{{$ctrl.getButtonText() | tisfTranslate}}</button> <button id="close-delete-appointment-modal-button" class="secondary no-margin-left" ng-click="$dismiss(\'canceled\')">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/delete-living-appointment-modal/delete-living-appointment-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="\'deleteAppointmentModal.title\' | tisfTranslate" icon-class="\'alert-error-icon\'" include-icon="true"></modal-header><div class="description"><div>{{\'deleteLivingAppointmentModal.listIntro\' | tisfTranslate}}</div><ul><li>{{\'deleteLivingAppointmentModal.listItem1\' | tisfTranslate}}</li><li>{{\'deleteLivingAppointmentModal.listItem2\' | tisfTranslate}}</li><li>{{\'deleteLivingAppointmentModal.listItem3\' | tisfTranslate}}</li><li>{{\'deleteLivingAppointmentModal.listItem4\' | tisfTranslate}}</li></ul><div>{{\'deleteLivingAppointmentModal.whenToCancel\' | tisfTranslate}} <b>{{\'deleteAppointmentModal.description.bold\' | tisfTranslate}}</b></div><br><div>{{\'deleteLivingAppointmentModal.editInstead\' | tisfTranslate}}</div><div class="actions"><button id="cancel-appointment-modal-button" class="no-margin-left" ng-click="$ctrl.deleteAppointment()">{{\'myAppointments.actionsDeleteAppointmentOption\' | tisfTranslate}}</button> <button id="edit-appointment-modal-button" class="secondary no-margin-left" ng-disabled="!$ctrl.editingEnabled()" ng-click="$ctrl.editAppointment()">{{\'myAppointments.actionsEditAppointmentOption\' | tisfTranslate}}</button> <button id="close-delete-appointment-modal-button" class="secondary no-margin-left" ng-click="$dismiss(\'canceled\')">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/email-sent-modal/email-sent-modal.html",'<div class="alert success" role="alert"><modal-header can-dismiss="true" header-text="$ctrl.modalTitle" icon-class="\'info-success\'" include-icon="true"></modal-header><div class="description"><p><span>{{$ctrl.modalDesc}}</span></p></div></div>'),e.put("/app/modules/common/modals/feedback-modal/feedback-modal.html",'<div class="alert feedback-modal" role="alert"><modal-header can-dismiss="true" dismiss-function="$ctrl.closeModal()" header-text="(!$ctrl.userSubmittedFeedback ? \'feedback.modal.header\' : \'feedback.modal.thankYou\') | tisfTranslate" include-icon="false" left-align-title="false"></modal-header><div><div ng-repeat="question in $ctrl.feedbackQuestions | orderBy: [\'questionOrder\']" ng-show="!$ctrl.userSubmittedFeedback"><feedback-question question="question" feedback-response="$ctrl.feedbackResponse"></feedback-question></div></div><div class="actions" ng-class="{\'actions-extra-margin-top\': $ctrl.userSubmittedFeedback}"><button ng-click="$ctrl.saveFeedback()" class="primary margin-right" ng-show="!$ctrl.userSubmittedFeedback" ng-disabled="!$ctrl.feedbackResponse.scheduledStatus || !$ctrl.feedbackResponse.schedulingExperienceRating">{{\'feedback.modal.leaveFeedbackButton\' | tisfTranslate}}</button> <button class="secondary" ng-click="$ctrl.closeModal()">{{\'buttons.close\' | tisfTranslate}}</button></div></div>'),e.put("/app/modules/common/modals/feedback-side-content/feedback-side-content.html",'<div><div class="feedback-modal-container" id="feedback-modal-container" ng-style="{\'width\': $ctrl.determineFeedbackContentWidth(), \'right\': $ctrl.determineFeedbackContentRightValue(), \'transition-duration\': $ctrl.determineTransitionDuration()}"><button class="secondary feedback-side-button" id="feedback-side-button" ng-click="$ctrl.handleFeedbackButtonClick()" style="visibility: hidden;" ng-show="$ctrl.showFeedbackButton()" ng-style="$ctrl.feedbackButtonStyles">{{ \'feedback.buttonText\' | tisfTranslate }}</button><div class="alert feedback-modal" id="feedback-modal" role="alert"><modal-header can-dismiss="true" dismiss-function="$ctrl.toggleFeedbackContentOpen()" header-text="(!$ctrl.userSubmittedFeedback ? \'feedback.modal.header\' : \'feedback.modal.thankYou\') | tisfTranslate" include-icon="false" left-align-title="false" is-modal="false"></modal-header><div><div ng-repeat="question in $ctrl.feedbackQuestions | orderBy: [\'questionOrder\']" ng-show="!$ctrl.userSubmittedFeedback"><feedback-question question="question" feedback-response="$ctrl.feedbackResponse"></feedback-question></div></div><div class="actions" ng-class="{\'actions-extra-margin-top\': $ctrl.userSubmittedFeedback}"><button ng-click="$ctrl.saveFeedback()" class="primary margin-right" ng-show="!$ctrl.userSubmittedFeedback" ng-disabled="!$ctrl.feedbackResponse.scheduledStatus || !$ctrl.feedbackResponse.schedulingExperienceRating">{{\'feedback.modal.leaveFeedbackButton\' | tisfTranslate}}</button> <button class="secondary" ng-click="$ctrl.toggleFeedbackContentOpen()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div></div>'),e.put("/app/modules/common/modals/general-error-modal/general-error-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="\'generalErrorModal.title\' | tisfTranslate" icon-class="\'info-danger-icon\'"></modal-header><div class="description"><p><span>{{\'generalErrorModal.description\' | tisfTranslate}}</span></p><p><b><span>{{$ctrl.templeOrgId | tosTempleName}}</span><br><span>{{$ctrl.templePhoneNumber}}</span></b></p></div></div>'),e.put("/app/modules/common/modals/guest-already-added-modal/guest-already-added-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="\'scheduleAppointment.guest.already.added.title\' | tisfTranslate" include-icon="true" icon-class="\'info-danger-icon\'"></modal-header><div class="description"><p>{{\'scheduleAppointment.guest.already.added.description\' | tisfTranslate }}</p><div class="actions"><button class="primary margin-right" ng-click="$close()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/guest-limit-exceeded-modal/guest-limit-exceeded-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="\'finalizeAppointment.unableToSchedule.title\' | tisfTranslate" icon-class="\'info-danger-icon\'" include-icon="true"></modal-header><div class="description"><p>{{\'finalizeAppointment.guestLimitExceeded.description\' | tisfTranslate}}</p><div class="actions"><button class="primary margin-right" ng-click="$close()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/licensed-marriage-modal/licensed-marriage-modal.html",'<div class="alert" role="alert"><modal-header can-dismiss="true" header-text="\'licensedMarriage.title\' | tisfTranslate" icon-class="\'warning-icon\'" include-icon="true"></modal-header><div class="description"><p>{{\'licensedMarriage.warning\' | tisfTranslate}}</p><p>{{\'licensedMarriage.proceed\' | tisfTranslate}}</p><div class="licensed-marriage-section"><p class="bold">{{\'licensedMarriage.optionOne.heading\' | tisfTranslate}}</p><p>{{\'licensedMarriage.optionOne.message\' | tisfTranslate}}</p></div><div><p class="bold">{{\'licensedMarriage.optionTwo.heading\' | tisfTranslate}}</p><p>{{\'licensedMarriage.optionTwo.message\' | tisfTranslate}}</p></div><div class="actions"><button class="primary margin-right" ng-click="$ctrl.closeModal(\'change\')">{{\'licensedMarriage.button.schedule\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$ctrl.closeModal()">{{\'licensedMarriage.button.changeTemple\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/living-appointment-deleted-modal/living-appointment-deleted-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="\'livingAppointmentDeletedModal.title\' | tisfTranslate" icon-class="\'alert-error-icon\'" include-icon="true"></modal-header><div class="description"><div id="appointment-info-block"><div><b>{{$ctrl.appointment.appointmentType | tosAppointmentType}}</b></div><div><b>{{$ctrl.appointment.templeOrgId | tosTempleName}}</b></div><div><b>{{$ctrl.appointment.displayedAppointmentDate | localizeDateTime:\'date\'}}</b></div><div><b>{{$ctrl.appointment | tosAppointmentTime}}</b></div></div><br><div>{{\'livingAppointmentDeletedModal.calendarWarning\' | tisfTranslate}}</div><br><div>{{\'livingAppointmentDeletedModal.guestsNotified\' | tisfTranslate}}</div><div class="actions"><button class="secondary no-margin-left" id="close-button" ng-click="$dismiss()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/multiple-sealing-modal/multiple-living-sealing-modal.html",'<div class="alert" role="alert"><modal-header can-dismiss="true" header-text="\'multipleSealing.title\' | tisfTranslate" icon-class="\'info-icon\'" include-icon="true"></modal-header><div class="description"><p class="modal-subtitle">{{\'multipleSealing.subTitle\' | tisfTranslate}}</p><br><label class="select-living-sealing">{{\'multipleSealing.question\' | tisfTranslate}}<br><br><span class="bold">{{\'multipleSealing.selectInfo\' | tisfTranslate}}</span> <select class="text-box form-control living-sealing-select-input" ng-options="item.value as item.label for item in $ctrl.sealingOptions" ng-model="$ctrl.selectedSealing" aria-label="{{ \'multipleSealing.placeholder\' | tisfTranslate}}"></select></label><div ng-if="$ctrl.optionSelected && $ctrl.selectedSealingFull && !$ctrl.hasNonSloq"><br><div ng-if="$ctrl.isEdit()"><div class="modal-participant-list"><p class="bold text4 modal-participant-list-subheading" style="font-size: .875rem !important;">{{\'multipleSealing.alreadyScheduled\' | tisfTranslate}}</p><p class="text3" style="font-size: .875rem !important;">{{ $ctrl.selectedSealingFull.scheduledAppointment.templeOrgId | tosTempleName }}</p><p class="text3" style="font-size: .875rem !important;">{{$ctrl.selectedSealingFull.scheduledAppointment.displayedAppointmentDate || appointment.appointmentDateTime | localizeDateTime:\'dateShort\'}}<br>{{$ctrl.selectedSealingFull.scheduledAppointment | tosAppointmentTime}}</p></div></div><div class="modal-participant-list"><ul class="text3 sealing-modal-list" style="font-size: .875rem !important;"><li>{{ $ctrl.getMaleAdultName() }}</li><li>{{ $ctrl.getFemaleAdultName() }}</li></ul><ul class="text3" style="margin-top: 0.5rem!important; font-size: .875rem !important;" ng-if="$ctrl.isChildToParentSealing()"><li ng-repeat="child in $ctrl.getChildrenForSealing()">{{\'scheduleAppointment.sealing.child\' | tisfTranslate: child.name }}</li><li ng-repeat="observer in $ctrl.getObserversForSealing()">{{\'scheduleAppointment.sealing.observer\' | tisfTranslate: observer.name }}</li></ul></div></div><div ng-if="$ctrl.hasNonSloq || $ctrl.hasInvalidSloqPatrons"><br><p class="text3">{{ \'ordinanceSelector.cannotScheduleOnline\' | tisfTranslate }}</p></div><div class="actions"><button class="primary margin-right" ng-click="$ctrl.closeModalWithSelectedSealing()" ng-disabled="$ctrl.disableSave()" ng-if="!$ctrl.isEdit()">{{\'multipleSealing.button.schedule\' | tisfTranslate}}</button> <button class="primary margin-right" ng-click="$ctrl.closeModalWithSelectedSealing()" ng-disabled="$ctrl.disableSave()" ng-if="$ctrl.isEdit()">{{\'multipleSealing.button.edit\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$dismiss()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/need-more-time-modal/need-more-time-modal.html",'<div class="alert warning" role="alert"><modal-header can-dismiss="true" dismiss-function="$ctrl.addMoreTime()" header-text="\'need.more.time.header\' | tisfTranslate" icon-class="\'info-warning-icon\'" include-icon="true"></modal-header><div>{{\'need.more.time.body\' | tisfTranslate}}</div><div class="actions"><button ng-click="$ctrl.addMoreTime()" class="primary margin-right">{{\'need.more.time.approve.button\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$ctrl.cancelAppointment()">{{\'need.more.time.cancel.button\' | tisfTranslate}}</button></div></div>'),e.put("/app/modules/common/modals/out-of-time-modal/out-of-time-modal.html",'<div class="alert warning" role="alert"><modal-header can-dismiss="true" dismiss-function="$ctrl.checkAvailability()" header-text="\'check.availability.header\' | tisfTranslate" icon-class="\'info-warning-icon\'" include-icon="true"></modal-header><div>{{\'check.availability.body\' | tisfTranslate}}</div><div class="actions"><button ng-click="$ctrl.checkAvailability()" class="primary margin-right">{{\'check.availability.button\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$ctrl.goToLanding()">{{\'check.availability.go.to.dashboard\' | tisfTranslate}}</button></div></div>'),e.put("/app/modules/common/modals/patron-housing-external-link-modal/patron-housing-external-link-modal.html",'<div class="alert no-border-left" role="alert"><div class="border-bottom"><modal-header can-dismiss="true" include-icon="false" header-text="\'patronHousing\' | tisfTranslate"></modal-header></div><div class="description session-not-available-description"><p>{{\'patronHousing.thirdParty\' | tisfTranslate}}</p><p>{{\'patronHousing.aboutToAccess\' | tisfTranslate:$ctrl.urlToReservationSite}}</p><p>{{\'patronHousing.nowLeaving\' | tisfTranslate}}</p><div class="actions"><a class="primary button-link margin-right" ng-if="$ctrl.urlToReservationSite" target="_blank" ng-href="{{$ctrl.clickableUrl}}">{{\'patronHousing.continue\' | tisfTranslate}}</a> <button class="secondary no-margin-left" ng-click="$dismiss(\'canceled\')">{{\'generic.cancel\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/patron-housing-reservation-modal/patron-housing-reservation-modal.html",'<div class="alert no-border-left" role="alert"><modal-header can-dismiss="true" include-icon="false" header-text="\'patronHousing\' | tisfTranslate"></modal-header><div class="description session-not-available-description"><p><span>{{\'patronHousing.whoIsReservationFor\' | tisfTranslate}}</span></p><p ng-repeat="item in $ctrl.reservationOptions" class="margin-8-left" ng-init="reservation=$ctrl.selectedOption.discountCode"><label><input type="radio" ng-value="item.discountCode" ng-id="item.topicLookupId" ng-model="reservation" name="reservation"> {{item.topicValue | tisfTranslate}}</label></p><p><span>{{\'patronHousing.groupNotMentionedAbove\' | tisfTranslate}}</span></p><div class="actions"><button class="primary margin-right" ng-click="$ctrl.openExternalLinkModal()">{{\'patronHousing.continue\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$dismiss(\'canceled\')">{{\'generic.cancel\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/recommend-warning-modal/recommend-warning-modal.html",'<div class="alert warning" role="alert"><modal-header can-dismiss="true" header-text="\'recommendWarningModal.title\' | tisfTranslate" icon-class="\'info-warning-icon\'"></modal-header><div class="description"><p>{{ \'recommendWarningModal.message\' | tisfTranslate }}</p><div class="actions"><button class="secondary no-margin-left" ng-click="$dismiss()">{{\'recommendWarningModal.continue\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/remove-guest-modal/remove-guest-modal.html",'<div id="remove-guest-modal" class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="\'removeAsGuestModal.title\' | tisfTranslate" includeicon="true" icon-class="\'info-danger-icon\'"></modal-header><div class="description"><p><span>{{ \'removeAsGuestModal.description\' | tisfTranslate }}</span></p><div class="actions"><p><span>{{ \'removeAsGuestModal.description.question\' | tisfTranslate }}</span></p><button id="remove-as-guest-button" class="margin-right" ng-click="$ctrl.deleteAppointment()">{{ \'myAppointments.removeMeAsGuest\' | tisfTranslate }}</button> <button id="cancel-remove-as-guest-button" class="secondary no-margin-left" ng-click="$dismiss(\'canceled\')">{{ \'buttons.cancel\' | tisfTranslate }}</button></div></div></div>'),e.put("/app/modules/common/modals/schedule-limit-reached-modal/schedule-limit-reached-modal.html",'<div class="alert warning" role="alert"><modal-header can-dismiss="true" header-text="\'scheduleAppointment.reachedSchedulingLimit\' | tisfTranslate" icon-class="\'info-warning-icon\'"></modal-header><div class="description"><p>{{\'scheduleAppointment.reachedSchedulingLimitDescription\' | tisfTranslate}}</p><div class="actions" ng-if="!$ctrl.isEdit"><button class="primary margin-right" ng-click="$close()">{{\'buttons.scheduleDifferent\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$dismiss()">{{\'schedulingNotice.dontSchedule\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/scheduled-appointment-modal/appointment-scheduled-modal.html",'<div class="alert" id="appointment-scheduled-modal" role="alert"><modal-header can-dismiss="true" header-text="\'appointmentScheduled.title\' | tisfTranslate" icon-class="\'info-icon\'"></modal-header><div class="description"><p>{{\'appointmentScheduled.description\' | tisfTranslate:$ctrl.userEmail}}</p><p class="neutral-grey-font"></p><div title="Appointment Information"><div><strong ng-if="$ctrl.isSchedulingUser() && !$ctrl.isLivingSealing()">{{$ctrl.displayedAppointmentType() | tosAppointmentType}} </strong><strong ng-if="$ctrl.isSchedulingUser() && $ctrl.isLivingSealing()">{{ $ctrl.getSealingTypeMessage() }} </strong><strong ng-if="!$ctrl.isSchedulingUser()">{{$ctrl.displayedAppointmentType() | tosAppointmentTypeGuest}}</strong></div><div ng-if="$ctrl.isAGroupAppointment() && !$ctrl.isLivingSealing()"><div>{{\'appointmentScheduled.groupNameMessage\' | tisfTranslate:$ctrl.appointment.details.groupName}} <span ng-if="$ctrl.isSchedulingUser()">*</span></div><div ng-if="!$ctrl.isSchedulingUser()">{{\'myAppointments.iAmAGuest\' | tisfTranslate}}</div><div ng-if="$ctrl.isSchedulingUser()" style="display:block">{{\'appointmentScheduled.groupSizeMessage\' | tisfTranslate:$ctrl.getGroupSize()}}</div><div style="display:block" ng-if="$ctrl.appointment.spouseIsIncluded">{{\'finalizeAppointment.includingSpouse\' | tisfTranslate}}</div><br></div><div ng-if="$ctrl.isSchedulingUser() && $ctrl.isLivingSealing()" style="display:block"><div>{{ $ctrl.getMaleAdultName() }}</div><div>{{ $ctrl.getFemaleAdultName() }}</div><span ng-if="$ctrl.shouldShowChildrenAndObservers()" ng-repeat="child in $ctrl.getChildrenForSealing()">{{\'scheduleAppointment.sealing.child\' | tisfTranslate: $ctrl.getChildName(child) }}<br></span><span ng-if="$ctrl.shouldShowChildrenAndObservers()" ng-repeat="observer in $ctrl.getObserversForSealing()">{{\'scheduleAppointment.sealing.observer\' | tisfTranslate: $ctrl.getChildName(observer) }}<br></span><br><div>{{\'finalizeAppointment.estimatedNumberOfGuests\' | tisfTranslate: $ctrl.appointment.details.guestCount || 0 }}</div><div>{{\'finalizeAppointment.maxNumberOfGuests\' | tisfTranslate:$ctrl.appointment.details.locationSeats || 0}}</div><br></div><div ng-if="$ctrl.isLivingSealing() && !$ctrl.isSchedulingUser()"><span>{{ $ctrl.getMaleAdultName() }}</span><br><span>{{ $ctrl.getFemaleAdultName() }}</span><br><span ng-if="$ctrl.shouldShowChildrenAndObservers()" ng-repeat="child in $ctrl.getChildrenForSealing()">{{\'scheduleAppointment.sealing.child\' | tisfTranslate: $ctrl.getChildName(child) }}<br></span><span ng-if="$ctrl.shouldShowChildrenAndObservers()" ng-repeat="observer in $ctrl.getObserversForSealing()">{{\'scheduleAppointment.sealing.observer\' | tisfTranslate: $ctrl.getChildName(observer) }}<br></span><br></div><div style="display:block">{{$ctrl.appointment.templeOrgId | tosTempleName}}</div><div>{{$ctrl.dateToDisplay | localizeDateTime:\'date\'}}</div><div>{{$ctrl.appointment | tosAppointmentTime}}</div><div style="display:block"><strong>{{\'finalizeAppointment.arrive.by\' | tisfTranslate: $ctrl.arrivalTime}}</strong></div><div ng-if="$ctrl.isAGroupAppointment() && $ctrl.isSchedulingUser() && !$ctrl.isLivingSealing()"><br>*{{\'appointmentScheduled.groupNameWarning\' | tisfTranslate}}</div></div><p></p><div class="baptism-appointment-expectations" ng-if="$ctrl.appointment.appointmentType === $ctrl.AppointmentType.PROXY_BAPTISM"><p><strong><span>{{\'appointmentScheduled.groupSizeMessage\' | tisfTranslate:($ctrl.appointment.details.malePatronCount + $ctrl.appointment.details.femalePatronCount)}}</span></strong></p></div><div class="actions appointment-scheduled-actions"><button class="secondary flush-left add-to-calendar-button-in-modal" ng-click="$ctrl.addToCalendar()"><i class="icon calendar-icon-blue"></i>{{\'appointmentScheduled.addToCalendarButton\' | tisfTranslate}}</button><div class="share-appointment-links" ng-if="$ctrl.isAGroupAppointment() && $ctrl.isSchedulingUser()"><p><strong>{{\'appointmentScheduled.shareAppointment.title\' | tisfTranslate}}</strong><br>{{\'appointmentScheduled.shareAppointment.description\' | tisfTranslate}}</p><a class="share-appointment-link secondary" data-clipboard-text="{{$ctrl.shareableLink}}" ng-click="$ctrl.showClipboardSuccessText(\'shareable-link\')" ng-if="!$ctrl.showLinkCopiedText"><i class="icon share-icon-blue"></i> {{\'appointmentScheduled.shareAppointment.copyShareableLink\' | tisfTranslate}} </a><span ng-if="$ctrl.showLinkCopiedText" class="share-appointment-link icon-text-height">{{\'copy.to.clipboard.success\' | tisfTranslate}}</span><br><br><a class="share-appointment-link secondary" data-clipboard-text="{{$ctrl.appointmentInvitationDetails}}" ng-click="$ctrl.showClipboardSuccessText(\'invitation-details\')" ng-if="!$ctrl.showDetailsCopiedText"><i class="icon copy-icon-blue"></i> {{\'appointmentScheduled.shareAppointment.copyInvitationDetails\' | tisfTranslate}} </a><span ng-if="$ctrl.showDetailsCopiedText" class="share-appointment-link icon-text-height">{{\'copy.to.clipboard.success\' | tisfTranslate}}</span><br><br><a class="share-appointment-link secondary" href="{{$ctrl.mailToEmailInvitation}}"><i class="icon envelope-icon-blue"></i> {{\'appointmentScheduled.shareAppointment.sendEmailInvitation\' | tisfTranslate}}</a></div><tos-confirmation-benefits ng-if="$ctrl.isAGroupAppointment() && $ctrl.isSchedulingUser()"></tos-confirmation-benefits><div class="feedback-section-appointment-scheduled"><p class="feedback-section-appointment-scheduled-header"><strong>{{ \'appointmentScheduled.feedbackTitle\' | tisfTranslate }}</strong></p><p>{{ \'appointmentScheduled.feedbackMessage\' | tisfTranslate}} <a ng-click="$ctrl.openFeedbackModal()" class="no-text-decoration">{{\'appointmentScheduled.feedbackLink\' | tisfTranslate}}</a></p></div><div ng-if="$ctrl.isProxy()" class="family-search-section-appointment-scheduled"><p class="family-search-section-appointment-scheduled-header"><strong>{{ \'appointmentScheduled.familySearchTitle\' | tisfTranslate }}</strong></p><p>{{ \'appointmentScheduled.familySearchMessage\' | tisfTranslate}}</p></div><button ng-if="!$ctrl.isProxy()" class="done-scheduling-button" ng-click="$close()">{{\'buttons.close\' | tisfTranslate}}</button><div ng-if="$ctrl.isProxy()" style="margin-top: 2.5em;"><button class="primary margin-right" ng-click="$ctrl.openOrdinancesReady()">{{\'buttons.print.family.cards\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$close()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div></div>'),e.put("/app/modules/common/modals/session-is-full-modal/session-is-full-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="\'scheduleAppointment.session.full.title\' | tisfTranslate" icon-class="\'info-danger-icon\'"></modal-header><div class="description"><p>{{\'scheduleAppointment.session.full.description\' | tisfTranslate: $ctrl.appointmentType}}</p><div class="actions"><button class="primary margin-right" ng-click="$close()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/session-not-available-modal/session-not-available-modal.html",'<div class="alert warning" role="alert"><modal-header can-dismiss="false" header-text="$ctrl.titleText | tisfTranslate" icon-class="\'info-warning-icon\'" include-icon="true"></modal-header><div class="description session-not-available-description"><p><span>{{$ctrl.descriptionText}}</span></p><div class="actions"><button class="primary margin-right" ng-click="$ctrl.onSelectATimeClicked()">{{\'schedulingNotice.selectATime\' | tisfTranslate}}</button> <button class="secondary no-margin-left" ng-click="$dismiss(\'canceled\')">{{\'schedulingNotice.dontSchedule\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/simple-modal/simple-modal.html",'<div class="alert {{$ctrl.alertType}}" role="alert"><modal-header can-dismiss="true" header-text="$ctrl.options.title" icon-class="\'info-\' + $ctrl.alertIcon + \'-icon\'"></modal-header><div class="description"><p><span>{{$ctrl.options.description}}</span></p><div class="actions"><button ng-repeat="button in $ctrl.options.buttons" class="{{button.type.toLowerCase()}}" ng-class="{\'flush-left\':$first}" ng-click="$ctrl.onButtonClick(button)">{{button.content}}</button></div></div></div>'),e.put("/app/modules/common/modals/temple-selector-modal/temple-selector-modal.html",'<div class="alert" role="alert" style="border-left: none;"><modal-header can-dismiss="true" class="no-icon" header-text="\'selectATemple.allTemples\' | tisfTranslate"></modal-header><div class="description" style="padding: 0"><p><span>{{\'selectATemple.selectATemple\' | tisfTranslate}}</span></p><label class="select-temple-label"><input type="text" id="templeSearch" placeholder="{{\'selectATemple.searchBarPlaceholderText\' | tisfTranslate}}" ng-model="$ctrl.templeSearch" class="temple-selector-search" tisf-enter-key="$ctrl.selectTempleOnEnterKeyPress()" autofocus></label><table class="select-temple-table"><thead><tr><th class="temple-name-column">{{\'selectATemple.templeNameColumnHeader\' | tisfTranslate}}</th></tr></thead><tbody class="select-temple-table-body"><tr ng-repeat="temple in filteredTemples = ($ctrl.temples | tosTempleSearch:$ctrl.templeSearch) | orderTemplesByName" id="temple-row-temple-org-id-{{temple.templeOrgId}}"><td class="temple-name-column" ng-disabled="$ctrl.showSpinner" ng-class="{\'disabled\':$ctrl.showSpinner}" ng-click="$ctrl.selectTemple(temple)"><a ng-if="temple.templeOrgId === $ctrl.yourTempleId" class="no-text-decoration"><span ng-style="!$ctrl.showSpinner && {\'color\': \'black\'}" ng-class="{\'disabled\':$ctrl.showSpinner}" ng-bind-html="$ctrl.yourTempleElement"></span> </a><a ng-if="temple.templeOrgId !== $ctrl.yourTempleId">{{temple.templeOrgId | tosTempleName}}</a></td></tr><tr ng-show="$ctrl.showNoTemplesMatchingSearchMessage(filteredTemples)"><td class="no-temple-results-column">{{\'selectATemple.noMatchesFoundForYourSearch\' | tisfTranslate}}</td></tr><tr ng-show="(!$ctrl.temples || $ctrl.temples.length === 0)\n                              && !$ctrl.showSpinner\n                              && !$ctrl.loadingTemples\n                              && !$ctrl.showNoTemplesMatchingSearchMessage(filteredTemples)"><td class="no-temple-results-column">{{\'selectATemple.noTemplesAvailable\' | tisfTranslate}}</td></tr></tbody></table><div class="temple-list-spinner" ng-if="$ctrl.loadingTemples || $ctrl.showSpinner"><span class="temple-selector-spinner-icon"></span> <span ng-if="$ctrl.loadingTemples" style="height: 100px; display: block;"></span></div><div class="actions"><button class="primary no-margin-left" ng-click="$dismiss(\'canceled\')">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>'),e.put("/app/modules/common/modals/unable-to-edit-modal/unable-to-edit-modal.html",'<div class="alert danger" role="alert"><modal-header can-dismiss="true" header-text="\'unableToEditModal.title\' | tisfTranslate" icon-class="\'alert-error-icon\'"></modal-header><div class="description"><p></p><div>{{\'unableToEditModal.description\' | tisfTranslate}}</div><br><strong>{{$ctrl.templeName}}</strong><div>{{\'misc.phone.number\' | tisfTranslate: $ctrl.templePhone}}</div><p></p><div class="actions"><button class="secondary no-margin-left" ng-click="$ctrl.closeModal()">{{\'buttons.close\' | tisfTranslate}}</button></div></div></div>')}]);